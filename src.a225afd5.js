parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"clu1":[function(require,module,exports) {

},{"./..\\images\\close.svg":[["close.8f72539b.svg","bSVp"],"bSVp"],"./..\\images\\mobile\\rectangle@1x.jpg":[["rectangle@1x.4096bd06.jpg","Rg5e"],"Rg5e"],"./..\\images\\mobile\\rectangle@2x.jpg":[["rectangle@2x.83e38cc0.jpg","je1P"],"je1P"],"./..\\images\\tablet\\rectangle@1x.jpg":[["rectangle@1x.d5d9c0d1.jpg","PfuH"],"PfuH"],"./..\\images\\tablet\\rectangle@2x.jpg":[["rectangle@2x.112e2263.jpg","qVX2"],"qVX2"],"./..\\images\\desktop\\rectangle@1x.jpg":[["rectangle@1x.de95a3e3.jpg","q2SG"],"q2SG"],"./..\\images\\desktop\\rectangle@2x.jpg":[["rectangle@2x.adbf60de.jpg","IbKX"],"IbKX"],"./..\\images\\mobile\\library\\rectangle@1x.jpg":[["rectangle@1x.e549920f.jpg","vQ3y"],"vQ3y"],"./..\\images\\mobile\\library\\rectangle@2x.jpg":[["rectangle@2x.4ce71262.jpg","yKJr"],"yKJr"],"./..\\images\\tablet\\library\\rectangle@1x.jpg":[["rectangle@1x.46b53faa.jpg","XakC"],"XakC"],"./..\\images\\tablet\\library\\rectangle@2x.jpg":[["rectangle@2x.fddfeec5.jpg","fpgJ"],"fpgJ"],"./..\\images\\desktop\\library\\rectangle@1x.jpg":[["rectangle@1x.0e8e97f5.jpg","VOmA"],"VOmA"],"./..\\images\\desktop\\library\\rectangle@2x.jpg":[["rectangle@2x.bfc32767.jpg","K6kg"],"K6kg"],"./..\\images\\search@2x.png":[["search@2x.c3ff1475.png","EfK4"],"EfK4"]}],"rqiq":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;const e="https://api.themoviedb.org/3/",t="2c427feded2caae0e1aa5b84b18ff5a9",a="trending/movie/day",s="search/movie",i="genre/movie/list";class r{constructor(){this.page=1,this.searchQuery=""}async fetchFilms(){const s=await fetch(`${e}${a}?api_key=${t}&page=${this.page}`);return await s.json()}async fetchGenres(){const a=await fetch(`${e}${i}?api_key=${t}`),{genres:s}=await a.json();return s}async fetchFilmsByName(){const a=await fetch(`${e}${s}?api_key=${t}&query=${this.query}`);return await a.json()}async fetchFilmsById(a){const s=await fetch(`${e}movie/${a}/videos?api_key=${t}`);return await s.json()}get query(){return this.searchQuery}set query(e){this.searchQuery=e}incrementPage(){this.page+=1}resetPage(){this.page=1}}exports.default=r;
},{}],"pAws":[function(require,module,exports) {
var define;
var global = arguments[3];
var t,e=arguments[3];!function(e,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof t&&t.amd?t([],r):"object"==typeof exports?exports.Handlebars=r():e.Handlebars=r()}(this,function(){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={exports:{},id:n,loaded:!1};return t[n].call(o.exports,o,o.exports,r),o.loaded=!0,o.exports}return r.m=t,r.c=e,r.p="",r(0)}([function(t,e,r){"use strict";var n=r(1).default,o=r(2).default;e.__esModule=!0;var i=n(r(3)),a=o(r(76)),u=o(r(5)),s=n(r(4)),l=n(r(77)),c=o(r(82));function f(){var t=new i.HandlebarsEnvironment;return s.extend(t,i),t.SafeString=a.default,t.Exception=u.default,t.Utils=s,t.escapeExpression=s.escapeExpression,t.VM=l,t.template=function(e){return l.template(e,t)},t}var p=f();p.create=f,c.default(p),p.default=p,e.default=p,t.exports=e.default},function(t,e){"use strict";e.default=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e},e.__esModule=!0},function(t,e){"use strict";e.default=function(t){return t&&t.__esModule?t:{default:t}},e.__esModule=!0},function(t,e,r){"use strict";var n=r(2).default;e.__esModule=!0,e.HandlebarsEnvironment=c;var o=r(4),i=n(r(5)),a=r(9),u=r(69),s=n(r(71)),l=r(72);e.VERSION="4.7.8";e.COMPILER_REVISION=8;e.LAST_COMPATIBLE_COMPILER_REVISION=7;e.REVISION_CHANGES={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:"== 1.x.x",5:"== 2.0.0-alpha.x",6:">= 2.0.0-beta.1",7:">= 4.0.0 <4.3.0",8:">= 4.3.0"};function c(t,e,r){this.helpers=t||{},this.partials=e||{},this.decorators=r||{},a.registerDefaultHelpers(this),u.registerDefaultDecorators(this)}c.prototype={constructor:c,logger:s.default,log:s.default.log,registerHelper:function(t,e){if("[object Object]"===o.toString.call(t)){if(e)throw new i.default("Arg not supported with multiple helpers");o.extend(this.helpers,t)}else this.helpers[t]=e},unregisterHelper:function(t){delete this.helpers[t]},registerPartial:function(t,e){if("[object Object]"===o.toString.call(t))o.extend(this.partials,t);else{if(void 0===e)throw new i.default('Attempting to register a partial called "'+t+'" as undefined');this.partials[t]=e}},unregisterPartial:function(t){delete this.partials[t]},registerDecorator:function(t,e){if("[object Object]"===o.toString.call(t)){if(e)throw new i.default("Arg not supported with multiple decorators");o.extend(this.decorators,t)}else this.decorators[t]=e},unregisterDecorator:function(t){delete this.decorators[t]},resetLoggedPropertyAccesses:function(){l.resetLoggedProperties()}};var f=s.default.log;e.log=f,e.createFrame=o.createFrame,e.logger=s.default},function(t,e){"use strict";e.__esModule=!0,e.extend=a,e.indexOf=function(t,e){for(var r=0,n=t.length;r<n;r++)if(t[r]===e)return r;return-1},e.escapeExpression=function(t){if("string"!=typeof t){if(t&&t.toHTML)return t.toHTML();if(null==t)return"";if(!t)return t+"";t=""+t}if(!o.test(t))return t;return t.replace(n,i)},e.isEmpty=function(t){return!t&&0!==t||!(!l(t)||0!==t.length)},e.createFrame=function(t){var e=a({},t);return e._parent=t,e},e.blockParams=function(t,e){return t.path=e,t},e.appendContextPath=function(t,e){return(t?t+".":"")+e};var r={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;","=":"&#x3D;"},n=/[&<>"'`=]/g,o=/[&<>"'`=]/;function i(t){return r[t]}function a(t){for(var e=1;e<arguments.length;e++)for(var r in arguments[e])Object.prototype.hasOwnProperty.call(arguments[e],r)&&(t[r]=arguments[e][r]);return t}var u=Object.prototype.toString;e.toString=u;var s=function(t){return"function"==typeof t};s(/x/)&&(e.isFunction=s=function(t){return"function"==typeof t&&"[object Function]"===u.call(t)}),e.isFunction=s;var l=Array.isArray||function(t){return!(!t||"object"!=typeof t)&&"[object Array]"===u.call(t)};e.isArray=l},function(t,e,r){"use strict";var n=r(6).default;e.__esModule=!0;var o=["description","fileName","lineNumber","endLineNumber","message","name","number","stack"];function i(t,e){var r=e&&e.loc,a=void 0,u=void 0,s=void 0,l=void 0;r&&(a=r.start.line,u=r.end.line,s=r.start.column,l=r.end.column,t+=" - "+a+":"+s);for(var c=Error.prototype.constructor.call(this,t),f=0;f<o.length;f++)this[o[f]]=c[o[f]];Error.captureStackTrace&&Error.captureStackTrace(this,i);try{r&&(this.lineNumber=a,this.endLineNumber=u,n?(Object.defineProperty(this,"column",{value:s,enumerable:!0}),Object.defineProperty(this,"endColumn",{value:l,enumerable:!0})):(this.column=s,this.endColumn=l))}catch(p){}}i.prototype=new Error,e.default=i,t.exports=e.default},function(t,e,r){t.exports={default:r(7),__esModule:!0}},function(t,e,r){var n=r(8);t.exports=function(t,e,r){return n.setDesc(t,e,r)}},function(t,e){var r=Object;t.exports={create:r.create,getProto:r.getPrototypeOf,isEnum:{}.propertyIsEnumerable,getDesc:r.getOwnPropertyDescriptor,setDesc:r.defineProperty,setDescs:r.defineProperties,getKeys:r.keys,getNames:r.getOwnPropertyNames,getSymbols:r.getOwnPropertySymbols,each:[].forEach}},function(t,e,r){"use strict";var n=r(2).default;e.__esModule=!0,e.registerDefaultHelpers=function(t){o.default(t),i.default(t),a.default(t),u.default(t),s.default(t),l.default(t),c.default(t)},e.moveHelperToHooks=function(t,e,r){t.helpers[e]&&(t.hooks[e]=t.helpers[e],r||delete t.helpers[e])};var o=n(r(10)),i=n(r(11)),a=n(r(64)),u=n(r(65)),s=n(r(66)),l=n(r(67)),c=n(r(68))},function(t,e,r){"use strict";e.__esModule=!0;var n=r(4);e.default=function(t){t.registerHelper("blockHelperMissing",function(e,r){var o=r.inverse,i=r.fn;if(!0===e)return i(this);if(!1===e||null==e)return o(this);if(n.isArray(e))return e.length>0?(r.ids&&(r.ids=[r.name]),t.helpers.each(e,r)):o(this);if(r.data&&r.ids){var a=n.createFrame(r.data);a.contextPath=n.appendContextPath(r.data.contextPath,r.name),r={data:a}}return i(e,r)})},t.exports=e.default},function(t,e,r){"use strict";var n=r(12).default,o=r(42).default,i=r(54).default,a=r(59).default,u=r(2).default;e.__esModule=!0;var s=r(4),l=u(r(5));e.default=function(t){t.registerHelper("each",function(t,e){if(!e)throw new l.default("Must pass iterator to #each");var r,u=e.fn,c=e.inverse,f=0,p="",d=void 0,h=void 0;function v(e,r,n){d&&(d.key=e,d.index=r,d.first=0===r,d.last=!!n,h&&(d.contextPath=h+e)),p+=u(t[e],{data:d,blockParams:s.blockParams([t[e],e],[h+e,null])})}if(e.data&&e.ids&&(h=s.appendContextPath(e.data.contextPath,e.ids[0])+"."),s.isFunction(t)&&(t=t.call(this)),e.data&&(d=s.createFrame(e.data)),t&&"object"==typeof t)if(s.isArray(t))for(var g=t.length;f<g;f++)f in t&&v(f,f,f===t.length-1);else if("function"==typeof n&&t[o]){for(var m=[],y=i(t),_=y.next();!_.done;_=y.next())m.push(_.value);for(g=(t=m).length;f<g;f++)v(f,f,f===t.length-1)}else r=void 0,a(t).forEach(function(t){void 0!==r&&v(r,f-1),r=t,f++}),void 0!==r&&v(r,f-1,!0);return 0===f&&(p=c(this)),p})},t.exports=e.default},function(t,e,r){t.exports={default:r(13),__esModule:!0}},function(t,e,r){r(14),r(41),t.exports=r(20).Symbol},function(t,e,r){"use strict";var n=r(8),o=r(15),i=r(16),a=r(17),u=r(19),s=r(23),l=r(18),c=r(26),f=r(27),p=r(29),d=r(28),h=r(30),v=r(35),g=r(36),m=r(37),y=r(38),_=r(31),x=r(25),b=n.getDesc,w=n.setDesc,P=n.create,M=v.get,O=o.Symbol,k=o.JSON,S=k&&k.stringify,E=!1,j=d("_hidden"),A=n.isEnum,I=c("symbol-registry"),H=c("symbols"),N="function"==typeof O,C=Object.prototype,T=a&&l(function(){return 7!=P(w({},"a",{get:function(){return w(this,"a",{value:7}).a}})).a})?function(t,e,r){var n=b(C,e);n&&delete C[e],w(t,e,r),n&&t!==C&&w(C,e,n)}:w,D=function(t){var e=H[t]=P(O.prototype);return e._k=t,a&&E&&T(C,t,{configurable:!0,set:function(e){i(this,j)&&i(this[j],t)&&(this[j][t]=!1),T(this,t,x(1,e))}}),e},L=function(t){return"symbol"==typeof t},F=function(t,e,r){return r&&i(H,e)?(r.enumerable?(i(t,j)&&t[j][e]&&(t[j][e]=!1),r=P(r,{enumerable:x(0,!1)})):(i(t,j)||w(t,j,x(1,{})),t[j][e]=!0),T(t,e,r)):w(t,e,r)},V=function(t,e){y(t);for(var r,n=g(e=_(e)),o=0,i=n.length;i>o;)F(t,r=n[o++],e[r]);return t},R=function(t,e){return void 0===e?P(t):V(P(t),e)},B=function(t){var e=A.call(this,t);return!(e||!i(this,t)||!i(H,t)||i(this,j)&&this[j][t])||e},G=function(t,e){var r=b(t=_(t),e);return!r||!i(H,e)||i(t,j)&&t[j][e]||(r.enumerable=!0),r},q=function(t){for(var e,r=M(_(t)),n=[],o=0;r.length>o;)i(H,e=r[o++])||e==j||n.push(e);return n},J=function(t){for(var e,r=M(_(t)),n=[],o=0;r.length>o;)i(H,e=r[o++])&&n.push(H[e]);return n},W=l(function(){var t=O();return"[null]"!=S([t])||"{}"!=S({a:t})||"{}"!=S(Object(t))});N||(s((O=function(){if(L(this))throw TypeError("Symbol is not a constructor");return D(p(arguments.length>0?arguments[0]:void 0))}).prototype,"toString",function(){return this._k}),L=function(t){return t instanceof O},n.create=R,n.isEnum=B,n.getDesc=G,n.setDesc=F,n.setDescs=V,n.getNames=v.get=q,n.getSymbols=J,a&&!r(40)&&s(C,"propertyIsEnumerable",B,!0));var K={for:function(t){return i(I,t+="")?I[t]:I[t]=O(t)},keyFor:function(t){return h(I,t)},useSetter:function(){E=!0},useSimple:function(){E=!1}};n.each.call("hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),function(t){var e=d(t);K[t]=N?e:D(e)}),E=!0,u(u.G+u.W,{Symbol:O}),u(u.S,"Symbol",K),u(u.S+u.F*!N,"Object",{create:R,defineProperty:F,defineProperties:V,getOwnPropertyDescriptor:G,getOwnPropertyNames:q,getOwnPropertySymbols:J}),k&&u(u.S+u.F*(!N||W),"JSON",{stringify:function(t){if(void 0!==t&&!L(t)){for(var e,r,n=[t],o=1,i=arguments;i.length>o;)n.push(i[o++]);return"function"==typeof(e=n[1])&&(r=e),!r&&m(e)||(e=function(t,e){if(r&&(e=r.call(this,t,e)),!L(e))return e}),n[1]=e,S.apply(k,n)}}}),f(O,"Symbol"),f(Math,"Math",!0),f(o.JSON,"JSON",!0)},function(t,e){var r=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},function(t,e){var r={}.hasOwnProperty;t.exports=function(t,e){return r.call(t,e)}},function(t,e,r){t.exports=!r(18)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(t,e){t.exports=function(t){try{return!!t()}catch(e){return!0}}},function(t,e,r){var n=r(15),o=r(20),i=r(21),a=function(t,e,r){var u,s,l,c=t&a.F,f=t&a.G,p=t&a.S,d=t&a.P,h=t&a.B,v=t&a.W,g=f?o:o[e]||(o[e]={}),m=f?n:p?n[e]:(n[e]||{}).prototype;for(u in f&&(r=e),r)(s=!c&&m&&u in m)&&u in g||(l=s?m[u]:r[u],g[u]=f&&"function"!=typeof m[u]?r[u]:h&&s?i(l,n):v&&m[u]==l?function(t){var e=function(e){return this instanceof t?new t(e):t(e)};return e.prototype=t.prototype,e}(l):d&&"function"==typeof l?i(Function.call,l):l,d&&((g.prototype||(g.prototype={}))[u]=l))};a.F=1,a.G=2,a.S=4,a.P=8,a.B=16,a.W=32,t.exports=a},function(t,e){var r=t.exports={version:"1.2.6"};"number"==typeof __e&&(__e=r)},function(t,e,r){var n=r(22);t.exports=function(t,e,r){if(n(t),void 0===e)return t;switch(r){case 1:return function(r){return t.call(e,r)};case 2:return function(r,n){return t.call(e,r,n)};case 3:return function(r,n,o){return t.call(e,r,n,o)}}return function(){return t.apply(e,arguments)}}},function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},function(t,e,r){t.exports=r(24)},function(t,e,r){var n=r(8),o=r(25);t.exports=r(17)?function(t,e,r){return n.setDesc(t,e,o(1,r))}:function(t,e,r){return t[e]=r,t}},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e,r){var n=r(15),o=n["__core-js_shared__"]||(n["__core-js_shared__"]={});t.exports=function(t){return o[t]||(o[t]={})}},function(t,e,r){var n=r(8).setDesc,o=r(16),i=r(28)("toStringTag");t.exports=function(t,e,r){t&&!o(t=r?t:t.prototype,i)&&n(t,i,{configurable:!0,value:e})}},function(t,e,r){var n=r(26)("wks"),o=r(29),i=r(15).Symbol;t.exports=function(t){return n[t]||(n[t]=i&&i[t]||(i||o)("Symbol."+t))}},function(t,e){var r=0,n=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++r+n).toString(36))}},function(t,e,r){var n=r(8),o=r(31);t.exports=function(t,e){for(var r,i=o(t),a=n.getKeys(i),u=a.length,s=0;u>s;)if(i[r=a[s++]]===e)return r}},function(t,e,r){var n=r(32),o=r(34);t.exports=function(t){return n(o(t))}},function(t,e,r){var n=r(33);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==n(t)?t.split(""):Object(t)}},function(t,e){var r={}.toString;t.exports=function(t){return r.call(t).slice(8,-1)}},function(t,e){t.exports=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t}},function(t,e,r){var n=r(31),o=r(8).getNames,i={}.toString,a="object"==typeof window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];t.exports.get=function(t){return a&&"[object Window]"==i.call(t)?function(t){try{return o(t)}catch(e){return a.slice()}}(t):o(n(t))}},function(t,e,r){var n=r(8);t.exports=function(t){var e=n.getKeys(t),r=n.getSymbols;if(r)for(var o,i=r(t),a=n.isEnum,u=0;i.length>u;)a.call(t,o=i[u++])&&e.push(o);return e}},function(t,e,r){var n=r(33);t.exports=Array.isArray||function(t){return"Array"==n(t)}},function(t,e,r){var n=r(39);t.exports=function(t){if(!n(t))throw TypeError(t+" is not an object!");return t}},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e){t.exports=!0},function(t,e){},function(t,e,r){t.exports={default:r(43),__esModule:!0}},function(t,e,r){r(44),r(50),t.exports=r(28)("iterator")},function(t,e,r){"use strict";var n=r(45)(!0);r(47)(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,r=this._i;return r>=e.length?{value:void 0,done:!0}:(t=n(e,r),this._i+=t.length,{value:t,done:!1})})},function(t,e,r){var n=r(46),o=r(34);t.exports=function(t){return function(e,r){var i,a,u=String(o(e)),s=n(r),l=u.length;return s<0||s>=l?t?"":void 0:(i=u.charCodeAt(s))<55296||i>56319||s+1===l||(a=u.charCodeAt(s+1))<56320||a>57343?t?u.charAt(s):i:t?u.slice(s,s+2):a-56320+(i-55296<<10)+65536}}},function(t,e){var r=Math.ceil,n=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?n:r)(t)}},function(t,e,r){"use strict";var n=r(40),o=r(19),i=r(23),a=r(24),u=r(16),s=r(48),l=r(49),c=r(27),f=r(8).getProto,p=r(28)("iterator"),d=!([].keys&&"next"in[].keys()),h=function(){return this};t.exports=function(t,e,r,v,g,m,y){l(r,e,v);var _,x,b=function(t){if(!d&&t in O)return O[t];switch(t){case"keys":case"values":return function(){return new r(this,t)}}return function(){return new r(this,t)}},w=e+" Iterator",P="values"==g,M=!1,O=t.prototype,k=O[p]||O["@@iterator"]||g&&O[g],S=k||b(g);if(k){var E=f(S.call(new t));c(E,w,!0),!n&&u(O,"@@iterator")&&a(E,p,h),P&&"values"!==k.name&&(M=!0,S=function(){return k.call(this)})}if(n&&!y||!d&&!M&&O[p]||a(O,p,S),s[e]=S,s[w]=h,g)if(_={values:P?S:b("values"),keys:m?S:b("keys"),entries:P?b("entries"):S},y)for(x in _)x in O||i(O,x,_[x]);else o(o.P+o.F*(d||M),e,_);return _}},function(t,e){t.exports={}},function(t,e,r){"use strict";var n=r(8),o=r(25),i=r(27),a={};r(24)(a,r(28)("iterator"),function(){return this}),t.exports=function(t,e,r){t.prototype=n.create(a,{next:o(1,r)}),i(t,e+" Iterator")}},function(t,e,r){r(51);var n=r(48);n.NodeList=n.HTMLCollection=n.Array},function(t,e,r){"use strict";var n=r(52),o=r(53),i=r(48),a=r(31);t.exports=r(47)(Array,"Array",function(t,e){this._t=a(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,r=this._i++;return!t||r>=t.length?(this._t=void 0,o(1)):o(0,"keys"==e?r:"values"==e?t[r]:[r,t[r]])},"values"),i.Arguments=i.Array,n("keys"),n("values"),n("entries")},function(t,e){t.exports=function(){}},function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},function(t,e,r){t.exports={default:r(55),__esModule:!0}},function(t,e,r){r(50),r(44),t.exports=r(56)},function(t,e,r){var n=r(38),o=r(57);t.exports=r(20).getIterator=function(t){var e=o(t);if("function"!=typeof e)throw TypeError(t+" is not iterable!");return n(e.call(t))}},function(t,e,r){var n=r(58),o=r(28)("iterator"),i=r(48);t.exports=r(20).getIteratorMethod=function(t){if(null!=t)return t[o]||t["@@iterator"]||i[n(t)]}},function(t,e,r){var n=r(33),o=r(28)("toStringTag"),i="Arguments"==n(function(){return arguments}());t.exports=function(t){var e,r,a;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=(e=Object(t))[o])?r:i?n(e):"Object"==(a=n(e))&&"function"==typeof e.callee?"Arguments":a}},function(t,e,r){t.exports={default:r(60),__esModule:!0}},function(t,e,r){r(61),t.exports=r(20).Object.keys},function(t,e,r){var n=r(62);r(63)("keys",function(t){return function(e){return t(n(e))}})},function(t,e,r){var n=r(34);t.exports=function(t){return Object(n(t))}},function(t,e,r){var n=r(19),o=r(20),i=r(18);t.exports=function(t,e){var r=(o.Object||{})[t]||Object[t],a={};a[t]=e(r),n(n.S+n.F*i(function(){r(1)}),"Object",a)}},function(t,e,r){"use strict";var n=r(2).default;e.__esModule=!0;var o=n(r(5));e.default=function(t){t.registerHelper("helperMissing",function(){if(1!==arguments.length)throw new o.default('Missing helper: "'+arguments[arguments.length-1].name+'"')})},t.exports=e.default},function(t,e,r){"use strict";var n=r(2).default;e.__esModule=!0;var o=r(4),i=n(r(5));e.default=function(t){t.registerHelper("if",function(t,e){if(2!=arguments.length)throw new i.default("#if requires exactly one argument");return o.isFunction(t)&&(t=t.call(this)),!e.hash.includeZero&&!t||o.isEmpty(t)?e.inverse(this):e.fn(this)}),t.registerHelper("unless",function(e,r){if(2!=arguments.length)throw new i.default("#unless requires exactly one argument");return t.helpers.if.call(this,e,{fn:r.inverse,inverse:r.fn,hash:r.hash})})},t.exports=e.default},function(t,e){"use strict";e.__esModule=!0,e.default=function(t){t.registerHelper("log",function(){for(var e=[void 0],r=arguments[arguments.length-1],n=0;n<arguments.length-1;n++)e.push(arguments[n]);var o=1;null!=r.hash.level?o=r.hash.level:r.data&&null!=r.data.level&&(o=r.data.level),e[0]=o,t.log.apply(t,e)})},t.exports=e.default},function(t,e){"use strict";e.__esModule=!0,e.default=function(t){t.registerHelper("lookup",function(t,e,r){return t?r.lookupProperty(t,e):t})},t.exports=e.default},function(t,e,r){"use strict";var n=r(2).default;e.__esModule=!0;var o=r(4),i=n(r(5));e.default=function(t){t.registerHelper("with",function(t,e){if(2!=arguments.length)throw new i.default("#with requires exactly one argument");o.isFunction(t)&&(t=t.call(this));var r=e.fn;if(o.isEmpty(t))return e.inverse(this);var n=e.data;return e.data&&e.ids&&((n=o.createFrame(e.data)).contextPath=o.appendContextPath(e.data.contextPath,e.ids[0])),r(t,{data:n,blockParams:o.blockParams([t],[n&&n.contextPath])})})},t.exports=e.default},function(t,e,r){"use strict";var n=r(2).default;e.__esModule=!0,e.registerDefaultDecorators=function(t){o.default(t)};var o=n(r(70))},function(t,e,r){"use strict";e.__esModule=!0;var n=r(4);e.default=function(t){t.registerDecorator("inline",function(t,e,r,o){var i=t;return e.partials||(e.partials={},i=function(o,i){var a=r.partials;r.partials=n.extend({},a,e.partials);var u=t(o,i);return r.partials=a,u}),e.partials[o.args[0]]=o.fn,i})},t.exports=e.default},function(t,e,r){"use strict";e.__esModule=!0;var n=r(4),o={methodMap:["debug","info","warn","error"],level:"info",lookupLevel:function(t){if("string"==typeof t){var e=n.indexOf(o.methodMap,t.toLowerCase());t=e>=0?e:parseInt(t,10)}return t},log:function(t){if(t=o.lookupLevel(t),"undefined"!=typeof console&&o.lookupLevel(o.level)<=t){var e=o.methodMap[t];console[e]||(e="log");for(var r=arguments.length,n=Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];console[e].apply(console,n)}}};e.default=o,t.exports=e.default},function(t,e,r){"use strict";var n=r(73).default,o=r(59).default,i=r(2).default;e.__esModule=!0,e.createProtoAccessControl=function(t){var e=n(null);e.constructor=!1,e.__defineGetter__=!1,e.__defineSetter__=!1,e.__lookupGetter__=!1;var r=n(null);return r.__proto__=!1,{properties:{whitelist:a.createNewLookupObject(r,t.allowedProtoProperties),defaultValue:t.allowProtoPropertiesByDefault},methods:{whitelist:a.createNewLookupObject(e,t.allowedProtoMethods),defaultValue:t.allowProtoMethodsByDefault}}},e.resultIsAllowed=function(t,e,r){return l("function"==typeof t?e.methods:e.properties,r)},e.resetLoggedProperties=function(){o(s).forEach(function(t){delete s[t]})};var a=r(75),u=i(r(71)),s=n(null);function l(t,e){return void 0!==t.whitelist[e]?!0===t.whitelist[e]:void 0!==t.defaultValue?t.defaultValue:(function(t){!0!==s[t]&&(s[t]=!0,u.default.log("error",'Handlebars: Access has been denied to resolve the property "'+t+'" because it is not an "own property" of its parent.\nYou can add a runtime option to disable the check or this warning:\nSee https://handlebarsjs.com/api-reference/runtime-options.html#options-to-control-prototype-access for details'))}(e),!1)}},function(t,e,r){t.exports={default:r(74),__esModule:!0}},function(t,e,r){var n=r(8);t.exports=function(t,e){return n.create(t,e)}},function(t,e,r){"use strict";var n=r(73).default;e.__esModule=!0,e.createNewLookupObject=function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return o.extend.apply(void 0,[n(null)].concat(e))};var o=r(4)},function(t,e){"use strict";function r(t){this.string=t}e.__esModule=!0,r.prototype.toString=r.prototype.toHTML=function(){return""+this.string},e.default=r,t.exports=e.default},function(t,e,r){"use strict";var n=r(78).default,o=r(59).default,i=r(1).default,a=r(2).default;e.__esModule=!0,e.checkRevision=function(t){var e=t&&t[0]||1,r=l.COMPILER_REVISION;if(e>=l.LAST_COMPATIBLE_COMPILER_REVISION&&e<=l.COMPILER_REVISION)return;if(e<l.LAST_COMPATIBLE_COMPILER_REVISION){var n=l.REVISION_CHANGES[r],o=l.REVISION_CHANGES[e];throw new s.default("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+n+") or downgrade your runtime to an older version ("+o+").")}throw new s.default("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+t[1]+").")},e.template=function(t,e){if(!e)throw new s.default("No environment passed to template");if(!t||!t.main)throw new s.default("Unknown template object: "+typeof t);t.main.decorator=t.main_d,e.VM.checkRevision(t.compiler);var r=t.compiler&&7===t.compiler[0];var i={strict:function(t,e,r){if(!(t&&e in t))throw new s.default('"'+e+'" not defined in '+t,{loc:r});return i.lookupProperty(t,e)},lookupProperty:function(t,e){var r=t[e];return null==r?r:Object.prototype.hasOwnProperty.call(t,e)?r:p.resultIsAllowed(r,i.protoAccessControl,e)?r:void 0},lookup:function(t,e){for(var r=t.length,n=0;n<r;n++){var o=t[n]&&i.lookupProperty(t[n],e);if(null!=o)return t[n][e]}},lambda:function(t,e){return"function"==typeof t?t.call(e):t},escapeExpression:u.escapeExpression,invokePartial:function(r,n,o){o.hash&&(n=u.extend({},n,o.hash),o.ids&&(o.ids[0]=!0));r=e.VM.resolvePartial.call(this,r,n,o);var i=u.extend({},o,{hooks:this.hooks,protoAccessControl:this.protoAccessControl}),a=e.VM.invokePartial.call(this,r,n,i);null==a&&e.compile&&(o.partials[o.name]=e.compile(r,t.compilerOptions,e),a=o.partials[o.name](n,i));if(null!=a){if(o.indent){for(var l=a.split("\n"),c=0,f=l.length;c<f&&(l[c]||c+1!==f);c++)l[c]=o.indent+l[c];a=l.join("\n")}return a}throw new s.default("The partial "+o.name+" could not be compiled when running in runtime-only mode")},fn:function(e){var r=t[e];return r.decorator=t[e+"_d"],r},programs:[],program:function(t,e,r,n,o){var i=this.programs[t],a=this.fn(t);return e||o||n||r?i=d(this,t,a,e,r,n,o):i||(i=this.programs[t]=d(this,t,a)),i},data:function(t,e){for(;t&&e--;)t=t._parent;return t},mergeIfNeeded:function(t,e){var r=t||e;return t&&e&&t!==e&&(r=u.extend({},e,t)),r},nullContext:n({}),noop:e.VM.noop,compilerInfo:t.compiler};function a(e){var r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],n=r.data;a._setup(r),!r.partial&&t.useData&&(n=function(t,e){e&&"root"in e||((e=e?l.createFrame(e):{}).root=t);return e}(e,n));var o=void 0,u=t.useBlockParams?[]:void 0;function s(e){return""+t.main(i,e,i.helpers,i.partials,n,u,o)}return t.useDepths&&(o=r.depths?e!=r.depths[0]?[e].concat(r.depths):r.depths:[e]),(s=v(t.main,s,i,r.depths||[],n,u))(e,r)}return a.isTop=!0,a._setup=function(n){if(n.partial)i.protoAccessControl=n.protoAccessControl,i.helpers=n.helpers,i.partials=n.partials,i.decorators=n.decorators,i.hooks=n.hooks;else{var a=u.extend({},e.helpers,n.helpers);!function(t,e){o(t).forEach(function(r){var n=t[r];t[r]=function(t,e){var r=e.lookupProperty;return f.wrapHelper(t,function(t){return u.extend({lookupProperty:r},t)})}(n,e)})}(a,i),i.helpers=a,t.usePartial&&(i.partials=i.mergeIfNeeded(n.partials,e.partials)),(t.usePartial||t.useDecorators)&&(i.decorators=u.extend({},e.decorators,n.decorators)),i.hooks={},i.protoAccessControl=p.createProtoAccessControl(n);var s=n.allowCallsToHelperMissing||r;c.moveHelperToHooks(i,"helperMissing",s),c.moveHelperToHooks(i,"blockHelperMissing",s)}},a._child=function(e,r,n,o){if(t.useBlockParams&&!n)throw new s.default("must pass block params");if(t.useDepths&&!o)throw new s.default("must pass parent depths");return d(i,e,t[e],r,0,n,o)},a},e.wrapProgram=d,e.resolvePartial=function(t,e,r){t?t.call||r.name||(r.name=t,t=r.partials[t]):t="@partial-block"===r.name?r.data["partial-block"]:r.partials[r.name];return t},e.invokePartial=function(t,e,r){var n=r.data&&r.data["partial-block"];r.partial=!0,r.ids&&(r.data.contextPath=r.ids[0]||r.data.contextPath);var o=void 0;r.fn&&r.fn!==h&&function(){r.data=l.createFrame(r.data);var t=r.fn;o=r.data["partial-block"]=function(e){var r=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return r.data=l.createFrame(r.data),r.data["partial-block"]=n,t(e,r)},t.partials&&(r.partials=u.extend({},r.partials,t.partials))}();void 0===t&&o&&(t=o);if(void 0===t)throw new s.default("The partial "+r.name+" could not be found");if(t instanceof Function)return t(e,r)},e.noop=h;var u=i(r(4)),s=a(r(5)),l=r(3),c=r(9),f=r(81),p=r(72);function d(t,e,r,n,o,i,a){function u(e){var o=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],u=a;return!a||e==a[0]||e===t.nullContext&&null===a[0]||(u=[e].concat(a)),r(t,e,t.helpers,t.partials,o.data||n,i&&[o.blockParams].concat(i),u)}return(u=v(r,u,t,a,n,i)).program=e,u.depth=a?a.length:0,u.blockParams=o||0,u}function h(){return""}function v(t,e,r,n,o,i){if(t.decorator){var a={};e=t.decorator(e,a,r,n&&n[0],o,i,n),u.extend(e,a)}return e}},function(t,e,r){t.exports={default:r(79),__esModule:!0}},function(t,e,r){r(80),t.exports=r(20).Object.seal},function(t,e,r){var n=r(39);r(63)("seal",function(t){return function(e){return t&&n(e)?t(e):e}})},function(t,e){"use strict";e.__esModule=!0,e.wrapHelper=function(t,e){if("function"!=typeof t)return t;return function(){var r=arguments[arguments.length-1];return arguments[arguments.length-1]=e(r),t.apply(this,arguments)}}},function(t,e){"use strict";e.__esModule=!0,e.default=function(t){"object"!=typeof globalThis&&(Object.prototype.__defineGetter__("__magic__",function(){return this}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__);var e=globalThis.Handlebars;t.noConflict=function(){return globalThis.Handlebars===t&&(globalThis.Handlebars=e),t}},t.exports=e.default}])});
},{}],"WSZA":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var n=l(require("handlebars/dist/handlebars.runtime"));function l(n){return n&&n.__esModule?n:{default:n}}const e=n.default.template({1:function(n,l,e,a,t){var o,r,s=null!=l?l:n.nullContext||{},i=n.hooks.helperMissing,c=n.escapeExpression,u=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return'  <li class="gallery__item">\r\n    <div class="gallery__card">\r\n'+(null!=(o=u(e,"if").call(s,null!=l?u(l,"poster_path"):l,{name:"if",hash:{},fn:n.program(2,t,0),inverse:n.program(4,t,0),data:t,loc:{start:{line:5,column:6},end:{line:9,column:13}}}))?o:"")+'      <div class="film-information">\r\n        <p class="film__name">'+c("function"==typeof(r=null!=(r=u(e,"title")||(null!=l?u(l,"title"):l))?r:i)?r.call(s,{name:"title",hash:{},data:t,loc:{start:{line:11,column:30},end:{line:11,column:39}}}):r)+c("function"==typeof(r=null!=(r=u(e,"name")||(null!=l?u(l,"name"):l))?r:i)?r.call(s,{name:"name",hash:{},data:t,loc:{start:{line:11,column:39},end:{line:11,column:47}}}):r)+'</>\r\n        <div class="film__advantages js-card-div">\r\n          <p class="category">\r\n            <span>'+(null!=(o=u(e,"each").call(s,null!=l?u(l,"genre_ids"):l,{name:"each",hash:{},fn:n.program(6,t,0),inverse:n.noop,data:t,loc:{start:{line:14,column:18},end:{line:14,column:84}}}))?o:"")+"</span> | "+c("function"==typeof(r=null!=(r=u(e,"release_date")||(null!=l?u(l,"release_date"):l))?r:i)?r.call(s,{name:"release_date",hash:{},data:t,loc:{start:{line:14,column:94},end:{line:14,column:110}}}):r)+'\r\n          </p>\r\n          <p class="votes">'+c("function"==typeof(r=null!=(r=u(e,"vote_average")||(null!=l?u(l,"vote_average"):l))?r:i)?r.call(s,{name:"vote_average",hash:{},data:t,loc:{start:{line:16,column:27},end:{line:16,column:43}}}):r)+"</p>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </li>\r\n"},2:function(n,l,e,a,t){var o,r=null!=l?l:n.nullContext||{},s=n.hooks.helperMissing,i=n.escapeExpression,c=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return'      <img class="gallery__image" src="https://image.tmdb.org/t/p/w500/'+i("function"==typeof(o=null!=(o=c(e,"poster_path")||(null!=l?c(l,"poster_path"):l))?o:s)?o.call(r,{name:"poster_path",hash:{},data:t,loc:{start:{line:6,column:71},end:{line:6,column:86}}}):o)+'" alt="'+i("function"==typeof(o=null!=(o=c(e,"title")||(null!=l?c(l,"title"):l))?o:s)?o.call(r,{name:"title",hash:{},data:t,loc:{start:{line:6,column:93},end:{line:6,column:102}}}):o)+'" data-source="'+i("function"==typeof(o=null!=(o=c(e,"id")||(null!=l?c(l,"id"):l))?o:s)?o.call(r,{name:"id",hash:{},data:t,loc:{start:{line:6,column:117},end:{line:6,column:123}}}):o)+'">\r\n'},4:function(n,l,e,a,t){var o,r=n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]};return'      <img class="gallery__image" src="https://raw.githubusercontent.com/alexkarmhon/cinema/main/src/images/coming-soon.jpg" alt="'+n.escapeExpression("function"==typeof(o=null!=(o=r(e,"title")||(null!=l?r(l,"title"):l))?o:n.hooks.helperMissing)?o.call(null!=l?l:n.nullContext||{},{name:"title",hash:{},data:t,loc:{start:{line:8,column:130},end:{line:8,column:139}}}):o)+'">\r\n'},6:function(n,l,e,a,t){return n.escapeExpression(n.lambda(l,l))+'<span class="cutter">, </span>'},compiler:[8,">= 4.3.0"],main:function(n,l,e,a,t){var o;return null!=(o=(n.lookupProperty||function(n,l){if(Object.prototype.hasOwnProperty.call(n,l))return n[l]})(e,"each").call(null!=l?l:n.nullContext||{},l,{name:"each",hash:{},fn:n.program(1,t,0),inverse:n.noop,data:t,loc:{start:{line:2,column:0},end:{line:21,column:9}}}))?o:""},useData:!0});var a=exports.default=e;
},{"handlebars/dist/handlebars.runtime":"pAws"}],"vMqs":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;class t{constructor({selector:t,hidden:e=!1}){this.button=document.querySelector(t),this.label=this.button.querySelector(".label"),this.spinner=this.button.querySelector(".spinner"),e&&this.hide()}enable(){this.button.disabled=!1,this.label.textContent="More films...",this.spinner.classList.add("is-hidden")}disable(){this.button.disable=!0,this.label.textContent="Loading...",this.spinner.classList.remove("is-hidden")}show(){this.button.classList.remove("is-hidden")}hide(){this.button.classList.add("is-hidden")}}exports.default=t;
},{}],"txz9":[function(require,module,exports) {
var define;
var global = arguments[3];
var t,e=arguments[3];!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof t&&t.amd?t(["exports"],n):n((e="undefined"!=typeof globalThis?globalThis:e||self).PNotify={})}(this,function(t){"use strict";function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function r(t,e,n){return e&&o(t.prototype,e),n&&o(t,n),t}function s(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function a(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,i)}return n}function c(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?a(Object(n),!0).forEach(function(e){s(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function f(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function d(t,e,n){return(d=f()?Reflect.construct:function(t,e,n){var i=[null];i.push.apply(i,e);var o=new(Function.bind.apply(t,i));return n&&u(o,n.prototype),o}).apply(null,arguments)}function h(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function p(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],i=!0,o=!1,r=void 0;try{for(var s,a=t[Symbol.iterator]();!(i=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);i=!0);}catch(t){o=!0,r=t}finally{try{i||null==a.return||a.return()}finally{if(o)throw r}}return n}}(t,e)||v(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(t){return function(t){if(Array.isArray(t))return y(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||v(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(t,e){if(t){if("string"==typeof t)return y(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?y(t,e):void 0}}function y(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function g(){}function $(t,e){for(var n in e)t[n]=e[n];return t}function _(t){return t()}function k(){return Object.create(null)}function x(t){t.forEach(_)}function b(t){return"function"==typeof t}function w(t,e){return t!=t?e==e:t!==e||t&&"object"===n(t)||"function"==typeof t}function O(t,e){t.appendChild(e)}function C(t,e,n){t.insertBefore(e,n||null)}function M(t){t.parentNode.removeChild(t)}function T(t){return document.createElement(t)}function H(t){return document.createTextNode(t)}function S(){return H(" ")}function E(){return H("")}function N(t,e,n,i){return t.addEventListener(e,n,i),function(){return t.removeEventListener(e,n,i)}}function P(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function A(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}var L,j=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;i(this,t),this.a=e,this.e=this.n=null}return r(t,[{key:"m",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.e||(this.e=T(e.nodeName),this.t=e,this.h(t)),this.i(n)}},{key:"h",value:function(t){this.e.innerHTML=t,this.n=Array.from(this.e.childNodes)}},{key:"i",value:function(t){for(var e=0;e<this.n.length;e+=1)C(this.t,this.n[e],t)}},{key:"p",value:function(t){this.d(),this.h(t),this.i(this.a)}},{key:"d",value:function(){this.n.forEach(M)}}]),t}();function R(t){L=t}function I(){if(!L)throw new Error("Function called outside component initialization");return L}var W=[],D=[],q=[],F=[],B=Promise.resolve(),z=!1;function U(){z||(z=!0,B.then(V))}function G(){return U(),B}function J(t){q.push(t)}var K=!1,Q=new Set;function V(){if(!K){K=!0;do{for(var t=0;t<W.length;t+=1){var e=W[t];R(e),X(e.$$)}for(R(null),W.length=0;D.length;)D.pop()();for(var n=0;n<q.length;n+=1){var i=q[n];Q.has(i)||(Q.add(i),i())}q.length=0}while(W.length);for(;F.length;)F.pop()();z=!1,K=!1,Q.clear()}}function X(t){if(null!==t.fragment){t.update(),x(t.before_update);var e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(J)}}var Y,Z=new Set;function tt(){Y={r:0,c:[],p:Y}}function et(){Y.r||x(Y.c),Y=Y.p}function nt(t,e){t&&t.i&&(Z.delete(t),t.i(e))}function it(t,e,n,i){if(t&&t.o){if(Z.has(t))return;Z.add(t),Y.c.push(function(){Z.delete(t),i&&(n&&t.d(1),i())}),t.o(e)}}var ot="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:e;function rt(t,e){it(t,1,1,function(){e.delete(t.key)})}function st(t,e,n,i,o,r,s,a,c,l,u,f){for(var d=t.length,h=r.length,p=d,m={};p--;)m[t[p].key]=p;var v=[],y=new Map,g=new Map;for(p=h;p--;){var $=f(o,r,p),_=n($),k=s.get(_);k?i&&k.p($,e):(k=l(_,$)).c(),y.set(_,v[p]=k),_ in m&&g.set(_,Math.abs(p-m[_]))}var x=new Set,b=new Set;function w(t){nt(t,1),t.m(a,u),s.set(t.key,t),u=t.first,h--}for(;d&&h;){var O=v[h-1],C=t[d-1],M=O.key,T=C.key;O===C?(u=O.first,d--,h--):y.has(T)?!s.has(M)||x.has(M)?w(O):b.has(T)?d--:g.get(M)>g.get(T)?(b.add(M),w(O)):(x.add(T),d--):(c(C,s),d--)}for(;d--;){var H=t[d];y.has(H.key)||c(H,s)}for(;h;)w(v[h-1]);return v}function at(t,e){for(var n={},i={},o={$$scope:1},r=t.length;r--;){var s=t[r],a=e[r];if(a){for(var c in s)c in a||(i[c]=1);for(var l in a)o[l]||(n[l]=a[l],o[l]=1);t[r]=a}else for(var u in s)o[u]=1}for(var f in i)f in n||(n[f]=void 0);return n}function ct(t){return"object"===n(t)&&null!==t?t:{}}function lt(t){t&&t.c()}function ut(t,e,n){var i=t.$$,o=i.fragment,r=i.on_mount,s=i.on_destroy,a=i.after_update;o&&o.m(e,n),J(function(){var e=r.map(_).filter(b);s?s.push.apply(s,m(e)):x(e),t.$$.on_mount=[]}),a.forEach(J)}function ft(t,e){var n=t.$$;null!==n.fragment&&(x(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}var dt=function(){function t(){i(this,t)}return r(t,[{key:"$destroy",value:function(){ft(this,1),this.$destroy=g}},{key:"$on",value:function(t,e){var n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),function(){var t=n.indexOf(e);-1!==t&&n.splice(t,1)}}},{key:"$set",value:function(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}]),t}(),ht=function(){function t(e){if(i(this,t),Object.assign(this,{dir1:null,dir2:null,firstpos1:null,firstpos2:null,spacing1:25,spacing2:25,push:"bottom",maxOpen:1,maxStrategy:"wait",maxClosureCausesWait:!0,modal:"ish",modalishFlash:!0,overlayClose:!0,overlayClosesPinned:!1,positioned:!0,context:window&&document.body||null},e),"ish"===this.modal&&1!==this.maxOpen)throw new Error("A modalish stack must have a maxOpen value of 1.");if("ish"===this.modal&&!this.dir1)throw new Error("A modalish stack must have a direction.");if("top"===this.push&&"ish"===this.modal&&"close"!==this.maxStrategy)throw new Error("A modalish stack that pushes to the top must use the close maxStrategy.");this._noticeHead={notice:null,prev:null,next:null},this._noticeTail={notice:null,prev:this._noticeHead,next:null},this._noticeHead.next=this._noticeTail,this._noticeMap=new WeakMap,this._length=0,this._addpos2=0,this._animation=!0,this._posTimer=null,this._openNotices=0,this._listener=null,this._overlayOpen=!1,this._overlayInserted=!1,this._collapsingModalState=!1,this._leader=null,this._leaderOff=null,this._masking=null,this._maskingOff=null,this._swapping=!1,this._callbacks={}}return r(t,[{key:"forEach",value:function(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.start,o=void 0===i?"oldest":i,r=n.dir,s=void 0===r?"newer":r,a=n.skipModuleHandled,c=void 0!==a&&a;if("head"===o||"newest"===o&&"top"===this.push||"oldest"===o&&"bottom"===this.push)e=this._noticeHead.next;else if("tail"===o||"newest"===o&&"bottom"===this.push||"oldest"===o&&"top"===this.push)e=this._noticeTail.prev;else{if(!this._noticeMap.has(o))throw new Error("Invalid start param.");e=this._noticeMap.get(o)}for(;e.notice;){var l=e.notice;if("prev"===s||"top"===this.push&&"newer"===s||"bottom"===this.push&&"older"===s)e=e.prev;else{if(!("next"===s||"top"===this.push&&"older"===s||"bottom"===this.push&&"newer"===s))throw new Error("Invalid dir param.");e=e.next}if(!(c&&l.getModuleHandled()||!1!==t(l)))break}}},{key:"close",value:function(t){this.forEach(function(e){return e.close(t,!1,!1)})}},{key:"open",value:function(t){this.forEach(function(e){return e.open(t)})}},{key:"openLast",value:function(){this.forEach(function(t){if(-1===["opening","open","waiting"].indexOf(t.getState()))return t.open(),!1},{start:"newest",dir:"older"})}},{key:"swap",value:function(t,e){var n=this,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return-1===["open","opening","closing"].indexOf(t.getState())?Promise.reject():(this._swapping=e,t.close(i,!1,o).then(function(){return e.open(i)}).finally(function(){n._swapping=!1}))}},{key:"on",value:function(t,e){var n=this;return t in this._callbacks||(this._callbacks[t]=[]),this._callbacks[t].push(e),function(){n._callbacks[t].splice(n._callbacks[t].indexOf(e),1)}}},{key:"fire",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.stack=this,t in this._callbacks&&this._callbacks[t].forEach(function(t){return t(e)})}},{key:"position",value:function(){var t=this;this.positioned&&this._length>0?(this.fire("beforePosition"),this._resetPositionData(),this.forEach(function(e){t._positionNotice(e)},{start:"head",dir:"next",skipModuleHandled:!0}),this.fire("afterPosition")):(delete this._nextpos1,delete this._nextpos2)}},{key:"queuePosition",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;this._posTimer&&clearTimeout(this._posTimer),this._posTimer=setTimeout(function(){return t.position()},e)}},{key:"_resetPositionData",value:function(){this._nextpos1=this.firstpos1,this._nextpos2=this.firstpos2,this._addpos2=0}},{key:"_positionNotice",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t===this._masking;if(this.positioned){var n=t.refs.elem;if(n&&(n.classList.contains("pnotify-in")||n.classList.contains("pnotify-initial")||e)){var i=[this.firstpos1,this.firstpos2,this._nextpos1,this._nextpos2,this._addpos2],o=i[0],r=i[1],s=i[2],a=i[3],c=i[4];n.getBoundingClientRect(),!this._animation||e||this._collapsingModalState?t._setMoveClass(""):t._setMoveClass("pnotify-move");var l,u=this.context===document.body?window.innerHeight:this.context.scrollHeight,f=this.context===document.body?window.innerWidth:this.context.scrollWidth;if(this.dir1){var d;switch(l={down:"top",up:"bottom",left:"right",right:"left"}[this.dir1],this.dir1){case"down":d=n.offsetTop;break;case"up":d=u-n.scrollHeight-n.offsetTop;break;case"left":d=f-n.scrollWidth-n.offsetLeft;break;case"right":d=n.offsetLeft}null==o&&(s=o=d)}if(this.dir1&&this.dir2){var h,p={down:"top",up:"bottom",left:"right",right:"left"}[this.dir2];switch(this.dir2){case"down":h=n.offsetTop;break;case"up":h=u-n.scrollHeight-n.offsetTop;break;case"left":h=f-n.scrollWidth-n.offsetLeft;break;case"right":h=n.offsetLeft}if(null==r&&(a=r=h),!e){var m=s+n.offsetHeight+this.spacing1,v=s+n.offsetWidth+this.spacing1;(("down"===this.dir1||"up"===this.dir1)&&m>u||("left"===this.dir1||"right"===this.dir1)&&v>f)&&(s=o,a+=c+this.spacing2,c=0)}switch(null!=a&&(n.style[p]="".concat(a,"px"),this._animation||n.style[p]),this.dir2){case"down":case"up":n.offsetHeight+(parseFloat(n.style.marginTop,10)||0)+(parseFloat(n.style.marginBottom,10)||0)>c&&(c=n.offsetHeight);break;case"left":case"right":n.offsetWidth+(parseFloat(n.style.marginLeft,10)||0)+(parseFloat(n.style.marginRight,10)||0)>c&&(c=n.offsetWidth)}}else if(this.dir1){var y,g;switch(this.dir1){case"down":case"up":g=["left","right"],y=this.context.scrollWidth/2-n.offsetWidth/2;break;case"left":case"right":g=["top","bottom"],y=u/2-n.offsetHeight/2}n.style[g[0]]="".concat(y,"px"),n.style[g[1]]="auto",this._animation||n.style[g[0]]}if(this.dir1)switch(null!=s&&(n.style[l]="".concat(s,"px"),this._animation||n.style[l]),this.dir1){case"down":case"up":s+=n.offsetHeight+this.spacing1;break;case"left":case"right":s+=n.offsetWidth+this.spacing1}else{var $=f/2-n.offsetWidth/2,_=u/2-n.offsetHeight/2;n.style.left="".concat($,"px"),n.style.top="".concat(_,"px"),this._animation||n.style.left}e||(this.firstpos1=o,this.firstpos2=r,this._nextpos1=s,this._nextpos2=a,this._addpos2=c)}}}},{key:"_addNotice",value:function(t){var e=this;this.fire("beforeAddNotice",{notice:t});var n=function(){if(e.fire("beforeOpenNotice",{notice:t}),t.getModuleHandled())e.fire("afterOpenNotice",{notice:t});else{if(e._openNotices++,("ish"!==e.modal||!e._overlayOpen)&&e.maxOpen!==1/0&&e._openNotices>e.maxOpen&&"close"===e.maxStrategy){var n=e._openNotices-e.maxOpen;e.forEach(function(t){if(-1!==["opening","open"].indexOf(t.getState()))return t.close(!1,!1,e.maxClosureCausesWait),t===e._leader&&e._setLeader(null),!!--n})}!0===e.modal&&e._insertOverlay(),"ish"!==e.modal||e._leader&&-1!==["opening","open","closing"].indexOf(e._leader.getState())||e._setLeader(t),"ish"===e.modal&&e._overlayOpen&&t._preventTimerClose(!0),e.fire("afterOpenNotice",{notice:t})}},i={notice:t,prev:null,next:null,beforeOpenOff:t.on("pnotify:beforeOpen",n),afterCloseOff:t.on("pnotify:afterClose",function(){if(e.fire("beforeCloseNotice",{notice:t}),t.getModuleHandled())e.fire("afterCloseNotice",{notice:t});else{if(e._openNotices--,"ish"===e.modal&&t===e._leader&&(e._setLeader(null),e._masking&&e._setMasking(null)),!e._swapping&&e.maxOpen!==1/0&&e._openNotices<e.maxOpen){var n=!1,i=function(i){if(i!==t&&"waiting"===i.getState()&&(i.open().catch(function(){}),e._openNotices>=e.maxOpen))return n=!0,!1};"wait"===e.maxStrategy?(e.forEach(i,{start:t,dir:"next"}),n||e.forEach(i,{start:t,dir:"prev"})):"close"===e.maxStrategy&&e.maxClosureCausesWait&&(e.forEach(i,{start:t,dir:"older"}),n||e.forEach(i,{start:t,dir:"newer"}))}e._openNotices<=0?(e._openNotices=0,e._resetPositionData(),e._overlayOpen&&!e._swapping&&e._removeOverlay()):e._collapsingModalState||e.queuePosition(0),e.fire("afterCloseNotice",{notice:t})}})};if("top"===this.push?(i.next=this._noticeHead.next,i.prev=this._noticeHead,i.next.prev=i,i.prev.next=i):(i.prev=this._noticeTail.prev,i.next=this._noticeTail,i.prev.next=i,i.next.prev=i),this._noticeMap.set(t,i),this._length++,this._listener||(this._listener=function(){return e.position()},this.context.addEventListener("pnotify:position",this._listener)),-1!==["open","opening","closing"].indexOf(t.getState()))n();else if("ish"===this.modal&&this.modalishFlash&&this._shouldNoticeWait(t))var o=t.on("pnotify:mount",function(){o(),t._setMasking(!0,!1,function(){t._setMasking(!1)}),e._resetPositionData(),e._positionNotice(e._leader),window.requestAnimationFrame(function(){e._positionNotice(t,!0)})});this.fire("afterAddNotice",{notice:t})}},{key:"_removeNotice",value:function(t){if(this._noticeMap.has(t)){this.fire("beforeRemoveNotice",{notice:t});var e=this._noticeMap.get(t);this._leader===t&&this._setLeader(null),this._masking===t&&this._setMasking(null),e.prev.next=e.next,e.next.prev=e.prev,e.prev=null,e.next=null,e.beforeOpenOff(),e.beforeOpenOff=null,e.afterCloseOff(),e.afterCloseOff=null,this._noticeMap.delete(t),this._length--,!this._length&&this._listener&&(this.context.removeEventListener("pnotify:position",this._listener),this._listener=null),!this._length&&this._overlayOpen&&this._removeOverlay(),-1!==["open","opening","closing"].indexOf(t.getState())&&this._handleNoticeClosed(t),this.fire("afterRemoveNotice",{notice:t})}}},{key:"_setLeader",value:function(t){var e=this;if(this.fire("beforeSetLeader",{leader:t}),this._leaderOff&&(this._leaderOff(),this._leaderOff=null),this._leader=t,this._leader){var n,i=function(){var t=null;e._overlayOpen&&(e._collapsingModalState=!0,e.forEach(function(n){n._preventTimerClose(!1),n!==e._leader&&-1!==["opening","open"].indexOf(n.getState())&&(t||(t=n),n.close(n===t,!1,!0))},{start:e._leader,dir:"next",skipModuleHandled:!0}),e._removeOverlay()),o&&(clearTimeout(o),o=null),e.forEach(function(n){if(n!==e._leader)return"waiting"===n.getState()||n===t?(e._setMasking(n,!!t),!1):void 0},{start:e._leader,dir:"next",skipModuleHandled:!0})},o=null,r=function(){o&&(clearTimeout(o),o=null),o=setTimeout(function(){o=null,e._setMasking(null)},750)};this._leaderOff=(n=[this._leader.on("mouseenter",i),this._leader.on("focusin",i),this._leader.on("mouseleave",r),this._leader.on("focusout",r)],function(){return n.map(function(t){return t()})}),this.fire("afterSetLeader",{leader:t})}else this.fire("afterSetLeader",{leader:t})}},{key:"_setMasking",value:function(t,e){var n=this;if(this._masking){if(this._masking===t)return;this._masking._setMasking(!1,e)}if(this._maskingOff&&(this._maskingOff(),this._maskingOff=null),this._masking=t,this._masking){this._resetPositionData(),this._leader&&this._positionNotice(this._leader),this._masking._setMasking(!0,e),window.requestAnimationFrame(function(){n._masking&&n._positionNotice(n._masking)});var i,o=function(){"ish"===n.modal&&(n._insertOverlay(),n._setMasking(null,!0),n.forEach(function(t){t._preventTimerClose(!0),"waiting"===t.getState()&&t.open()},{start:n._leader,dir:"next",skipModuleHandled:!0}))};this._maskingOff=(i=[this._masking.on("mouseenter",o),this._masking.on("focusin",o)],function(){return i.map(function(t){return t()})})}}},{key:"_shouldNoticeWait",value:function(t){return this._swapping!==t&&!("ish"===this.modal&&this._overlayOpen)&&this.maxOpen!==1/0&&this._openNotices>=this.maxOpen&&"wait"===this.maxStrategy}},{key:"_insertOverlay",value:function(){var t=this;this._overlay||(this._overlay=document.createElement("div"),this._overlay.classList.add("pnotify-modal-overlay"),this.dir1&&this._overlay.classList.add("pnotify-modal-overlay-".concat(this.dir1)),this.overlayClose&&this._overlay.classList.add("pnotify-modal-overlay-closes"),this.context!==document.body&&(this._overlay.style.height="".concat(this.context.scrollHeight,"px"),this._overlay.style.width="".concat(this.context.scrollWidth,"px")),this._overlay.addEventListener("click",function(e){if(t.overlayClose){if(t.fire("overlayClose",{clickEvent:e}),e.defaultPrevented)return;t._leader&&t._setLeader(null),t.forEach(function(e){-1===["closed","closing","waiting"].indexOf(e.getState())&&(e.hide||t.overlayClosesPinned?e.close():e.hide||"ish"!==t.modal||(t._leader?e.close(!1,!1,!0):t._setLeader(e)))},{skipModuleHandled:!0}),t._overlayOpen&&t._removeOverlay()}})),this._overlay.parentNode!==this.context&&(this.fire("beforeAddOverlay"),this._overlay.classList.remove("pnotify-modal-overlay-in"),this._overlay=this.context.insertBefore(this._overlay,this.context.firstChild),this._overlayOpen=!0,this._overlayInserted=!0,window.requestAnimationFrame(function(){t._overlay.classList.add("pnotify-modal-overlay-in"),t.fire("afterAddOverlay")})),this._collapsingModalState=!1}},{key:"_removeOverlay",value:function(){var t=this;this._overlay.parentNode&&(this.fire("beforeRemoveOverlay"),this._overlay.classList.remove("pnotify-modal-overlay-in"),this._overlayOpen=!1,setTimeout(function(){t._overlayInserted=!1,t._overlay.parentNode&&(t._overlay.parentNode.removeChild(t._overlay),t.fire("afterRemoveOverlay"))},250),setTimeout(function(){t._collapsingModalState=!1},400))}},{key:"notices",get:function(){var t=[];return this.forEach(function(e){return t.push(e)}),t}},{key:"length",get:function(){return this._length}},{key:"leader",get:function(){return this._leader}}]),t}(),pt=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return d(Bt,e)},mt=ot.Map;function vt(t,e,n){var i=t.slice();return i[109]=e[n][0],i[110]=e[n][1],i}function yt(t,e,n){var i=t.slice();return i[109]=e[n][0],i[110]=e[n][1],i}function gt(t,e,n){var i=t.slice();return i[109]=e[n][0],i[110]=e[n][1],i}function $t(t,e,n){var i=t.slice();return i[109]=e[n][0],i[110]=e[n][1],i}function _t(t,e){var n,i,o,r,s=[{self:e[42]},e[110]],a=e[109].default;function c(t){for(var e={},n=0;n<s.length;n+=1)e=$(e,s[n]);return{props:e}}return a&&(i=new a(c())),{key:t,first:null,c:function(){n=E(),i&&lt(i.$$.fragment),o=E(),this.first=n},m:function(t,e){C(t,n,e),i&&ut(i,t,e),C(t,o,e),r=!0},p:function(t,e){var n=2176&e[1]?at(s,[2048&e[1]&&{self:t[42]},128&e[1]&&ct(t[110])]):{};if(a!==(a=t[109].default)){if(i){tt();var r=i;it(r.$$.fragment,1,0,function(){ft(r,1)}),et()}a?(lt((i=new a(c())).$$.fragment),nt(i.$$.fragment,1),ut(i,o.parentNode,o)):i=null}else a&&i.$set(n)},i:function(t){r||(i&&nt(i.$$.fragment,t),r=!0)},o:function(t){i&&it(i.$$.fragment,t),r=!1},d:function(t){t&&M(n),t&&M(o),i&&ft(i,t)}}}function kt(t){var e,n,i,o,r,s;return{c:function(){e=T("div"),P(n=T("span"),"class",t[22]("closer")),P(e,"class",i="pnotify-closer ".concat(t[21]("closer")," ").concat(t[17]&&!t[26]||t[28]?"pnotify-hidden":"")),P(e,"role","button"),P(e,"tabindex","0"),P(e,"title",o=t[20].close)},m:function(i,o){C(i,e,o),O(e,n),r||(s=N(e,"click",t[81]),r=!0)},p:function(t,n){335675392&n[0]&&i!==(i="pnotify-closer ".concat(t[21]("closer")," ").concat(t[17]&&!t[26]||t[28]?"pnotify-hidden":""))&&P(e,"class",i),1048576&n[0]&&o!==(o=t[20].close)&&P(e,"title",o)},d:function(t){t&&M(e),r=!1,s()}}}function xt(t){var e,n,i,o,r,s,a,c;return{c:function(){e=T("div"),P(n=T("span"),"class",i="".concat(t[22]("sticker")," ").concat(t[3]?t[22]("unstuck"):t[22]("stuck"))),P(e,"class",o="pnotify-sticker ".concat(t[21]("sticker")," ").concat(t[19]&&!t[26]||t[28]?"pnotify-hidden":"")),P(e,"role","button"),P(e,"aria-pressed",r=!t[3]),P(e,"tabindex","0"),P(e,"title",s=t[3]?t[20].stick:t[20].unstick)},m:function(i,o){C(i,e,o),O(e,n),a||(c=N(e,"click",t[82]),a=!0)},p:function(t,a){8&a[0]&&i!==(i="".concat(t[22]("sticker")," ").concat(t[3]?t[22]("unstuck"):t[22]("stuck")))&&P(n,"class",i),336068608&a[0]&&o!==(o="pnotify-sticker ".concat(t[21]("sticker")," ").concat(t[19]&&!t[26]||t[28]?"pnotify-hidden":""))&&P(e,"class",o),8&a[0]&&r!==(r=!t[3])&&P(e,"aria-pressed",r),1048584&a[0]&&s!==(s=t[3]?t[20].stick:t[20].unstick)&&P(e,"title",s)},d:function(t){t&&M(e),a=!1,c()}}}function bt(t){var e,n,i;return{c:function(){e=T("div"),P(n=T("span"),"class",i=!0===t[13]?t[22](t[4]):t[13]),P(e,"class","pnotify-icon ".concat(t[21]("icon")))},m:function(i,o){C(i,e,o),O(e,n),t[83](e)},p:function(t,e){8208&e[0]&&i!==(i=!0===t[13]?t[22](t[4]):t[13])&&P(n,"class",i)},d:function(n){n&&M(e),t[83](null)}}}function wt(t,e){var n,i,o,r,s=[{self:e[42]},e[110]],a=e[109].default;function c(t){for(var e={},n=0;n<s.length;n+=1)e=$(e,s[n]);return{props:e}}return a&&(i=new a(c())),{key:t,first:null,c:function(){n=E(),i&&lt(i.$$.fragment),o=E(),this.first=n},m:function(t,e){C(t,n,e),i&&ut(i,t,e),C(t,o,e),r=!0},p:function(t,e){var n=2304&e[1]?at(s,[2048&e[1]&&{self:t[42]},256&e[1]&&ct(t[110])]):{};if(a!==(a=t[109].default)){if(i){tt();var r=i;it(r.$$.fragment,1,0,function(){ft(r,1)}),et()}a?(lt((i=new a(c())).$$.fragment),nt(i.$$.fragment,1),ut(i,o.parentNode,o)):i=null}else a&&i.$set(n)},i:function(t){r||(i&&nt(i.$$.fragment,t),r=!0)},o:function(t){i&&it(i.$$.fragment,t),r=!1},d:function(t){t&&M(n),t&&M(o),i&&ft(i,t)}}}function Ot(t){var e,n=!t[34]&&Ct(t);return{c:function(){e=T("div"),n&&n.c(),P(e,"class","pnotify-title ".concat(t[21]("title")))},m:function(i,o){C(i,e,o),n&&n.m(e,null),t[84](e)},p:function(t,i){t[34]?n&&(n.d(1),n=null):n?n.p(t,i):((n=Ct(t)).c(),n.m(e,null))},d:function(i){i&&M(e),n&&n.d(),t[84](null)}}}function Ct(t){var e;function n(t,e){return t[6]?Tt:Mt}var i=n(t),o=i(t);return{c:function(){o.c(),e=E()},m:function(t,n){o.m(t,n),C(t,e,n)},p:function(t,r){i===(i=n(t))&&o?o.p(t,r):(o.d(1),(o=i(t))&&(o.c(),o.m(e.parentNode,e)))},d:function(t){o.d(t),t&&M(e)}}}function Mt(t){var e,n;return{c:function(){e=T("span"),n=H(t[5]),P(e,"class","pnotify-pre-line")},m:function(t,i){C(t,e,i),O(e,n)},p:function(t,e){32&e[0]&&A(n,t[5])},d:function(t){t&&M(e)}}}function Tt(t){var e,n;return{c:function(){n=E(),e=new j(n)},m:function(i,o){e.m(t[5],i,o),C(i,n,o)},p:function(t,n){32&n[0]&&e.p(t[5])},d:function(t){t&&M(n),t&&e.d()}}}function Ht(t){var e,n,i=!t[35]&&St(t);return{c:function(){e=T("div"),i&&i.c(),P(e,"class",n="pnotify-text ".concat(t[21]("text")," ").concat(""===t[33]?"":"pnotify-text-with-max-height")),P(e,"style",t[33]),P(e,"role","alert")},m:function(n,o){C(n,e,o),i&&i.m(e,null),t[85](e)},p:function(t,o){t[35]?i&&(i.d(1),i=null):i?i.p(t,o):((i=St(t)).c(),i.m(e,null)),4&o[1]&&n!==(n="pnotify-text ".concat(t[21]("text")," ").concat(""===t[33]?"":"pnotify-text-with-max-height"))&&P(e,"class",n),4&o[1]&&P(e,"style",t[33])},d:function(n){n&&M(e),i&&i.d(),t[85](null)}}}function St(t){var e;function n(t,e){return t[8]?Nt:Et}var i=n(t),o=i(t);return{c:function(){o.c(),e=E()},m:function(t,n){o.m(t,n),C(t,e,n)},p:function(t,r){i===(i=n(t))&&o?o.p(t,r):(o.d(1),(o=i(t))&&(o.c(),o.m(e.parentNode,e)))},d:function(t){o.d(t),t&&M(e)}}}function Et(t){var e,n;return{c:function(){e=T("span"),n=H(t[7]),P(e,"class","pnotify-pre-line")},m:function(t,i){C(t,e,i),O(e,n)},p:function(t,e){128&e[0]&&A(n,t[7])},d:function(t){t&&M(e)}}}function Nt(t){var e,n;return{c:function(){n=E(),e=new j(n)},m:function(i,o){e.m(t[7],i,o),C(i,n,o)},p:function(t,n){128&n[0]&&e.p(t[7])},d:function(t){t&&M(n),t&&e.d()}}}function Pt(t,e){var n,i,o,r,s=[{self:e[42]},e[110]],a=e[109].default;function c(t){for(var e={},n=0;n<s.length;n+=1)e=$(e,s[n]);return{props:e}}return a&&(i=new a(c())),{key:t,first:null,c:function(){n=E(),i&&lt(i.$$.fragment),o=E(),this.first=n},m:function(t,e){C(t,n,e),i&&ut(i,t,e),C(t,o,e),r=!0},p:function(t,e){var n=2560&e[1]?at(s,[2048&e[1]&&{self:t[42]},512&e[1]&&ct(t[110])]):{};if(a!==(a=t[109].default)){if(i){tt();var r=i;it(r.$$.fragment,1,0,function(){ft(r,1)}),et()}a?(lt((i=new a(c())).$$.fragment),nt(i.$$.fragment,1),ut(i,o.parentNode,o)):i=null}else a&&i.$set(n)},i:function(t){r||(i&&nt(i.$$.fragment,t),r=!0)},o:function(t){i&&it(i.$$.fragment,t),r=!1},d:function(t){t&&M(n),t&&M(o),i&&ft(i,t)}}}function At(t,e){var n,i,o,r,s=[{self:e[42]},e[110]],a=e[109].default;function c(t){for(var e={},n=0;n<s.length;n+=1)e=$(e,s[n]);return{props:e}}return a&&(i=new a(c())),{key:t,first:null,c:function(){n=E(),i&&lt(i.$$.fragment),o=E(),this.first=n},m:function(t,e){C(t,n,e),i&&ut(i,t,e),C(t,o,e),r=!0},p:function(t,e){var n=3072&e[1]?at(s,[2048&e[1]&&{self:t[42]},1024&e[1]&&ct(t[110])]):{};if(a!==(a=t[109].default)){if(i){tt();var r=i;it(r.$$.fragment,1,0,function(){ft(r,1)}),et()}a?(lt((i=new a(c())).$$.fragment),nt(i.$$.fragment,1),ut(i,o.parentNode,o)):i=null}else a&&i.$set(n)},i:function(t){r||(i&&nt(i.$$.fragment,t),r=!0)},o:function(t){i&&it(i.$$.fragment,t),r=!1},d:function(t){t&&M(n),t&&M(o),i&&ft(i,t)}}}function Lt(t){for(var e,n,i,o,r,s,a,c,l,u,f,d,h,p,m,v,y,$=[],_=new mt,k=[],w=new mt,H=[],E=new mt,A=[],L=new mt,j=t[38],R=function(t){return t[109]},I=0;I<j.length;I+=1){var W=$t(t,j,I),D=R(W);_.set(D,$[I]=_t(D,W))}for(var q=t[16]&&!t[36]&&kt(t),F=t[18]&&!t[36]&&xt(t),B=!1!==t[13]&&bt(t),z=t[39],U=function(t){return t[109]},G=0;G<z.length;G+=1){var J=gt(t,z,G),K=U(J);w.set(K,k[G]=wt(K,J))}for(var Q=!1!==t[5]&&Ot(t),V=!1!==t[7]&&Ht(t),X=t[40],Y=function(t){return t[109]},Z=0;Z<X.length;Z+=1){var ot=yt(t,X,Z),at=Y(ot);E.set(at,H[Z]=Pt(at,ot))}for(var ct=t[41],lt=function(t){return t[109]},ut=0;ut<ct.length;ut+=1){var ft=vt(t,ct,ut),dt=lt(ft);L.set(dt,A[ut]=At(dt,ft))}return{c:function(){e=T("div"),n=T("div");for(var m=0;m<$.length;m+=1)$[m].c();i=S(),q&&q.c(),o=S(),F&&F.c(),r=S(),B&&B.c(),s=S(),a=T("div");for(var v=0;v<k.length;v+=1)k[v].c();c=S(),Q&&Q.c(),l=S(),V&&V.c(),u=S();for(var y=0;y<H.length;y+=1)H[y].c();f=S();for(var g=0;g<A.length;g+=1)A[g].c();P(a,"class","pnotify-content ".concat(t[21]("content"))),P(n,"class",d="pnotify-container ".concat(t[21]("container")," ").concat(t[21](t[4])," ").concat(t[15]?"pnotify-shadow":""," ").concat(t[27].container.join(" "))),P(n,"style",h="".concat(t[31]," ").concat(t[32])),P(n,"role","alert"),P(e,"data-pnotify",""),P(e,"class",p="pnotify ".concat(!t[0]||t[0].positioned?"pnotify-positioned":""," ").concat(!1!==t[13]?"pnotify-with-icon":""," ").concat(t[21]("elem")," pnotify-mode-").concat(t[9]," ").concat(t[10]," ").concat(t[24]," ").concat(t[25]," ").concat(t[37]," ").concat("fade"===t[2]?"pnotify-fade-".concat(t[14]):""," ").concat(t[30]?"pnotify-modal ".concat(t[11]):t[12]," ").concat(t[28]?"pnotify-masking":""," ").concat(t[29]?"pnotify-masking-in":""," ").concat(t[27].elem.join(" "))),P(e,"aria-live","assertive"),P(e,"role","alertdialog")},m:function(d,h){C(d,e,h),O(e,n);for(var p=0;p<$.length;p+=1)$[p].m(n,null);O(n,i),q&&q.m(n,null),O(n,o),F&&F.m(n,null),O(n,r),B&&B.m(n,null),O(n,s),O(n,a);for(var _=0;_<k.length;_+=1)k[_].m(a,null);O(a,c),Q&&Q.m(a,null),O(a,l),V&&V.m(a,null),O(a,u);for(var x=0;x<H.length;x+=1)H[x].m(a,null);t[86](a),O(n,f);for(var w=0;w<A.length;w+=1)A[w].m(n,null);var M;t[87](n),t[88](e),m=!0,v||(y=[(M=t[43].call(null,e),M&&b(M.destroy)?M.destroy:g),N(e,"mouseenter",t[44]),N(e,"mouseleave",t[45]),N(e,"focusin",t[44]),N(e,"focusout",t[45])],v=!0)},p:function(t,f){if(2176&f[1]){var v=t[38];tt(),$=st($,f,R,1,t,v,_,n,rt,_t,i,$t),et()}if(t[16]&&!t[36]?q?q.p(t,f):((q=kt(t)).c(),q.m(n,o)):q&&(q.d(1),q=null),t[18]&&!t[36]?F?F.p(t,f):((F=xt(t)).c(),F.m(n,r)):F&&(F.d(1),F=null),!1!==t[13]?B?B.p(t,f):((B=bt(t)).c(),B.m(n,s)):B&&(B.d(1),B=null),2304&f[1]){var y=t[39];tt(),k=st(k,f,U,1,t,y,w,a,rt,wt,c,gt),et()}if(!1!==t[5]?Q?Q.p(t,f):((Q=Ot(t)).c(),Q.m(a,l)):Q&&(Q.d(1),Q=null),!1!==t[7]?V?V.p(t,f):((V=Ht(t)).c(),V.m(a,u)):V&&(V.d(1),V=null),2560&f[1]){var g=t[40];tt(),H=st(H,f,Y,1,t,g,E,a,rt,Pt,null,yt),et()}if(3072&f[1]){var x=t[41];tt(),A=st(A,f,lt,1,t,x,L,n,rt,At,null,vt),et()}(!m||134250512&f[0]&&d!==(d="pnotify-container ".concat(t[21]("container")," ").concat(t[21](t[4])," ").concat(t[15]?"pnotify-shadow":""," ").concat(t[27].container.join(" "))))&&P(n,"class",d),(!m||3&f[1]&&h!==(h="".concat(t[31]," ").concat(t[32])))&&P(n,"style",h),(!m||2063629829&f[0]|64&f[1]&&p!==(p="pnotify ".concat(!t[0]||t[0].positioned?"pnotify-positioned":""," ").concat(!1!==t[13]?"pnotify-with-icon":""," ").concat(t[21]("elem")," pnotify-mode-").concat(t[9]," ").concat(t[10]," ").concat(t[24]," ").concat(t[25]," ").concat(t[37]," ").concat("fade"===t[2]?"pnotify-fade-".concat(t[14]):""," ").concat(t[30]?"pnotify-modal ".concat(t[11]):t[12]," ").concat(t[28]?"pnotify-masking":""," ").concat(t[29]?"pnotify-masking-in":""," ").concat(t[27].elem.join(" "))))&&P(e,"class",p)},i:function(t){if(!m){for(var e=0;e<j.length;e+=1)nt($[e]);for(var n=0;n<z.length;n+=1)nt(k[n]);for(var i=0;i<X.length;i+=1)nt(H[i]);for(var o=0;o<ct.length;o+=1)nt(A[o]);m=!0}},o:function(t){for(var e=0;e<$.length;e+=1)it($[e]);for(var n=0;n<k.length;n+=1)it(k[n]);for(var i=0;i<H.length;i+=1)it(H[i]);for(var o=0;o<A.length;o+=1)it(A[o]);m=!1},d:function(n){n&&M(e);for(var i=0;i<$.length;i+=1)$[i].d();q&&q.d(),F&&F.d(),B&&B.d();for(var o=0;o<k.length;o+=1)k[o].d();Q&&Q.d(),V&&V.d();for(var r=0;r<H.length;r+=1)H[r].d();t[86](null);for(var s=0;s<A.length;s+=1)A[s].d();t[87](null),t[88](null),v=!1,x(y)}}}function jt(t,e){"object"!==n(t)&&(t={text:t}),e&&(t.type=e);var i=document.body;return"stack"in t&&t.stack&&t.stack.context&&(i=t.stack.context),{target:i,props:t}}var Rt,It=new ht({dir1:"down",dir2:"left",firstpos1:25,firstpos2:25,spacing1:36,spacing2:36,push:"bottom"}),Wt=new Map,Dt={type:"notice",title:!1,titleTrusted:!1,text:!1,textTrusted:!1,styling:"brighttheme",icons:"brighttheme",mode:"no-preference",addClass:"",addModalClass:"",addModelessClass:"",autoOpen:!0,width:"360px",minHeight:"16px",maxTextHeight:"200px",icon:!0,animation:"fade",animateSpeed:"normal",shadow:!0,hide:!0,delay:8e3,mouseReset:!0,closer:!0,closerHover:!0,sticker:!0,stickerHover:!0,labels:{close:"Close",stick:"Pin",unstick:"Unpin"},remove:!0,destroy:!0,stack:It,modules:Wt};function qt(){It.context||(It.context=document.body),window.addEventListener("resize",function(){Rt&&clearTimeout(Rt),Rt=setTimeout(function(){var t=new Event("pnotify:position");document.body.dispatchEvent(t),Rt=null},10)})}function Ft(t,e,n){var i=I(),o=function(){var t=I();return function(e,n){var i=t.$$.callbacks[e];if(i){var o=function(t,e){var n=document.createEvent("CustomEvent");return n.initCustomEvent(t,!1,!1,e),n}(e,n);i.slice().forEach(function(e){e.call(t,o)})}}}(),r=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=["focus","blur","fullscreenchange","fullscreenerror","scroll","cut","copy","paste","keydown","keypress","keyup","auxclick","click","contextmenu","dblclick","mousedown","mouseenter","mouseleave","mousemove","mouseover","mouseout","mouseup","pointerlockchange","pointerlockerror","select","wheel","drag","dragend","dragenter","dragstart","dragleave","dragover","drop","touchcancel","touchend","touchmove","touchstart","pointerover","pointerenter","pointerdown","pointermove","pointerup","pointercancel","pointerout","pointerleave","gotpointercapture","lostpointercapture"].concat(m(e));function i(e){!function(t,e){var n=t.$$.callbacks[e.type];n&&n.slice().forEach(function(t){return t(e)})}(t,e)}return function(t){for(var e=[],o=0;o<n.length;o++)e.push(N(t,n[o],i));return{destroy:function(){for(var t=0;t<e.length;t++)e[t]()}}}}(i,["pnotify:init","pnotify:mount","pnotify:update","pnotify:beforeOpen","pnotify:afterOpen","pnotify:enterModal","pnotify:leaveModal","pnotify:beforeClose","pnotify:afterClose","pnotify:beforeDestroy","pnotify:afterDestroy","focusin","focusout","animationend","transitionend"]),s=e.modules,a=void 0===s?new Map(Dt.modules):s,l=e.stack,u=void 0===l?Dt.stack:l,f={elem:null,container:null,content:null,iconContainer:null,titleContainer:null,textContainer:null},d=c({},Dt);Jt("init",{notice:i,defaults:d});var h,v=e.type,y=void 0===v?d.type:v,g=e.title,$=void 0===g?d.title:g,_=e.titleTrusted,k=void 0===_?d.titleTrusted:_,x=e.text,b=void 0===x?d.text:x,w=e.textTrusted,O=void 0===w?d.textTrusted:w,C=e.styling,M=void 0===C?d.styling:C,T=e.icons,H=void 0===T?d.icons:T,S=e.mode,E=void 0===S?d.mode:S,P=e.addClass,A=void 0===P?d.addClass:P,L=e.addModalClass,j=void 0===L?d.addModalClass:L,R=e.addModelessClass,W=void 0===R?d.addModelessClass:R,q=e.autoOpen,F=void 0===q?d.autoOpen:q,B=e.width,z=void 0===B?d.width:B,U=e.minHeight,J=void 0===U?d.minHeight:U,K=e.maxTextHeight,Q=void 0===K?d.maxTextHeight:K,V=e.icon,X=void 0===V?d.icon:V,Y=e.animation,Z=void 0===Y?d.animation:Y,tt=e.animateSpeed,et=void 0===tt?d.animateSpeed:tt,nt=e.shadow,it=void 0===nt?d.shadow:nt,ot=e.hide,rt=void 0===ot?d.hide:ot,st=e.delay,at=void 0===st?d.delay:st,ct=e.mouseReset,lt=void 0===ct?d.mouseReset:ct,ut=e.closer,ft=void 0===ut?d.closer:ut,dt=e.closerHover,ht=void 0===dt?d.closerHover:dt,pt=e.sticker,mt=void 0===pt?d.sticker:pt,vt=e.stickerHover,yt=void 0===vt?d.stickerHover:vt,gt=e.labels,$t=void 0===gt?d.labels:gt,_t=e.remove,kt=void 0===_t?d.remove:_t,xt=e.destroy,bt=void 0===xt?d.destroy:xt,wt="closed",Ot=null,Ct=null,Mt=null,Tt=!1,Ht="",St="",Et=!1,Nt=!1,Pt={elem:[],container:[]},At=!1,Lt=!1,jt=!1,Rt=!1,It=null,Wt=rt,qt=null,Ft=null,Bt=u&&(!0===u.modal||"ish"===u.modal&&"prevented"===Ot),zt=NaN,Ut=null,Gt=null;function Jt(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=c({notice:i},e);"init"===t&&Array.from(a).forEach(function(t){var e=p(t,2),i=e[0];return e[1],"init"in i&&i.init(n)});var r=f.elem||u&&u.context||document.body;if(!r)return o("pnotify:".concat(t),n),!0;var s=new Event("pnotify:".concat(t),{bubbles:"init"===t||"mount"===t,cancelable:t.startsWith("before")});return s.detail=n,r.dispatchEvent(s),!s.defaultPrevented}function Kt(){var t=u&&u.context||document.body;if(!t)throw new Error("No context to insert this notice into.");if(!f.elem)throw new Error("Trying to insert notice before element is available.");f.elem.parentNode!==t&&t.appendChild(f.elem)}function Qt(){f.elem&&f.elem.parentNode.removeChild(f.elem)}h=function(){Jt("mount"),F&&ce().catch(function(){})},I().$$.on_mount.push(h),I().$$.before_update.push(function(){Jt("update"),"closed"!==wt&&"waiting"!==wt&&rt!==Wt&&(rt?Wt||ve():me()),"closed"!==wt&&"closing"!==wt&&u&&!u._collapsingModalState&&u.queuePosition(),Wt=rt});var Vt,Xt,Yt,Zt,te,ee,ne,ie,oe,re,se,ae=e.open,ce=void 0===ae?function(t){if("opening"===wt)return qt;if("open"===wt)return rt&&ve(),Promise.resolve();if(!At&&u&&u._shouldNoticeWait(i))return wt="waiting",Promise.reject();if(!Jt("beforeOpen",{immediate:t}))return Promise.reject();var e,o;wt="opening",n(28,jt=!1),n(24,Ht="pnotify-initial pnotify-hidden");var r=new Promise(function(t,n){e=t,o=n});qt=r;var s=function(){rt&&ve(),wt="open",Jt("afterOpen",{immediate:t}),qt=null,e()};return Lt?(s(),Promise.resolve()):(Kt(),window.requestAnimationFrame(function(){if("opening"!==wt)return o(),void(qt=null);u&&(n(0,u._animation=!1,u),"top"===u.push&&u._resetPositionData(),u._positionNotice(i),u.queuePosition(0),n(0,u._animation=!0,u)),de(s,t)}),r)}:ae,le=e.close,ue=void 0===le?function(t,e,o){if("closing"===wt)return Ft;if("closed"===wt)return Promise.resolve();var r,s=function(){Jt("beforeDestroy")&&(u&&u._removeNotice(i),i.$destroy(),Jt("afterDestroy"))};if("waiting"===wt)return o||(wt="closed",bt&&!o&&s()),Promise.resolve();if(!Jt("beforeClose",{immediate:t,timerHide:e,waitAfterward:o}))return Promise.reject();wt="closing",Et=!!e,Ot&&"prevented"!==Ot&&clearTimeout&&clearTimeout(Ot),Ot=null;var a=new Promise(function(t,e){r=t});return Ft=a,pe(function(){n(26,Nt=!1),Et=!1,wt=o?"waiting":"closed",Jt("afterClose",{immediate:t,timerHide:e,waitAfterward:o}),Ft=null,r(),o||(bt?s():kt&&Qt())},t),a}:le,fe=e.animateIn,de=void 0===fe?function(t,e){Tt="in";var i=function e(n){if(!(n&&f.elem&&n.target!==f.elem||(f.elem&&f.elem.removeEventListener("transitionend",e),Ct&&clearTimeout(Ct),"in"!==Tt))){var i=Lt;if(!i&&f.elem){var o=f.elem.getBoundingClientRect();for(var r in o)if(o[r]>0){i=!0;break}}i?(t&&t.call(),Tt=!1):Ct=setTimeout(e,40)}};if("fade"!==Z||e){var o=Z;n(2,Z="none"),n(24,Ht="pnotify-in ".concat("fade"===o?"pnotify-fade-in":"")),G().then(function(){n(2,Z=o),i()})}else f.elem&&f.elem.addEventListener("transitionend",i),n(24,Ht="pnotify-in"),G().then(function(){n(24,Ht="pnotify-in pnotify-fade-in"),Ct=setTimeout(i,650)})}:fe,he=e.animateOut,pe=void 0===he?function(t,e){Tt="out";var i=function e(i){if(!(i&&f.elem&&i.target!==f.elem||(f.elem&&f.elem.removeEventListener("transitionend",e),Mt&&clearTimeout(Mt),"out"!==Tt))){var o=Lt;if(!o&&f.elem){var r=f.elem.getBoundingClientRect();for(var s in r)if(r[s]>0){o=!0;break}}f.elem&&f.elem.style.opacity&&"0"!==f.elem.style.opacity&&o?Mt=setTimeout(e,40):(n(24,Ht=""),t&&t.call(),Tt=!1)}};"fade"!==Z||e?(n(24,Ht=""),G().then(function(){i()})):(f.elem&&f.elem.addEventListener("transitionend",i),n(24,Ht="pnotify-in"),Mt=setTimeout(i,650))}:he;function me(){Ot&&"prevented"!==Ot&&(clearTimeout(Ot),Ot=null),Mt&&clearTimeout(Mt),"closing"===wt&&(wt="open",Tt=!1,n(24,Ht="fade"===Z?"pnotify-in pnotify-fade-in":"pnotify-in"))}function ve(){"prevented"!==Ot&&(me(),at!==1/0&&(Ot=setTimeout(function(){return ue(!1,!0)},isNaN(at)?0:at)))}return t.$$set=function(t){"modules"in t&&n(46,a=t.modules),"stack"in t&&n(0,u=t.stack),"type"in t&&n(4,y=t.type),"title"in t&&n(5,$=t.title),"titleTrusted"in t&&n(6,k=t.titleTrusted),"text"in t&&n(7,b=t.text),"textTrusted"in t&&n(8,O=t.textTrusted),"styling"in t&&n(47,M=t.styling),"icons"in t&&n(48,H=t.icons),"mode"in t&&n(9,E=t.mode),"addClass"in t&&n(10,A=t.addClass),"addModalClass"in t&&n(11,j=t.addModalClass),"addModelessClass"in t&&n(12,W=t.addModelessClass),"autoOpen"in t&&n(49,F=t.autoOpen),"width"in t&&n(50,z=t.width),"minHeight"in t&&n(51,J=t.minHeight),"maxTextHeight"in t&&n(52,Q=t.maxTextHeight),"icon"in t&&n(13,X=t.icon),"animation"in t&&n(2,Z=t.animation),"animateSpeed"in t&&n(14,et=t.animateSpeed),"shadow"in t&&n(15,it=t.shadow),"hide"in t&&n(3,rt=t.hide),"delay"in t&&n(53,at=t.delay),"mouseReset"in t&&n(54,lt=t.mouseReset),"closer"in t&&n(16,ft=t.closer),"closerHover"in t&&n(17,ht=t.closerHover),"sticker"in t&&n(18,mt=t.sticker),"stickerHover"in t&&n(19,yt=t.stickerHover),"labels"in t&&n(20,$t=t.labels),"remove"in t&&n(55,kt=t.remove),"destroy"in t&&n(56,bt=t.destroy),"open"in t&&n(59,ce=t.open),"close"in t&&n(23,ue=t.close),"animateIn"in t&&n(60,de=t.animateIn),"animateOut"in t&&n(61,pe=t.animateOut)},t.$$.update=function(){524288&t.$$.dirty[1]&&n(31,Vt="string"==typeof z?"width: ".concat(z,";"):""),1048576&t.$$.dirty[1]&&n(32,Xt="string"==typeof J?"min-height: ".concat(J,";"):""),2097152&t.$$.dirty[1]&&n(33,Yt="string"==typeof Q?"max-height: ".concat(Q,";"):""),32&t.$$.dirty[0]&&n(34,Zt=$ instanceof HTMLElement),128&t.$$.dirty[0]&&n(35,te=b instanceof HTMLElement),1&t.$$.dirty[0]|1792&t.$$.dirty[3]&&zt!==u&&(zt&&(zt._removeNotice(i),n(30,Bt=!1),Ut(),Gt()),u&&(u._addNotice(i),n(102,Ut=u.on("beforeAddOverlay",function(){n(30,Bt=!0),Jt("enterModal")})),n(103,Gt=u.on("afterRemoveOverlay",function(){n(30,Bt=!1),Jt("leaveModal")}))),n(101,zt=u)),1073748992&t.$$.dirty[0]&&n(36,ee=A.match(/\bnonblock\b/)||j.match(/\bnonblock\b/)&&Bt||W.match(/\bnonblock\b/)&&!Bt),1&t.$$.dirty[0]&&n(37,ne=u&&u.dir1?"pnotify-stack-".concat(u.dir1):""),32768&t.$$.dirty[1]&&n(38,ie=Array.from(a).filter(function(t){var e=p(t,2),n=e[0];return e[1],"PrependContainer"===n.position})),32768&t.$$.dirty[1]&&n(39,oe=Array.from(a).filter(function(t){var e=p(t,2),n=e[0];return e[1],"PrependContent"===n.position})),32768&t.$$.dirty[1]&&n(40,re=Array.from(a).filter(function(t){var e=p(t,2),n=e[0];return e[1],"AppendContent"===n.position})),32768&t.$$.dirty[1]&&n(41,se=Array.from(a).filter(function(t){var e=p(t,2),n=e[0];return e[1],"AppendContainer"===n.position})),34&t.$$.dirty[0]|8&t.$$.dirty[1]&&Zt&&f.titleContainer&&f.titleContainer.appendChild($),130&t.$$.dirty[0]|16&t.$$.dirty[1]&&te&&f.textContainer&&f.textContainer.appendChild(b)},[u,f,Z,rt,y,$,k,b,O,E,A,j,W,X,et,it,ft,ht,mt,yt,$t,function(t){return"string"==typeof M?"".concat(M,"-").concat(t):t in M?M[t]:"".concat(M.prefix,"-").concat(t)},function(t){return"string"==typeof H?"".concat(H,"-icon-").concat(t):t in H?H[t]:"".concat(H.prefix,"-icon-").concat(t)},ue,Ht,St,Nt,Pt,jt,Rt,Bt,Vt,Xt,Yt,Zt,te,ee,ne,ie,oe,re,se,i,r,function(t){if(n(26,Nt=!0),lt&&"closing"===wt){if(!Et)return;me()}rt&&lt&&me()},function(t){n(26,Nt=!1),rt&&lt&&"out"!==Tt&&-1!==["open","opening"].indexOf(wt)&&ve()},a,M,H,F,z,J,Q,at,lt,kt,bt,function(){return wt},function(){return Ot},ce,de,pe,me,ve,function(t){t?(me(),Ot="prevented"):"prevented"===Ot&&(Ot=null,"open"===wt&&rt&&ve())},function(){return i.$on.apply(i,arguments)},function(){return i.$set.apply(i,arguments)},function(t,e){o(t,e)},function(t){for(var e=0;e<(arguments.length<=1?0:arguments.length-1);e++){var i=e+1<1||arguments.length<=e+1?void 0:arguments[e+1];-1===Pt[t].indexOf(i)&&Pt[t].push(i)}n(27,Pt)},function(t){for(var e=0;e<(arguments.length<=1?0:arguments.length-1);e++){var i=e+1<1||arguments.length<=e+1?void 0:arguments[e+1],o=Pt[t].indexOf(i);-1!==o&&Pt[t].splice(o,1)}n(27,Pt)},function(t){for(var e=0;e<(arguments.length<=1?0:arguments.length-1);e++){var n=e+1<1||arguments.length<=e+1?void 0:arguments[e+1];if(-1===Pt[t].indexOf(n))return!1}return!0},function(){return At},function(t){return At=t},function(){return Lt},function(t){return Lt=t},function(t){return Tt=t},function(){return Ht},function(t){return n(24,Ht=t)},function(){return St},function(t){return n(25,St=t)},function(t,e,i){if(It&&clearTimeout(It),jt!==t)if(t)n(28,jt=!0),n(29,Rt=!!e),Kt(),G().then(function(){window.requestAnimationFrame(function(){if(jt)if(e&&i)i();else{n(29,Rt=!0);var t=function t(){f.elem&&f.elem.removeEventListener("transitionend",t),It&&clearTimeout(It),Rt&&i&&i()};f.elem&&f.elem.addEventListener("transitionend",t),It=setTimeout(t,650)}})});else if(e)n(28,jt=!1),n(29,Rt=!1),kt&&-1===["open","opening","closing"].indexOf(wt)&&Qt(),i&&i();else{var o=function t(){f.elem&&f.elem.removeEventListener("transitionend",t),It&&clearTimeout(It),Rt||(n(28,jt=!1),kt&&-1===["open","opening","closing"].indexOf(wt)&&Qt(),i&&i())};n(29,Rt=!1),f.elem&&f.elem.addEventListener("transitionend",o),f.elem&&f.elem.style.opacity,It=setTimeout(o,650)}},function(){return ue(!1)},function(){return n(3,rt=!rt)},function(t){D[t?"unshift":"push"](function(){f.iconContainer=t,n(1,f)})},function(t){D[t?"unshift":"push"](function(){f.titleContainer=t,n(1,f)})},function(t){D[t?"unshift":"push"](function(){f.textContainer=t,n(1,f)})},function(t){D[t?"unshift":"push"](function(){f.content=t,n(1,f)})},function(t){D[t?"unshift":"push"](function(){f.container=t,n(1,f)})},function(t){D[t?"unshift":"push"](function(){f.elem=t,n(1,f)})}]}window&&document.body?qt():document.addEventListener("DOMContentLoaded",qt);var Bt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(s,dt);var e,n,o=(e=s,n=f(),function(){var t,i=l(e);if(n){var o=l(this).constructor;t=Reflect.construct(i,arguments,o)}else t=i.apply(this,arguments);return function(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?h(t):e}(this,t)});function s(t){var e;return i(this,s),function(t,e,n,i,o,r){var s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[-1],a=L;R(t);var c=e.props||{},l=t.$$={fragment:null,ctx:null,props:{modules:46,stack:0,refs:1,type:4,title:5,titleTrusted:6,text:7,textTrusted:8,styling:47,icons:48,mode:9,addClass:10,addModalClass:11,addModelessClass:12,autoOpen:49,width:50,minHeight:51,maxTextHeight:52,icon:13,animation:2,animateSpeed:14,shadow:15,hide:3,delay:53,mouseReset:54,closer:16,closerHover:17,sticker:18,stickerHover:19,labels:20,remove:55,destroy:56,getState:57,getTimer:58,getStyle:21,getIcon:22,open:59,close:23,animateIn:60,animateOut:61,cancelClose:62,queueClose:63,_preventTimerClose:64,on:65,update:66,fire:67,addModuleClass:68,removeModuleClass:69,hasModuleClass:70,getModuleHandled:71,setModuleHandled:72,getModuleOpen:73,setModuleOpen:74,setAnimating:75,getAnimatingClass:76,setAnimatingClass:77,_getMoveClass:78,_setMoveClass:79,_setMasking:80},update:g,not_equal:o,bound:k(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(a?a.$$.context:[]),callbacks:k(),dirty:s,skip_bound:!1},u=!1;if(l.ctx=n?n(t,c,function(e,n){var i=!(arguments.length<=2)&&arguments.length-2?arguments.length<=2?void 0:arguments[2]:n;return l.ctx&&o(l.ctx[e],l.ctx[e]=i)&&(!l.skip_bound&&l.bound[e]&&l.bound[e](i),u&&function(t,e){-1===t.$$.dirty[0]&&(W.push(t),U(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}(t,e)),n}):[],l.update(),u=!0,x(l.before_update),l.fragment=!!i&&i(l.ctx),e.target){if(e.hydrate){var f=function(t){return Array.from(t.childNodes)}(e.target);l.fragment&&l.fragment.l(f),f.forEach(M)}else l.fragment&&l.fragment.c();e.intro&&nt(t.$$.fragment),ut(t,e.target,e.anchor),V()}R(a)}(h(e=o.call(this)),t,Ft,Lt,w,{modules:46,stack:0,refs:1,type:4,title:5,titleTrusted:6,text:7,textTrusted:8,styling:47,icons:48,mode:9,addClass:10,addModalClass:11,addModelessClass:12,autoOpen:49,width:50,minHeight:51,maxTextHeight:52,icon:13,animation:2,animateSpeed:14,shadow:15,hide:3,delay:53,mouseReset:54,closer:16,closerHover:17,sticker:18,stickerHover:19,labels:20,remove:55,destroy:56,getState:57,getTimer:58,getStyle:21,getIcon:22,open:59,close:23,animateIn:60,animateOut:61,cancelClose:62,queueClose:63,_preventTimerClose:64,on:65,update:66,fire:67,addModuleClass:68,removeModuleClass:69,hasModuleClass:70,getModuleHandled:71,setModuleHandled:72,getModuleOpen:73,setModuleOpen:74,setAnimating:75,getAnimatingClass:76,setAnimatingClass:77,_getMoveClass:78,_setMoveClass:79,_setMasking:80},[-1,-1,-1,-1]),e}return r(s,[{key:"modules",get:function(){return this.$$.ctx[46]},set:function(t){this.$set({modules:t}),V()}},{key:"stack",get:function(){return this.$$.ctx[0]},set:function(t){this.$set({stack:t}),V()}},{key:"refs",get:function(){return this.$$.ctx[1]}},{key:"type",get:function(){return this.$$.ctx[4]},set:function(t){this.$set({type:t}),V()}},{key:"title",get:function(){return this.$$.ctx[5]},set:function(t){this.$set({title:t}),V()}},{key:"titleTrusted",get:function(){return this.$$.ctx[6]},set:function(t){this.$set({titleTrusted:t}),V()}},{key:"text",get:function(){return this.$$.ctx[7]},set:function(t){this.$set({text:t}),V()}},{key:"textTrusted",get:function(){return this.$$.ctx[8]},set:function(t){this.$set({textTrusted:t}),V()}},{key:"styling",get:function(){return this.$$.ctx[47]},set:function(t){this.$set({styling:t}),V()}},{key:"icons",get:function(){return this.$$.ctx[48]},set:function(t){this.$set({icons:t}),V()}},{key:"mode",get:function(){return this.$$.ctx[9]},set:function(t){this.$set({mode:t}),V()}},{key:"addClass",get:function(){return this.$$.ctx[10]},set:function(t){this.$set({addClass:t}),V()}},{key:"addModalClass",get:function(){return this.$$.ctx[11]},set:function(t){this.$set({addModalClass:t}),V()}},{key:"addModelessClass",get:function(){return this.$$.ctx[12]},set:function(t){this.$set({addModelessClass:t}),V()}},{key:"autoOpen",get:function(){return this.$$.ctx[49]},set:function(t){this.$set({autoOpen:t}),V()}},{key:"width",get:function(){return this.$$.ctx[50]},set:function(t){this.$set({width:t}),V()}},{key:"minHeight",get:function(){return this.$$.ctx[51]},set:function(t){this.$set({minHeight:t}),V()}},{key:"maxTextHeight",get:function(){return this.$$.ctx[52]},set:function(t){this.$set({maxTextHeight:t}),V()}},{key:"icon",get:function(){return this.$$.ctx[13]},set:function(t){this.$set({icon:t}),V()}},{key:"animation",get:function(){return this.$$.ctx[2]},set:function(t){this.$set({animation:t}),V()}},{key:"animateSpeed",get:function(){return this.$$.ctx[14]},set:function(t){this.$set({animateSpeed:t}),V()}},{key:"shadow",get:function(){return this.$$.ctx[15]},set:function(t){this.$set({shadow:t}),V()}},{key:"hide",get:function(){return this.$$.ctx[3]},set:function(t){this.$set({hide:t}),V()}},{key:"delay",get:function(){return this.$$.ctx[53]},set:function(t){this.$set({delay:t}),V()}},{key:"mouseReset",get:function(){return this.$$.ctx[54]},set:function(t){this.$set({mouseReset:t}),V()}},{key:"closer",get:function(){return this.$$.ctx[16]},set:function(t){this.$set({closer:t}),V()}},{key:"closerHover",get:function(){return this.$$.ctx[17]},set:function(t){this.$set({closerHover:t}),V()}},{key:"sticker",get:function(){return this.$$.ctx[18]},set:function(t){this.$set({sticker:t}),V()}},{key:"stickerHover",get:function(){return this.$$.ctx[19]},set:function(t){this.$set({stickerHover:t}),V()}},{key:"labels",get:function(){return this.$$.ctx[20]},set:function(t){this.$set({labels:t}),V()}},{key:"remove",get:function(){return this.$$.ctx[55]},set:function(t){this.$set({remove:t}),V()}},{key:"destroy",get:function(){return this.$$.ctx[56]},set:function(t){this.$set({destroy:t}),V()}},{key:"getState",get:function(){return this.$$.ctx[57]}},{key:"getTimer",get:function(){return this.$$.ctx[58]}},{key:"getStyle",get:function(){return this.$$.ctx[21]}},{key:"getIcon",get:function(){return this.$$.ctx[22]}},{key:"open",get:function(){return this.$$.ctx[59]},set:function(t){this.$set({open:t}),V()}},{key:"close",get:function(){return this.$$.ctx[23]},set:function(t){this.$set({close:t}),V()}},{key:"animateIn",get:function(){return this.$$.ctx[60]},set:function(t){this.$set({animateIn:t}),V()}},{key:"animateOut",get:function(){return this.$$.ctx[61]},set:function(t){this.$set({animateOut:t}),V()}},{key:"cancelClose",get:function(){return this.$$.ctx[62]}},{key:"queueClose",get:function(){return this.$$.ctx[63]}},{key:"_preventTimerClose",get:function(){return this.$$.ctx[64]}},{key:"on",get:function(){return this.$$.ctx[65]}},{key:"update",get:function(){return this.$$.ctx[66]}},{key:"fire",get:function(){return this.$$.ctx[67]}},{key:"addModuleClass",get:function(){return this.$$.ctx[68]}},{key:"removeModuleClass",get:function(){return this.$$.ctx[69]}},{key:"hasModuleClass",get:function(){return this.$$.ctx[70]}},{key:"getModuleHandled",get:function(){return this.$$.ctx[71]}},{key:"setModuleHandled",get:function(){return this.$$.ctx[72]}},{key:"getModuleOpen",get:function(){return this.$$.ctx[73]}},{key:"setModuleOpen",get:function(){return this.$$.ctx[74]}},{key:"setAnimating",get:function(){return this.$$.ctx[75]}},{key:"getAnimatingClass",get:function(){return this.$$.ctx[76]}},{key:"setAnimatingClass",get:function(){return this.$$.ctx[77]}},{key:"_getMoveClass",get:function(){return this.$$.ctx[78]}},{key:"_setMoveClass",get:function(){return this.$$.ctx[79]}},{key:"_setMasking",get:function(){return this.$$.ctx[80]}}]),s}();t.Stack=ht,t.alert=function(t){return pt(jt(t))},t.default=Bt,t.defaultModules=Wt,t.defaultStack=It,t.defaults=Dt,t.error=function(t){return pt(jt(t,"error"))},t.info=function(t){return pt(jt(t,"info"))},t.notice=function(t){return pt(jt(t,"notice"))},t.success=function(t){return pt(jt(t,"success"))},Object.defineProperty(t,"__esModule",{value:!0})});
},{}],"AjW3":[function(require,module,exports) {

},{}],"ad6a":[function(require,module,exports) {
var define;
var global = arguments[3];
var t,e=arguments[3];!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof t&&t.amd?t(["exports"],n):n((e="undefined"!=typeof globalThis?globalThis:e||self).PNotifyMobile={})}(this,function(t){"use strict";function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function i(t){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function f(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var n,r=i(t);if(e){var o=i(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?f(t):e}(this,n)}}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function a(){}function l(t){return t()}function p(){return Object.create(null)}function y(t){t.forEach(l)}function d(t){return"function"==typeof t}function m(t,e){return t!=t?e==e:t!==e||t&&"object"===n(t)||"function"==typeof t}function h(t){t.parentNode.removeChild(t)}var v;function g(t){v=t}function b(){if(!v)throw new Error("Function called outside component initialization");return v}var _=[],$=[],w=[],P=[],x=Promise.resolve(),O=!1;function j(t){w.push(t)}var k=!1,S=new Set;function E(){if(!k){k=!0;do{for(var t=0;t<_.length;t+=1){var e=_[t];g(e),D(e.$$)}for(g(null),_.length=0;$.length;)$.pop()();for(var n=0;n<w.length;n+=1){var r=w[n];S.has(r)||(S.add(r),r())}w.length=0}while(_.length);for(;P.length;)P.pop()();O=!1,k=!1,S.clear()}}function D(t){if(null!==t.fragment){t.update(),y(t.before_update);var e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(j)}}var A=new Set;var T="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:e;function C(t,e,n){var r=t.$$,o=r.fragment,i=r.on_mount,s=r.on_destroy,f=r.after_update;o&&o.m(e,n),j(function(){var e=i.map(l).filter(d);s?s.push.apply(s,function(t){return function(t){if(Array.isArray(t))return u(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return u(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(e)):y(e),t.$$.on_mount=[]}),f.forEach(j)}var M=function(){function t(){r(this,t)}var e,n;return e=t,(n=[{key:"$destroy",value:function(){var t;null!==(t=this.$$).fragment&&(y(t.on_destroy),t.fragment&&t.fragment.d(1),t.on_destroy=t.fragment=null,t.ctx=[]),this.$destroy=a}},{key:"$on",value:function(t,e){var n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),function(){var t=n.indexOf(e);-1!==t&&n.splice(t,1)}}},{key:"$set",value:function(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}])&&o(e.prototype,n),t}(),R=T.window;function W(t){var e,n;return{c:a,m:function(r,o){var i,s,f,c;e||(i=R,s="resize",f=t[3],i.addEventListener(s,f,c),n=function(){return i.removeEventListener(s,f,c)},e=!0)},p:a,i:a,o:a,d:function(t){e=!1,n()}}}var q={swipeDismiss:!0};function I(t,e,n){var r,o=e.self,i=void 0===o?null:o,s=e.swipeDismiss,f=void 0===s?q.swipeDismiss:s,c=null,u=null,a=null,l=null,p="left",y="X",d="Width",m=window.innerWidth,h=[];return r=function(){h=[i.on("touchstart",function(t){if(f){var e=i.stack;if(e)switch(e.dir1){case"up":case"down":p="left",y="X",d="Width";break;case"left":case"right":p="top",y="Y",d="Height"}c=t.touches[0]["screen".concat(y)],a=i.refs.elem["scroll".concat(d)],l=window.getComputedStyle(i.refs.elem).opacity,n(1,i.refs.container.style[p]=0,i)}}),i.on("touchmove",function(t){if(c&&f){var e=t.touches[0]["screen".concat(y)];u=e-c;var r=(1-Math.abs(u)/a)*l;n(1,i.refs.elem.style.opacity=r,i),n(1,i.refs.container.style[p]="".concat(u,"px"),i)}}),i.on("touchend",function(){if(c&&f){if(i.refs.container.classList.add("pnotify-mobile-animate-left"),Math.abs(u)>40){var t=u<0?-2*a:2*a;n(1,i.refs.elem.style.opacity=0,i),n(1,i.refs.container.style[p]="".concat(t,"px"),i),i.close()}else i.refs.elem.style.removeProperty("opacity"),i.refs.container.style.removeProperty(p);c=null,u=null,a=null,l=null}}),i.on("touchcancel",function(){c&&f&&(i.refs.elem.style.removeProperty("opacity"),i.refs.container.style.removeProperty(p),c=null,u=null,a=null,l=null)}),i.on("pnotify:afterClose",function(){f&&(i.refs.elem.style.removeProperty("opacity"),i.refs.container.style.removeProperty("left"),i.refs.container.style.removeProperty("top"))})]},b().$$.on_mount.push(r),b().$$.on_destroy.push(function(){h.forEach(function(t){return t()})}),t.$$set=function(t){"self"in t&&n(1,i=t.self),"swipeDismiss"in t&&n(2,f=t.swipeDismiss)},t.$$.update=function(){if(3&t.$$.dirty){var e=i.stack;e&&(m<=480?"_m_spacing1"in e||(e._m_spacing1=e.spacing1,e._m_firstpos1=e.firstpos1,e._m_spacing2=e.spacing2,e._m_firstpos2=e.firstpos2,e.spacing1=0,e.firstpos1=0,e.spacing2=0,e.firstpos2=0,e.queuePosition()):"_m_spacing1"in e&&(e.spacing1=e._m_spacing1,delete e._m_spacing1,e.firstpos1=e._m_firstpos1,delete e._m_firstpos1,e.spacing2=e._m_spacing2,delete e._m_spacing2,e.firstpos2=e._m_firstpos2,delete e._m_firstpos2,e.queuePosition()))}},[m,i,f,function(){return n(0,m=window.innerWidth)}]}var L=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(n,M);var e=c(n);function n(t){var o;return r(this,n),function(t,e,n,r,o,i){var s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:[-1],f=v;g(t);var c=e.props||{},u=t.$$={fragment:null,ctx:null,props:{self:1,swipeDismiss:2},update:a,not_equal:o,bound:p(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(f?f.$$.context:[]),callbacks:p(),dirty:s,skip_bound:!1},l=!1;if(u.ctx=n?n(t,c,function(e,n){var r=!(arguments.length<=2)&&arguments.length-2?arguments.length<=2?void 0:arguments[2]:n;return u.ctx&&o(u.ctx[e],u.ctx[e]=r)&&(!u.skip_bound&&u.bound[e]&&u.bound[e](r),l&&function(t,e){-1===t.$$.dirty[0]&&(_.push(t),O||(O=!0,x.then(E)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}(t,e)),n}):[],u.update(),l=!0,y(u.before_update),u.fragment=!!r&&r(u.ctx),e.target){if(e.hydrate){var d=function(t){return Array.from(t.childNodes)}(e.target);u.fragment&&u.fragment.l(d),d.forEach(h)}else u.fragment&&u.fragment.c();e.intro&&function(t,e){t&&t.i&&(A.delete(t),t.i(e))}(t.$$.fragment),C(t,e.target,e.anchor),E()}g(f)}(f(o=e.call(this)),t,I,W,m,{self:1,swipeDismiss:2}),o}return n}();t.default=L,t.defaults=q,t.position="PrependContainer",Object.defineProperty(t,"__esModule",{value:!0})});
},{}],"fRfm":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.authErrorMsg=a,exports.closeAuthModalMsg=d,exports.emptyLibraryMsg=u,exports.emptyMovie=p,exports.errorMsg=l,exports.notEnterSearchQuery=f,exports.registrationErrorMsg=c,exports.signOutMsg=s,exports.successfulRegistrationMsg=n,exports.successfulSignInMsg=i,exports.wrongRequest=y;var e=require("@pnotify/core");require("@pnotify/core/dist/PNotify.css");var t=o(require("@pnotify/mobile"));function r(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,o=new WeakMap;return(r=function(e){return e?o:t})(e)}function o(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var o=r(t);if(o&&o.has(e))return o.get(e);var n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var u=i?Object.getOwnPropertyDescriptor(e,s):null;u&&(u.get||u.set)?Object.defineProperty(n,s,u):n[s]=e[s]}return n.default=e,o&&o.set(e,n),n}function n(){(0,e.notice)({text:"Thank you for joining Filmoteka!",delay:2e3})}function i(){(0,e.notice)({text:"Welcome to Filmoteka",delay:2e3})}function s(){(0,e.notice)({text:"Goodbye!",delay:2e3})}function u(){(0,e.info)({text:"There are no movies in your library!",delay:2e3})}function a(){(0,e.error)({text:"Invalid e-mail or password.",delay:2e3})}function c(t){(0,e.error)({text:`${t}!`,delay:2e3})}function l(){(0,e.error)({text:"Ooops, something went wrong...",delay:2e3})}function f(){(0,e.notice)({text:"Please enter your search request!",delay:2e3})}function p(){(0,e.error)({text:"Enter the correct movie name!",delay:2e3})}function y(){(0,e.error)({text:"Search result not successful. Enter the correct movie name!",delay:2e3})}function d(){(0,e.notice)({text:"Please SIGN IN or REGISTER to use the Movie Library!",delay:2e3})}require("@pnotify/mobile/dist/PNotifyMobile.css"),require("@pnotify/core/dist/BrightTheme.css"),e.defaultModules.set(t,{});
},{"@pnotify/core":"txz9","@pnotify/core/dist/PNotify.css":"AjW3","@pnotify/mobile":"ad6a","@pnotify/mobile/dist/PNotifyMobile.css":"AjW3","@pnotify/core/dist/BrightTheme.css":"AjW3"}],"lXUY":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var l=a(require("handlebars/dist/handlebars.runtime"));function a(l){return l&&l.__esModule?l:{default:l}}const e=l.default.template({1:function(l,a,e,n,t){var o,i=null!=a?a:l.nullContext||{},r=l.hooks.helperMissing,s=l.escapeExpression,c=l.lookupProperty||function(l,a){if(Object.prototype.hasOwnProperty.call(l,a))return l[a]};return"      <img src='https://image.tmdb.org/t/p/w500/"+s("function"==typeof(o=null!=(o=c(e,"poster_path")||(null!=a?c(a,"poster_path"):a))?o:r)?o.call(i,{name:"poster_path",hash:{},data:t,loc:{start:{line:6,column:48},end:{line:6,column:63}}}):o)+"' alt="+s("function"==typeof(o=null!=(o=c(e,"title")||(null!=a?c(a,"title"):a))?o:r)?o.call(i,{name:"title",hash:{},data:t,loc:{start:{line:6,column:69},end:{line:6,column:78}}}):o)+" class='movie-modal__img' />\r\n"},3:function(l,a,e,n,t){var o,i=l.lookupProperty||function(l,a){if(Object.prototype.hasOwnProperty.call(l,a))return l[a]};return'      <img class="gallery__image" src="https://raw.githubusercontent.com/alexkarmhon/cinema/main/src/images/coming-soon.jpg" alt="'+l.escapeExpression("function"==typeof(o=null!=(o=i(e,"title")||(null!=a?i(a,"title"):a))?o:l.hooks.helperMissing)?o.call(null!=a?a:l.nullContext||{},{name:"title",hash:{},data:t,loc:{start:{line:8,column:130},end:{line:8,column:139}}}):o)+'">\r\n'},5:function(l,a,e,n,t){return"              <li class='movie-modal__characteristic-genre'>"+l.escapeExpression(l.lambda(a,a))+'<span class="mod-cutter">, </span></li>\r\n'},compiler:[8,">= 4.3.0"],main:function(l,a,e,n,t){var o,i,r=null!=a?a:l.nullContext||{},s=l.hooks.helperMissing,c="function",m=l.escapeExpression,u=l.lookupProperty||function(l,a){if(Object.prototype.hasOwnProperty.call(l,a))return l[a]};return"<div class=\"movie-modal\">\r\n  <div class='movie-modal__wrapper'>\r\n    <button class='movie-modal__btn-close js-movie-modal-close' aria-label='close'></button>\r\n    <div class='movie-modal__img-wrapper'>\r\n"+(null!=(o=u(e,"if").call(r,null!=a?u(a,"poster_path"):a,{name:"if",hash:{},fn:l.program(1,t,0),inverse:l.program(3,t,0),data:t,loc:{start:{line:5,column:6},end:{line:9,column:13}}}))?o:"")+"    </div>\r\n    <div class='movie-modal__info'>\r\n      <h2 class='movie-modal__title'>"+m(typeof(i=null!=(i=u(e,"title")||(null!=a?u(a,"title"):a))?i:s)===c?i.call(r,{name:"title",hash:{},data:t,loc:{start:{line:12,column:37},end:{line:12,column:46}}}):i)+"</h2>\r\n      <ul class='movie-modal__characteristics list'>\r\n        <li class='movie-modal__characteristic'>\r\n          <span class='movie-modal__characteristic-label'>Vote / Votes</span>\r\n            <span class='movie-modal__characteristic-value'>\r\n              <span class='movie-modal__vote-average'>\r\n                "+m(typeof(i=null!=(i=u(e,"vote_average")||(null!=a?u(a,"vote_average"):a))?i:s)===c?i.call(r,{name:"vote_average",hash:{},data:t,loc:{start:{line:18,column:16},end:{line:18,column:32}}}):i)+"\r\n              </span>\r\n              /\r\n              <span class='movie-modal__vote-count'>\r\n                "+m(typeof(i=null!=(i=u(e,"vote_count")||(null!=a?u(a,"vote_count"):a))?i:s)===c?i.call(r,{name:"vote_count",hash:{},data:t,loc:{start:{line:22,column:16},end:{line:22,column:30}}}):i)+"\r\n              </span>\r\n            </span>\r\n        </li>\r\n        <li class='movie-modal__characteristic'>\r\n            <span class='movie-modal__characteristic-label'>Popularity</span>\r\n            <span class='movie-modal__characteristic-value'>"+m(typeof(i=null!=(i=u(e,"popularity")||(null!=a?u(a,"popularity"):a))?i:s)===c?i.call(r,{name:"popularity",hash:{},data:t,loc:{start:{line:28,column:60},end:{line:28,column:74}}}):i)+"</span>\r\n          </li>\r\n          <li class='movie-modal__characteristic'>\r\n            <span class='movie-modal__characteristic-label'>Original Title</span>\r\n            <span class='movie-modal__characteristic-value movie-modal__characteristic-value-title'>"+m(typeof(i=null!=(i=u(e,"original_title")||(null!=a?u(a,"original_title"):a))?i:s)===c?i.call(r,{name:"original_title",hash:{},data:t,loc:{start:{line:32,column:100},end:{line:32,column:118}}}):i)+"</span>\r\n          </li>\r\n          <li class='movie-modal__characteristic'>\r\n            <span class='movie-modal__characteristic-label'>Genre</span>\r\n            <ul class='movie-modal__characteristic-genres list'>\r\n"+(null!=(o=u(e,"each").call(r,null!=a?u(a,"genre_ids"):a,{name:"each",hash:{},fn:l.program(5,t,0),inverse:l.noop,data:t,loc:{start:{line:37,column:14},end:{line:39,column:23}}}))?o:"")+"            </ul>\r\n          </li>\r\n      </ul>\r\n      <div class='movie-modal__desc'>\r\n        <h4 class='movie-modal__desc-label'>About</h4>\r\n        <p class='movie-modal__desc-text'>\r\n        "+m(typeof(i=null!=(i=u(e,"overview")||(null!=a?u(a,"overview"):a))?i:s)===c?i.call(r,{name:"overview",hash:{},data:t,loc:{start:{line:46,column:8},end:{line:46,column:20}}}):i)+"\r\n        </p>\r\n      </div>\r\n      <div class='movie-modal__buttons' data-film-title=\""+m(typeof(i=null!=(i=u(e,"title")||(null!=a?u(a,"title"):a))?i:s)===c?i.call(r,{name:"title",hash:{},data:t,loc:{start:{line:49,column:57},end:{line:49,column:66}}}):i)+'" data-film-id="'+m(typeof(i=null!=(i=u(e,"id")||(null!=a?u(a,"id"):a))?i:s)===c?i.call(r,{name:"id",hash:{},data:t,loc:{start:{line:49,column:82},end:{line:49,column:88}}}):i)+'">\r\n        <button id="add-remove-watched-btn" data-type="watchedMovies" data-action=\'add\'\r\n          class=\'movie-modal__btn\'>\r\n          Add to watched\r\n        </button>\r\n        <button id="add-remove-queue-btn" data-type="queuedMovies" data-action=\'add\'\r\n          class=\'movie-modal__btn\'>\r\n          Add to queue\r\n        </button>\r\n        <button class="movie-modal__btn" data-action="show-trailer" data-id="'+m(typeof(i=null!=(i=u(e,"id")||(null!=a?u(a,"id"):a))?i:s)===c?i.call(r,{name:"id",hash:{},data:t,loc:{start:{line:58,column:77},end:{line:58,column:83}}}):i)+'">Trailer</button>\r\n      </div>\r\n    </div>  \r\n  </div>\r\n</div>'},useData:!0});var n=exports.default=e;
},{"handlebars/dist/handlebars.runtime":"pAws"}],"kkvB":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=r(require("handlebars/dist/handlebars.runtime"));function r(e){return e&&e.__esModule?e:{default:e}}const l=e.default.template({compiler:[8,">= 4.3.0"],main:function(e,r,l,a,t){var o,n=e.lookupProperty||function(e,r){if(Object.prototype.hasOwnProperty.call(e,r))return e[r]};return'<div class="trailer-modal">\r\n  <div class=\'trailer-modal__wrapper\'>\r\n    <button class=\'movie-modal__btn-close js-trailer-modal-close\' aria-label=\'close\'></button>\r\n    <div class="movie-modal__trailer-wrapper">\r\n      <iframe\r\n         class="movie-modal__trailer"\r\n         src="https://www.youtube.com/embed/'+e.escapeExpression("function"==typeof(o=null!=(o=n(l,"key")||(null!=r?n(r,"key"):r))?o:e.hooks.helperMissing)?o.call(null!=r?r:e.nullContext||{},{name:"key",hash:{},data:t,loc:{start:{line:9,column:44},end:{line:9,column:51}}}):o)+'"\r\n         title="YouTube video player"\r\n         frameborder="0"\r\n         allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"\r\n         allowfullscreen\r\n      ></iframe>\r\n    </div>\r\n  </div>\r\n</div>'},useData:!0});var a=exports.default=l;
},{"handlebars/dist/handlebars.runtime":"pAws"}],"BNjD":[function(require,module,exports) {
var define;
var global = arguments[3];
var e,n=arguments[3];!function(t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof e&&e.amd?e([],t):("undefined"!=typeof window?window:void 0!==n?n:"undefined"!=typeof self?self:this).basicLightbox=t()}(function(){return function e(n,t,o){function r(c,u){if(!t[c]){if(!n[c]){var a="function"==typeof require&&require;if(!u&&a)return a(c,!0);if(i)return i(c,!0);var s=new Error("Cannot find module '"+c+"'");throw s.code="MODULE_NOT_FOUND",s}var l=t[c]={exports:{}};n[c][0].call(l.exports,function(e){return r(n[c][1][e]||e)},l,l.exports,e,n,t,o)}return t[c].exports}for(var i="function"==typeof require&&require,c=0;c<o.length;c++)r(o[c]);return r}({1:[function(e,n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.create=t.visible=void 0;var o=function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],t=document.createElement("div");return t.innerHTML=e.trim(),!0===n?t.children:t.firstChild},r=function(e,n){var t=e.children;return 1===t.length&&t[0].tagName===n},i=function(e){return null!=(e=e||document.querySelector(".basicLightbox"))&&!0===e.ownerDocument.body.contains(e)};t.visible=i,t.create=function(e,n){var t=function(e,n){var t=o('\n\t\t<div class="basicLightbox '.concat(n.className,'">\n\t\t\t<div class="basicLightbox__placeholder" role="dialog"></div>\n\t\t</div>\n\t')),i=t.querySelector(".basicLightbox__placeholder");e.forEach(function(e){return i.appendChild(e)});var c=r(i,"IMG"),u=r(i,"VIDEO"),a=r(i,"IFRAME");return!0===c&&t.classList.add("basicLightbox--img"),!0===u&&t.classList.add("basicLightbox--video"),!0===a&&t.classList.add("basicLightbox--iframe"),t}(e=function(e){var n="string"==typeof e,t=e instanceof HTMLElement==1;if(!1===n&&!1===t)throw new Error("Content must be a DOM element/node or string");return!0===n?Array.from(o(e,!0)):"TEMPLATE"===e.tagName?[e.content.cloneNode(!0)]:Array.from(e.children)}(e),n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(null==(e=Object.assign({},e)).closable&&(e.closable=!0),null==e.className&&(e.className=""),null==e.onShow&&(e.onShow=function(){}),null==e.onClose&&(e.onClose=function(){}),"boolean"!=typeof e.closable)throw new Error("Property `closable` must be a boolean");if("string"!=typeof e.className)throw new Error("Property `className` must be a string");if("function"!=typeof e.onShow)throw new Error("Property `onShow` must be a function");if("function"!=typeof e.onClose)throw new Error("Property `onClose` must be a function");return e}(n)),c=function(e){return!1!==n.onClose(u)&&function(e,n){return e.classList.remove("basicLightbox--visible"),setTimeout(function(){return!1===i(e)||e.parentElement.removeChild(e),n()},410),!0}(t,function(){if("function"==typeof e)return e(u)})};!0===n.closable&&t.addEventListener("click",function(e){e.target===t&&c()});var u={element:function(){return t},visible:function(){return i(t)},show:function(e){return!1!==n.onShow(u)&&function(e,n){return document.body.appendChild(e),setTimeout(function(){requestAnimationFrame(function(){return e.classList.add("basicLightbox--visible"),n()})},10),!0}(t,function(){if("function"==typeof e)return e(u)})},close:c};return u}},{}]},{},[1])(1)});
},{}],"OeGu":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.filterFilmByQuery=n,exports.parseGenresToFilm=i;var e=r(require("./filmsAPI"));function r(e){return e&&e.__esModule?e:{default:e}}const t=new e.default;function i(e,r){return e.map(e=>({...e,release_date:e.release_date.slice(0,4),genre_ids:e.genre_ids.length?r.reduce((r,{id:t,name:i})=>e.genre_ids.includes(+t)&&r.length<2?[...r,i]:r,[]):["No genres"]}))}function n(e){return e.map(async({film_title:e,film_id:r})=>{t.query=e;const{results:i}=await t.fetchFilmsByName();return i.filter(({id:e})=>e===Number(r))})}
},{"./filmsAPI":"rqiq"}],"VyiV":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.watchedBtn=exports.switcher=exports.sun=exports.signUpBtn=exports.signOutBtn=exports.signInForm=exports.searchInput=exports.searchFormInput=exports.registrationBtn=exports.regForm=exports.regCloseBtn=exports.queueBtn=exports.moreFilmsBtn=exports.moon=exports.modalSignInBtn=exports.modalReg=exports.modalCloseBtn=exports.modalAuth=exports.libraryBtn=exports.homeBtn=exports.headerLibBtns=exports.header=exports.filmList=exports.body=void 0;const e=exports.header=document.querySelector(".header"),t=exports.homeBtn=document.querySelector("#home-btn"),o=exports.libraryBtn=document.querySelector("#my-lib-btn"),r=exports.signOutBtn=document.querySelector("#sign-out-btn"),n=exports.searchInput=document.querySelector(".form-wrapper"),s=exports.headerLibBtns=document.querySelector("#h-lib-btns"),u=exports.watchedBtn=document.querySelector("#btn-watched"),c=exports.queueBtn=document.querySelector("#btn-queue"),m=exports.switcher=document.querySelector("#theme-btn"),p=exports.body=document.querySelector("body"),l=exports.sun=document.querySelector("#sun"),d=exports.moon=document.querySelector("#moon"),x=exports.filmList=document.querySelector("#film-list"),i=exports.moreFilmsBtn=document.querySelector("#load-more-btn"),a=exports.searchFormInput=document.querySelector("#search-form"),y=exports.modalAuth=document.querySelector("#auth-modal-backdrop"),q=exports.modalCloseBtn=document.querySelector("#auth-modal-close-btn"),S=exports.modalSignInBtn=document.querySelector("#signin-btn"),b=exports.registrationBtn=document.querySelector("#registration-btn"),h=exports.signInForm=document.querySelector("#auth-form"),B=exports.modalReg=document.querySelector("#registration-modal-backdrop"),g=exports.regCloseBtn=document.querySelector("#registration-modal-close-btn"),f=exports.signUpBtn=document.querySelector("#signUp-btn"),F=exports.regForm=document.querySelector("#reg-form");
},{}],"pBGv":[function(require,module,exports) {

var t,e,n=module.exports={};function r(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function i(e){if(t===setTimeout)return setTimeout(e,0);if((t===r||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}function u(t){if(e===clearTimeout)return clearTimeout(t);if((e===o||!e)&&clearTimeout)return e=clearTimeout,clearTimeout(t);try{return e(t)}catch(n){try{return e.call(null,t)}catch(n){return e.call(this,t)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:r}catch(n){t=r}try{e="function"==typeof clearTimeout?clearTimeout:o}catch(n){e=o}}();var c,s=[],l=!1,a=-1;function f(){l&&c&&(l=!1,c.length?s=c.concat(s):a=-1,s.length&&h())}function h(){if(!l){var t=i(f);l=!0;for(var e=s.length;e;){for(c=s,s=[];++a<e;)c&&c[a].run();a=-1,e=s.length}c=null,l=!1,u(t)}}function m(t,e){this.fun=t,this.array=e}function p(){}n.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];s.push(new m(t,e)),1!==s.length||l||i(h)},m.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.env={},n.argv=[],n.version="",n.versions={},n.on=p,n.addListener=p,n.once=p,n.off=p,n.removeListener=p,n.removeAllListeners=p,n.emit=p,n.prependListener=p,n.prependOnceListener=p,n.listeners=function(t){return[]},n.binding=function(t){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(t){throw new Error("process.chdir is not supported")},n.umask=function(){return 0};
},{}],"chA2":[function(require,module,exports) {
var global = arguments[3];
var process = require("process");
var t=arguments[3],e=require("process");Object.defineProperty(exports,"__esModule",{value:!0}),exports.Sha1=exports.RANDOM_FACTOR=exports.MAX_VALUE_MILLIS=exports.FirebaseError=exports.ErrorFactory=exports.Deferred=exports.DecodeBase64StringError=exports.CONSTANTS=void 0,exports.areCookiesEnabled=V,exports.assertionError=exports.assert=void 0,exports.async=ft,exports.base64urlEncodeWithoutPadding=exports.base64Encode=exports.base64Decode=exports.base64=void 0,exports.calculateBackoffMillis=Ct,exports.contains=Y,exports.createMockUserToken=O,exports.createSubscribe=ht,exports.decode=void 0,exports.deepCopy=l,exports.deepEqual=rt,exports.deepExtend=p,exports.errorPrefix=bt,exports.extractQuerystring=at,exports.getExperimentalSetting=exports.getDefaults=exports.getDefaultEmulatorHostnameAndPort=exports.getDefaultEmulatorHost=exports.getDefaultAppConfig=void 0,exports.getGlobal=b,exports.getModularInstance=Tt,exports.getUA=C,exports.isAdmin=void 0,exports.isBrowser=T,exports.isBrowserExtension=N,exports.isElectron=j,exports.isEmpty=tt,exports.isIE=B,exports.isIndexedDBAvailable=L,exports.isMobileCordova=D,exports.isNode=w,exports.isNodeSdk=I,exports.isReactNative=M,exports.isSafari=P,exports.isUWP=k,exports.issuedAtTime=exports.isValidTimestamp=exports.isValidFormat=void 0,exports.jsonEval=H,exports.map=et,exports.ordinal=Dt,exports.promiseWithTimeout=nt,exports.querystring=st,exports.querystringDecode=it,exports.safeGet=Z,exports.stringToByteArray=exports.stringLength=void 0,exports.stringify=J,exports.validateArgCount=exports.uuidv4=void 0,exports.validateCallback=_t,exports.validateContextObject=gt,exports.validateIndexedDBOpenable=R,exports.validateNamespace=xt;const r=exports.CONSTANTS={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},o=function(t,e){if(!t)throw n(e)};exports.assert=o;const n=function(t){return new Error("Firebase Database ("+r.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)};exports.assertionError=n;const s=function(t){const e=[];let r=0;for(let o=0;o<t.length;o++){let n=t.charCodeAt(o);n<128?e[r++]=n:n<2048?(e[r++]=n>>6|192,e[r++]=63&n|128):55296==(64512&n)&&o+1<t.length&&56320==(64512&t.charCodeAt(o+1))?(n=65536+((1023&n)<<10)+(1023&t.charCodeAt(++o)),e[r++]=n>>18|240,e[r++]=n>>12&63|128,e[r++]=n>>6&63|128,e[r++]=63&n|128):(e[r++]=n>>12|224,e[r++]=n>>6&63|128,e[r++]=63&n|128)}return e},i=function(t){const e=[];let r=0,o=0;for(;r<t.length;){const n=t[r++];if(n<128)e[o++]=String.fromCharCode(n);else if(n>191&&n<224){const s=t[r++];e[o++]=String.fromCharCode((31&n)<<6|63&s)}else if(n>239&&n<365){const s=((7&n)<<18|(63&t[r++])<<12|(63&t[r++])<<6|63&t[r++])-65536;e[o++]=String.fromCharCode(55296+(s>>10)),e[o++]=String.fromCharCode(56320+(1023&s))}else{const s=t[r++],i=t[r++];e[o++]=String.fromCharCode((15&n)<<12|(63&s)<<6|63&i)}}return e.join("")},a=exports.base64={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,o=[];for(let n=0;n<t.length;n+=3){const e=t[n],s=n+1<t.length,i=s?t[n+1]:0,a=n+2<t.length,c=a?t[n+2]:0,h=e>>2,u=(3&e)<<4|i>>4;let f=(15&i)<<2|c>>6,l=63&c;a||(l=64,s||(f=64)),o.push(r[h],r[u],r[f],r[l])}return o.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(s(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):i(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,o=[];for(let n=0;n<t.length;){const e=r[t.charAt(n++)],s=n<t.length?r[t.charAt(n)]:0,i=++n<t.length?r[t.charAt(n)]:64,a=++n<t.length?r[t.charAt(n)]:64;if(++n,null==e||null==s||null==i||null==a)throw new c;const h=e<<2|s>>4;if(o.push(h),64!==i){const t=s<<4&240|i>>2;if(o.push(t),64!==a){const t=i<<6&192|a;o.push(t)}}}return o},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class c extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}exports.DecodeBase64StringError=c;const h=function(t){const e=s(t);return a.encodeByteArray(e,!0)};exports.base64Encode=h;const u=function(t){return h(t).replace(/\./g,"")};exports.base64urlEncodeWithoutPadding=u;const f=function(t){try{return a.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function l(t){return p(void 0,t)}function p(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(const r in e)e.hasOwnProperty(r)&&d(r)&&(t[r]=p(t[r],e[r]));return t}function d(t){return"__proto__"!==t}function b(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==t)return t;throw new Error("Unable to locate global object.")}exports.base64Decode=f;const x=()=>b().__FIREBASE_DEFAULTS__,_=()=>{if(void 0===e||void 0===e.env)return},g=()=>{if("undefined"==typeof document)return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(r){return}const e=t&&f(t[1]);return e&&JSON.parse(e)},y=()=>{try{return x()||_()||g()}catch(t){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`)}};exports.getDefaults=y;const v=t=>{var e,r;return null===(r=null===(e=y())||void 0===e?void 0:e.emulatorHosts)||void 0===r?void 0:r[t]};exports.getDefaultEmulatorHost=v;const E=t=>{const e=v(t);if(!e)return;const r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const o=parseInt(e.substring(r+1),10);return"["===e[0]?[e.substring(1,r-1),o]:[e.substring(0,r),o]};exports.getDefaultEmulatorHostnameAndPort=E;const m=()=>{var t;return null===(t=y())||void 0===t?void 0:t.config};exports.getDefaultAppConfig=m;const A=t=>{var e;return null===(e=y())||void 0===e?void 0:e[`_${t}`]};exports.getExperimentalSetting=A;class S{constructor(){this.reject=(()=>{}),this.resolve=(()=>{}),this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}wrapCallback(t){return(e,r)=>{e?this.reject(e):this.resolve(r),"function"==typeof t&&(this.promise.catch(()=>{}),1===t.length?t(e):t(e,r))}}}function O(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r=e||"demo-project",o=t.iat||0,n=t.sub||t.user_id;if(!n)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:o,exp:o+3600,auth_time:o,sub:n,user_id:n,firebase:{sign_in_provider:"custom",identities:{}}},t);return[u(JSON.stringify({alg:"none",type:"JWT"})),u(JSON.stringify(s)),""].join(".")}function C(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function D(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(C())}function w(){var e;const r=null===(e=y())||void 0===e?void 0:e.forceEnvironment;if("node"===r)return!0;if("browser"===r)return!1;try{return"[object process]"===Object.prototype.toString.call(t.process)}catch(o){return!1}}function T(){return"object"==typeof self&&self.self===self}function N(){const t="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof t&&void 0!==t.id}function M(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function j(){return C().indexOf("Electron/")>=0}function B(){const t=C();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function k(){return C().indexOf("MSAppHost/")>=0}function I(){return!0===r.NODE_CLIENT||!0===r.NODE_ADMIN}function P(){return!w()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function L(){try{return"object"==typeof indexedDB}catch(t){return!1}}function R(){return new Promise((t,e)=>{try{let o=!0;const n="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(n);s.onsuccess=(()=>{s.result.close(),o||self.indexedDB.deleteDatabase(n),t(!0)}),s.onupgradeneeded=(()=>{o=!1}),s.onerror=(()=>{var t;e((null===(t=s.error)||void 0===t?void 0:t.message)||"")})}catch(r){e(r)}})}function V(){return!("undefined"==typeof navigator||!navigator.cookieEnabled)}exports.Deferred=S;const F="FirebaseError";class U extends Error{constructor(t,e,r){super(e),this.code=t,this.customData=r,this.name=F,Object.setPrototypeOf(this,U.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,W.prototype.create)}}exports.FirebaseError=U;class W{constructor(t,e,r){this.service=t,this.serviceName=e,this.errors=r}create(t,...e){const r=e[0]||{},o=`${this.service}/${t}`,n=this.errors[t],s=n?$(n,r):"Error",i=`${this.serviceName}: ${s} (${o}).`;return new U(o,i,r)}}function $(t,e){return t.replace(z,(t,r)=>{const o=e[r];return null!=o?String(o):`<${r}?>`})}exports.ErrorFactory=W;const z=/\{\$([^}]+)}/g;function H(t){return JSON.parse(t)}function J(t){return JSON.stringify(t)}const q=function(t){let e={},r={},o={},n="";try{const i=t.split(".");e=H(f(i[0])||""),r=H(f(i[1])||""),n=i[2],o=r.d||{},delete r.d}catch(s){}return{header:e,claims:r,data:o,signature:n}};exports.decode=q;const G=function(t){const e=q(t).claims,r=Math.floor((new Date).getTime()/1e3);let o=0,n=0;return"object"==typeof e&&(e.hasOwnProperty("nbf")?o=e.nbf:e.hasOwnProperty("iat")&&(o=e.iat),n=e.hasOwnProperty("exp")?e.exp:o+86400),!!r&&!!o&&!!n&&r>=o&&r<=n};exports.isValidTimestamp=G;const K=function(t){const e=q(t).claims;return"object"==typeof e&&e.hasOwnProperty("iat")?e.iat:null};exports.issuedAtTime=K;const X=function(t){const e=q(t).claims;return!!e&&"object"==typeof e&&e.hasOwnProperty("iat")};exports.isValidFormat=X;const Q=function(t){const e=q(t).claims;return"object"==typeof e&&!0===e.admin};function Y(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Z(t,e){return Object.prototype.hasOwnProperty.call(t,e)?t[e]:void 0}function tt(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function et(t,e,r){const o={};for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(o[n]=e.call(r,t[n],n,t));return o}function rt(t,e){if(t===e)return!0;const r=Object.keys(t),o=Object.keys(e);for(const n of r){if(!o.includes(n))return!1;const r=t[n],s=e[n];if(ot(r)&&ot(s)){if(!rt(r,s))return!1}else if(r!==s)return!1}for(const n of o)if(!r.includes(n))return!1;return!0}function ot(t){return null!==t&&"object"==typeof t}function nt(t,e=2e3){const r=new S;return setTimeout(()=>r.reject("timeout!"),e),t.then(r.resolve,r.reject),r.promise}function st(t){const e=[];for(const[r,o]of Object.entries(t))Array.isArray(o)?o.forEach(t=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(t))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(o));return e.length?"&"+e.join("&"):""}function it(t){const e={};return t.replace(/^\?/,"").split("&").forEach(t=>{if(t){const[r,o]=t.split("=");e[decodeURIComponent(r)]=decodeURIComponent(o)}}),e}function at(t){const e=t.indexOf("?");if(!e)return"";const r=t.indexOf("#",e);return t.substring(e,r>0?r:void 0)}exports.isAdmin=Q;class ct{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(t,e){e||(e=0);const r=this.W_;if("string"==typeof t)for(let u=0;u<16;u++)r[u]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(let u=0;u<16;u++)r[u]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(let u=16;u<80;u++){const t=r[u-3]^r[u-8]^r[u-14]^r[u-16];r[u]=4294967295&(t<<1|t>>>31)}let o,n,s=this.chain_[0],i=this.chain_[1],a=this.chain_[2],c=this.chain_[3],h=this.chain_[4];for(let u=0;u<80;u++){u<40?u<20?(o=c^i&(a^c),n=1518500249):(o=i^a^c,n=1859775393):u<60?(o=i&a|c&(i|a),n=2400959708):(o=i^a^c,n=3395469782);const t=(s<<5|s>>>27)+o+h+n+r[u]&4294967295;h=c,c=a,a=4294967295&(i<<30|i>>>2),i=s,s=t}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+i&4294967295,this.chain_[2]=this.chain_[2]+a&4294967295,this.chain_[3]=this.chain_[3]+c&4294967295,this.chain_[4]=this.chain_[4]+h&4294967295}update(t,e){if(null==t)return;void 0===e&&(e=t.length);const r=e-this.blockSize;let o=0;const n=this.buf_;let s=this.inbuf_;for(;o<e;){if(0===s)for(;o<=r;)this.compress_(t,o),o+=this.blockSize;if("string"==typeof t){for(;o<e;)if(n[s]=t.charCodeAt(o),++o,++s===this.blockSize){this.compress_(n),s=0;break}}else for(;o<e;)if(n[s]=t[o],++o,++s===this.blockSize){this.compress_(n),s=0;break}}this.inbuf_=s,this.total_+=e}digest(){const t=[];let e=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let o=this.blockSize-1;o>=56;o--)this.buf_[o]=255&e,e/=256;this.compress_(this.buf_);let r=0;for(let o=0;o<5;o++)for(let e=24;e>=0;e-=8)t[r]=this.chain_[o]>>e&255,++r;return t}}function ht(t,e){const r=new ut(t,e);return r.subscribe.bind(r)}exports.Sha1=ct;class ut{constructor(t,e){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then(()=>{t(this)}).catch(t=>{this.error(t)})}next(t){this.forEachObserver(e=>{e.next(t)})}error(t){this.forEachObserver(e=>{e.error(t)}),this.close(t)}complete(){this.forEachObserver(t=>{t.complete()}),this.close()}subscribe(t,e,r){let o;if(void 0===t&&void 0===e&&void 0===r)throw new Error("Missing Observer.");void 0===(o=lt(t,["next","error","complete"])?t:{next:t,error:e,complete:r}).next&&(o.next=pt),void 0===o.error&&(o.error=pt),void 0===o.complete&&(o.complete=pt);const n=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?o.error(this.finalError):o.complete()}catch(t){}}),this.observers.push(o),n}unsubscribeOne(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let e=0;e<this.observers.length;e++)this.sendOne(e,t)}sendOne(t,e){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[t])try{e(this.observers[t])}catch(r){"undefined"!=typeof console&&console.error&&console.error(r)}})}close(t){this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function ft(t,e){return(...r)=>{Promise.resolve(!0).then(()=>{t(...r)}).catch(t=>{e&&e(t)})}}function lt(t,e){if("object"!=typeof t||null===t)return!1;for(const r of e)if(r in t&&"function"==typeof t[r])return!0;return!1}function pt(){}const dt=function(t,e,r,o){let n;if(o<e?n="at least "+e:o>r&&(n=0===r?"none":"no more than "+r),n){throw new Error(t+" failed: Was called with "+o+(1===o?" argument.":" arguments.")+" Expects "+n+".")}};function bt(t,e){return`${t} failed: ${e} argument `}function xt(t,e,r){if((!r||e)&&"string"!=typeof e)throw new Error(bt(t,"namespace")+"must be a valid firebase namespace.")}function _t(t,e,r,o){if((!o||r)&&"function"!=typeof r)throw new Error(bt(t,e)+"must be a valid function.")}function gt(t,e,r,o){if((!o||r)&&("object"!=typeof r||null===r))throw new Error(bt(t,e)+"must be a valid context object.")}exports.validateArgCount=dt;const yt=function(t){const e=[];let r=0;for(let n=0;n<t.length;n++){let s=t.charCodeAt(n);if(s>=55296&&s<=56319){const e=s-55296;o(++n<t.length,"Surrogate pair missing trail surrogate."),s=65536+(e<<10)+(t.charCodeAt(n)-56320)}s<128?e[r++]=s:s<2048?(e[r++]=s>>6|192,e[r++]=63&s|128):s<65536?(e[r++]=s>>12|224,e[r++]=s>>6&63|128,e[r++]=63&s|128):(e[r++]=s>>18|240,e[r++]=s>>12&63|128,e[r++]=s>>6&63|128,e[r++]=63&s|128)}return e};exports.stringToByteArray=yt;const vt=function(t){let e=0;for(let r=0;r<t.length;r++){const o=t.charCodeAt(r);o<128?e++:o<2048?e+=2:o>=55296&&o<=56319?(e+=4,r++):e+=3}return e};exports.stringLength=vt;const Et=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)})};exports.uuidv4=Et;const mt=1e3,At=2,St=exports.MAX_VALUE_MILLIS=144e5,Ot=exports.RANDOM_FACTOR=.5;function Ct(t,e=mt,r=At){const o=e*Math.pow(r,t),n=Math.round(Ot*o*(Math.random()-.5)*2);return Math.min(St,o+n)}function Dt(t){return Number.isFinite(t)?t+wt(t):`${t}`}function wt(t){const e=(t=Math.abs(t))%100;if(e>=10&&e<=20)return"th";const r=t%10;return 1===r?"st":2===r?"nd":3===r?"rd":"th"}function Tt(t){return t&&t._delegate?t._delegate:t}
},{"process":"pBGv"}],"vhY9":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Provider=exports.ComponentContainer=exports.Component=void 0;var t=require("@firebase/util");class e{constructor(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}exports.Component=e;const n="[DEFAULT]";class i{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const e=new t.Deferred;if(this.instancesDeferred.set(n,e),this.isInitialized(n)||this.shouldAutoInitialize())try{const t=this.getOrInitializeService({instanceIdentifier:n});t&&e.resolve(t)}catch(i){}}return this.instancesDeferred.get(n).promise}getImmediate(t){var e;const n=this.normalizeInstanceIdentifier(null==t?void 0:t.identifier),i=null!==(e=null==t?void 0:t.optional)&&void 0!==e&&e;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(i)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(i)return null;throw s}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,this.shouldAutoInitialize()){if(r(t))try{this.getOrInitializeService({instanceIdentifier:n})}catch(e){}for(const[t,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const t=this.getOrInitializeService({instanceIdentifier:i});n.resolve(t)}catch(e){}}}}clearInstance(t=n){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...t.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return null!=this.component}isInitialized(t=n){return this.instances.has(t)}getOptions(t=n){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,n=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:e});for(const[s,r]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(s)&&r.resolve(i)}return i}onInit(t,e){var n;const i=this.normalizeInstanceIdentifier(e),s=null!==(n=this.onInitCallbacks.get(i))&&void 0!==n?n:new Set;s.add(t),this.onInitCallbacks.set(i,s);const r=this.instances.get(i);return r&&t(r,i),()=>{s.delete(t)}}invokeOnInitCallbacks(t,e){const n=this.onInitCallbacks.get(e);if(n)for(const s of n)try{s(t,e)}catch(i){}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let n=this.instances.get(t);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:s(t),options:e}),this.instances.set(t,n),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(n,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,n)}catch(i){}return n||null}normalizeInstanceIdentifier(t=n){return this.component?this.component.multipleInstances?t:n:t}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}function s(t){return t===n?void 0:t}function r(t){return"EAGER"===t.instantiationMode}exports.Provider=i;class o{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new i(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}exports.ComponentContainer=o;
},{"@firebase/util":"chA2"}],"JJem":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Logger=exports.LogLevel=void 0,exports.setLogLevel=i,exports.setUserLogHandler=g;const e=[];var r;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(r||(exports.LogLevel=r={}));const t={debug:r.DEBUG,verbose:r.VERBOSE,info:r.INFO,warn:r.WARN,error:r.ERROR,silent:r.SILENT},o=r.INFO,l={[r.DEBUG]:"log",[r.VERBOSE]:"log",[r.INFO]:"info",[r.WARN]:"warn",[r.ERROR]:"error"},s=(e,r,...t)=>{if(r<e.logLevel)return;const o=(new Date).toISOString(),s=l[r];if(!s)throw new Error(`Attempted to log a message with an invalid logType (value: ${r})`);console[s](`[${o}]  ${e.name}:`,...t)};class n{constructor(r){this.name=r,this._logLevel=o,this._logHandler=s,this._userLogHandler=null,e.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in r))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?t[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,r.DEBUG,...e),this._logHandler(this,r.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,r.VERBOSE,...e),this._logHandler(this,r.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,r.INFO,...e),this._logHandler(this,r.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,r.WARN,...e),this._logHandler(this,r.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,r.ERROR,...e),this._logHandler(this,r.ERROR,...e)}}function i(r){e.forEach(e=>{e.setLogLevel(r)})}function g(o,l){for(const s of e){let e=null;l&&l.level&&(e=t[l.level]),s.userLogHandler=null===o?null:(t,l,...s)=>{const n=s.map(e=>{if(null==e)return null;if("string"==typeof e)return e;if("number"==typeof e||"boolean"==typeof e)return e.toString();if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch(r){return null}}).filter(e=>e).join(" ");l>=(null!=e?e:t.logLevel)&&o({level:r[l].toLowerCase(),message:n,args:s,type:t.name})}}}exports.Logger=n;
},{}],"F1qz":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.i=exports.a=void 0,exports.r=v,exports.u=void 0,exports.w=I;const e=(e,t)=>t.some(t=>e instanceof t);let t,r;function n(){return t||(t=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function o(){return r||(r=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}exports.i=e;const s=new WeakMap,i=new WeakMap,a=new WeakMap,c=new WeakMap,u=exports.a=new WeakMap;function p(e){const t=new Promise((t,r)=>{const n=()=>{e.removeEventListener("success",o),e.removeEventListener("error",s)},o=()=>{t(I(e.result)),n()},s=()=>{r(e.error),n()};e.addEventListener("success",o),e.addEventListener("error",s)});return t.then(t=>{t instanceof IDBCursor&&s.set(t,e)}).catch(()=>{}),u.set(t,e),t}function f(e){if(i.has(e))return;const t=new Promise((t,r)=>{const n=()=>{e.removeEventListener("complete",o),e.removeEventListener("error",s),e.removeEventListener("abort",s)},o=()=>{t(),n()},s=()=>{r(e.error||new DOMException("AbortError","AbortError")),n()};e.addEventListener("complete",o),e.addEventListener("error",s),e.addEventListener("abort",s)});i.set(e,t)}let d={get(e,t,r){if(e instanceof IDBTransaction){if("done"===t)return i.get(e);if("objectStoreNames"===t)return e.objectStoreNames||a.get(e);if("store"===t)return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return I(e[t])},set:(e,t,r)=>(e[t]=r,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function v(e){d=e(d)}function D(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?o().includes(e)?function(...t){return e.apply(B(this),t),I(s.get(this))}:function(...t){return I(e.apply(B(this),t))}:function(t,...r){const n=e.call(B(this),t,...r);return a.set(n,t.sort?t.sort():[t]),I(n)}}function m(t){return"function"==typeof t?D(t):(t instanceof IDBTransaction&&f(t),e(t,n())?new Proxy(t,d):t)}function I(e){if(e instanceof IDBRequest)return p(e);if(c.has(e))return c.get(e);const t=m(e);return t!==e&&(c.set(e,t),u.set(t,e)),t}const B=e=>u.get(e);exports.u=B;
},{}],"JZvK":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.deleteDB=n,exports.openDB=t,Object.defineProperty(exports,"unwrap",{enumerable:!0,get:function(){return e.u}}),Object.defineProperty(exports,"wrap",{enumerable:!0,get:function(){return e.w}});var e=require("./wrap-idb-value.js");function t(t,n,{blocked:r,upgrade:o,blocking:i,terminated:s}={}){const d=indexedDB.open(t,n),a=(0,e.w)(d);return o&&d.addEventListener("upgradeneeded",t=>{o((0,e.w)(d.result),t.oldVersion,t.newVersion,(0,e.w)(d.transaction),t)}),r&&d.addEventListener("blocked",e=>r(e.oldVersion,e.newVersion,e)),a.then(e=>{s&&e.addEventListener("close",()=>s()),i&&e.addEventListener("versionchange",e=>i(e.oldVersion,e.newVersion,e))}).catch(()=>{}),a}function n(t,{blocked:n}={}){const r=indexedDB.deleteDatabase(t);return n&&r.addEventListener("blocked",e=>n(e.oldVersion,e)),(0,e.w)(r).then(()=>void 0)}const r=["get","getKey","getAll","getAllKeys","count"],o=["put","add","delete","clear"],i=new Map;function s(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(i.get(t))return i.get(t);const n=t.replace(/FromIndex$/,""),s=t!==n,d=o.includes(n);if(!(n in(s?IDBIndex:IDBObjectStore).prototype)||!d&&!r.includes(n))return;const a=async function(e,...t){const r=this.transaction(e,d?"readwrite":"readonly");let o=r.store;return s&&(o=o.index(t.shift())),(await Promise.all([o[n](...t),d&&r.done]))[0]};return i.set(t,a),a}(0,e.r)(e=>({...e,get:(t,n,r)=>s(t,n)||e.get(t,n,r),has:(t,n)=>!!s(t,n)||e.has(t,n)}));
},{"./wrap-idb-value.js":"F1qz"}],"h2Mb":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"FirebaseError",{enumerable:!0,get:function(){return a.FirebaseError}}),exports._DEFAULT_ENTRY_NAME=exports.SDK_VERSION=void 0,exports._addComponent=L,exports._addOrOverwriteComponent=M,exports._apps=void 0,exports._clearComponents=V,exports._components=void 0,exports._getProvider=U,exports._registerComponent=T,exports._removeServiceInstance=R,exports.deleteApp=Q,exports.getApp=Y,exports.getApps=G,exports.initializeApp=W,exports.onLog=Z,exports.registerVersion=X,exports.setLogLevel=ee;var e=require("@firebase/component"),t=require("@firebase/logger"),a=require("@firebase/util"),r=require("idb");class n{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(i(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null}).filter(e=>e).join(" ")}}function i(e){const t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}const s="@firebase/app",o="0.9.27",c=new t.Logger("@firebase/app"),p="@firebase/app-compat",h="@firebase/analytics-compat",l="@firebase/analytics",d="@firebase/app-check-compat",f="@firebase/app-check",b="@firebase/auth",u="@firebase/auth-compat",g="@firebase/database",m="@firebase/database-compat",w="@firebase/functions",_="@firebase/functions-compat",v="@firebase/installations",C="@firebase/installations-compat",D="@firebase/messaging",E="@firebase/messaging-compat",y="@firebase/performance",x="@firebase/performance-compat",I="@firebase/remote-config",S="@firebase/remote-config-compat",P="@firebase/storage",O="@firebase/storage-compat",A="@firebase/firestore",$="@firebase/firestore-compat",N="firebase",j="10.8.0",k=exports._DEFAULT_ENTRY_NAME="[DEFAULT]",F={[s]:"fire-core",[p]:"fire-core-compat",[l]:"fire-analytics",[h]:"fire-analytics-compat",[f]:"fire-app-check",[d]:"fire-app-check-compat",[b]:"fire-auth",[u]:"fire-auth-compat",[g]:"fire-rtdb",[m]:"fire-rtdb-compat",[w]:"fire-fn",[_]:"fire-fn-compat",[v]:"fire-iid",[C]:"fire-iid-compat",[D]:"fire-fcm",[E]:"fire-fcm-compat",[y]:"fire-perf",[x]:"fire-perf-compat",[I]:"fire-rc",[S]:"fire-rc-compat",[P]:"fire-gcs",[O]:"fire-gcs-compat",[A]:"fire-fst",[$]:"fire-fst-compat","fire-js":"fire-js",[N]:"fire-js-all"},B=exports._apps=new Map,H=exports._components=new Map;function L(e,t){try{e.container.addComponent(t)}catch(a){c.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,a)}}function M(e,t){e.container.addOrOverwriteComponent(t)}function T(e){const t=e.name;if(H.has(t))return c.debug(`There were multiple attempts to register component ${t}.`),!1;H.set(t,e);for(const a of B.values())L(a,e);return!0}function U(e,t){const a=e.container.getProvider("heartbeat").getImmediate({optional:!0});return a&&a.triggerHeartbeat(),e.container.getProvider(t)}function R(e,t,a=k){U(e,t).clearInstance(a)}function V(){H.clear()}const q={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."},z=new a.ErrorFactory("app","Firebase",q);class J{constructor(t,a,r){this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},a),this._name=a.name,this._automaticDataCollectionEnabled=a.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new e.Component("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw z.create("app-deleted",{appName:this._name})}}const K=exports.SDK_VERSION=j;function W(t,r={}){let n=t;if("object"!=typeof r){r={name:r}}const i=Object.assign({name:k,automaticDataCollectionEnabled:!1},r),s=i.name;if("string"!=typeof s||!s)throw z.create("bad-app-name",{appName:String(s)});if(n||(n=(0,a.getDefaultAppConfig)()),!n)throw z.create("no-options");const o=B.get(s);if(o){if((0,a.deepEqual)(n,o.options)&&(0,a.deepEqual)(i,o.config))return o;throw z.create("duplicate-app",{appName:s})}const c=new e.ComponentContainer(s);for(const e of H.values())c.addComponent(e);const p=new J(n,i,c);return B.set(s,p),p}function Y(e=k){const t=B.get(e);if(!t&&e===k&&(0,a.getDefaultAppConfig)())return W();if(!t)throw z.create("no-app",{appName:e});return t}function G(){return Array.from(B.values())}async function Q(e){const t=e.name;B.has(t)&&(B.delete(t),await Promise.all(e.container.getProviders().map(e=>e.delete())),e.isDeleted=!0)}function X(t,a,r){var n;let i=null!==(n=F[t])&&void 0!==n?n:t;r&&(i+=`-${r}`);const s=i.match(/\s|\//),o=a.match(/\s|\//);if(s||o){const e=[`Unable to register library "${i}" with version "${a}":`];return s&&e.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&e.push("and"),o&&e.push(`version name "${a}" contains illegal characters (whitespace or "/")`),void c.warn(e.join(" "))}T(new e.Component(`${i}-version`,()=>({library:i,version:a}),"VERSION"))}function Z(e,a){if(null!==e&&"function"!=typeof e)throw z.create("invalid-log-argument");(0,t.setUserLogHandler)(e,a)}function ee(e){(0,t.setLogLevel)(e)}const te="firebase-heartbeat-database",ae=1,re="firebase-heartbeat-store";let ne=null;function ie(){return ne||(ne=(0,r.openDB)(te,ae,{upgrade:(e,t)=>{switch(t){case 0:try{e.createObjectStore(re)}catch(a){console.warn(a)}}}}).catch(e=>{throw z.create("idb-open",{originalErrorMessage:e.message})})),ne}async function se(e){try{const r=(await ie()).transaction(re),n=await r.objectStore(re).get(ce(e));return await r.done,n}catch(t){if(t instanceof a.FirebaseError)c.warn(t.message);else{const e=z.create("idb-get",{originalErrorMessage:null==t?void 0:t.message});c.warn(e.message)}}}async function oe(e,t){try{const n=(await ie()).transaction(re,"readwrite"),i=n.objectStore(re);await i.put(t,ce(e)),await n.done}catch(r){if(r instanceof a.FirebaseError)c.warn(r.message);else{const e=z.create("idb-set",{originalErrorMessage:null==r?void 0:r.message});c.warn(e.message)}}}function ce(e){return`${e.name}!${e.options.appId}`}const pe=1024,he=2592e6;class le{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new be(t),this._heartbeatsCachePromise=this._storage.read().then(e=>(this._heartbeatsCache=e,e))}async triggerHeartbeat(){var e,t;const a=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=de();if((null!=(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||(this._heartbeatsCache=await this._heartbeatsCachePromise,null!=(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)))&&this._heartbeatsCache.lastSentHeartbeatDate!==r&&!this._heartbeatsCache.heartbeats.some(e=>e.date===r))return this._heartbeatsCache.heartbeats.push({date:r,agent:a}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(e=>{const t=new Date(e.date).valueOf();return Date.now()-t<=he}),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){var e;if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=de(),{heartbeatsToSend:r,unsentEntries:n}=fe(this._heartbeatsCache.heartbeats),i=(0,a.base64urlEncodeWithoutPadding)(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}}function de(){return(new Date).toISOString().substring(0,10)}function fe(e,t=pe){const a=[];let r=e.slice();for(const n of e){const e=a.find(e=>e.agent===n.agent);if(e){if(e.dates.push(n.date),ue(a)>t){e.dates.pop();break}}else if(a.push({agent:n.agent,dates:[n.date]}),ue(a)>t){a.pop();break}r=r.slice(1)}return{heartbeatsToSend:a,unsentEntries:r}}class be{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!(0,a.isIndexedDBAvailable)()&&(0,a.validateIndexedDBOpenable)().then(()=>!0).catch(()=>!1)}async read(){if(await this._canUseIndexedDBPromise){const e=await se(this.app);return(null==e?void 0:e.heartbeats)?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const a=await this.read();return oe(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:a.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const a=await this.read();return oe(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:a.lastSentHeartbeatDate,heartbeats:[...a.heartbeats,...e.heartbeats]})}}}function ue(e){return(0,a.base64urlEncodeWithoutPadding)(JSON.stringify({version:2,heartbeats:e})).length}function ge(t){T(new e.Component("platform-logger",e=>new n(e),"PRIVATE")),T(new e.Component("heartbeat",e=>new le(e),"PRIVATE")),X(s,o,t),X(s,o,"esm2017"),X("fire-js","")}ge("");
},{"@firebase/component":"vhY9","@firebase/logger":"JJem","@firebase/util":"chA2","idb":"JZvK"}],"QtzL":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@firebase/app");Object.keys(e).forEach(function(r){"default"!==r&&"__esModule"!==r&&(r in exports&&exports[r]===e[r]||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return e[r]}}))});var r="firebase",t="10.8.0";(0,e.registerVersion)(r,t,"app");
},{"@firebase/app":"h2Mb"}],"fIlu":[function(require,module,exports) {
var global = arguments[3];
var t=arguments[3];Object.defineProperty(exports,"__esModule",{value:!0}),exports.getStatEventTarget=exports.default=exports.createWebChannelTransport=exports.XhrIo=exports.WebChannel=exports.Stat=exports.Md5=exports.Integer=exports.FetchXmlHttpFactory=exports.EventType=exports.Event=exports.ErrorCode=void 0;var e,i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{},n=exports.default={},r=r||{},s=i||self;function o(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function h(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}function a(t){return Object.prototype.hasOwnProperty.call(t,l)&&t[l]||(t[l]=++u)}var l="closure_uid_"+(1e9*Math.random()>>>0),u=0;function c(t,e,i){return t.call.apply(t.bind,arguments)}function f(t,e,i){if(!t)throw Error();if(2<arguments.length){var n=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,n),t.apply(e,i)}}return function(){return t.apply(e,arguments)}}function g(t,e,i){return(g=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?c:f).apply(null,arguments)}function p(t,e){var i=Array.prototype.slice.call(arguments,1);return function(){var e=i.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function d(t,e){function i(){}i.prototype=e.prototype,t.$=e.prototype,t.prototype=new i,t.prototype.constructor=t,t.ac=function(t,i,n){for(var r=Array(arguments.length-2),s=2;s<arguments.length;s++)r[s-2]=arguments[s];return e.prototype[i].apply(t,r)}}function y(){this.s=this.s,this.o=this.o}var v=0;y.prototype.s=!1,y.prototype.sa=function(){this.s||(this.s=!0,this.N(),0==v)||a(this)},y.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const m=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(let i=0;i<t.length;i++)if(i in t&&t[i]===e)return i;return-1};function b(t){const e=t.length;if(0<e){const i=Array(e);for(let n=0;n<e;n++)i[n]=t[n];return i}return[]}function w(t,e){for(let i=1;i<arguments.length;i++){const e=arguments[i];if(o(e)){const i=t.length||0,n=e.length||0;t.length=i+n;for(let r=0;r<n;r++)t[i+r]=e[r]}else t.push(e)}}function T(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}T.prototype.h=function(){this.defaultPrevented=!0};var S=function(){if(!s.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{const t=()=>{};s.addEventListener("test",t,e),s.removeEventListener("test",t,e)}catch(i){}return t}();function E(t){return/^[\s\xa0]*$/.test(t)}function x(){var t=s.navigator;return t&&(t=t.userAgent)?t:""}function j(t){return-1!=x().indexOf(t)}function C(t){return C[" "](t),t}function A(t,e){var i=pn;return Object.prototype.hasOwnProperty.call(i,t)?i[t]:i[t]=e(t)}C[" "]=function(){};var I,M,R=j("Opera"),O=j("Trident")||j("MSIE"),P=j("Edge"),k=P||O,_=j("Gecko")&&!(-1!=x().toLowerCase().indexOf("webkit")&&!j("Edge"))&&!(j("Trident")||j("MSIE"))&&!j("Edge"),D=-1!=x().toLowerCase().indexOf("webkit")&&!j("Edge");function L(){var t=s.document;return t?t.documentMode:void 0}t:{var H="",X=function(){var t=x();return _?/rv:([^\);]+)(\)|;)/.exec(t):P?/Edge\/([\d\.]+)/.exec(t):O?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t):D?/WebKit\/(\S+)/.exec(t):R?/(?:Version)[ \/]?(\S+)/.exec(t):void 0}();if(X&&(H=X?X[1]:""),O){var N=L();if(null!=N&&N>parseFloat(H)){I=String(N);break t}}I=H}if(s.document&&O){var F=L();M=F||(parseInt(I,10)||void 0)}else M=void 0;var B=M;function U(t,e){if(T.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var i=this.type=t.type,n=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(_){t:{try{C(e.nodeName);var r=!0;break t}catch(s){}r=!1}r||(e=null)}}else"mouseover"==i?e=t.fromElement:"mouseout"==i&&(e=t.toElement);this.relatedTarget=e,n?(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:K[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&U.$.h.call(this)}}d(U,T);var K={2:"touch",3:"pen",4:"mouse"};U.prototype.h=function(){U.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var Y="closure_listenable_"+(1e6*Math.random()|0),G=0;function J(t,e,i,n,r){this.listener=t,this.proxy=null,this.src=e,this.type=i,this.capture=!!n,this.la=r,this.key=++G,this.fa=this.ia=!1}function W(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function z(t,e,i){for(const n in t)e.call(i,t[n],n,t)}function q(t,e){for(const i in t)e.call(void 0,t[i],i,t)}function V(t){const e={};for(const i in t)e[i]=t[i];return e}const $="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Z(t,e){let i,n;for(let r=1;r<arguments.length;r++){for(i in n=arguments[r])t[i]=n[i];for(let e=0;e<$.length;e++)i=$[e],Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}}function Q(t){this.src=t,this.g={},this.h=0}function tt(t,e){var i=e.type;if(i in t.g){var n,r=t.g[i],s=m(r,e);(n=0<=s)&&Array.prototype.splice.call(r,s,1),n&&(W(e),0==t.g[i].length&&(delete t.g[i],t.h--))}}function et(t,e,i,n){for(var r=0;r<t.length;++r){var s=t[r];if(!s.fa&&s.listener==e&&s.capture==!!i&&s.la==n)return r}return-1}Q.prototype.add=function(t,e,i,n,r){var s=t.toString();(t=this.g[s])||(t=this.g[s]=[],this.h++);var o=et(t,e,n,r);return-1<o?(e=t[o],i||(e.ia=!1)):((e=new J(e,this.src,s,!!n,r)).ia=i,t.push(e)),e};var it="closure_lm_"+(1e6*Math.random()|0),nt={};function rt(t,e,i,n,r){if(n&&n.once)return ht(t,e,i,n,r);if(Array.isArray(e)){for(var s=0;s<e.length;s++)rt(t,e[s],i,n,r);return null}return i=pt(i),t&&t[Y]?t.O(e,i,h(n)?!!n.capture:!!n,r):st(t,e,i,!1,n,r)}function st(t,e,i,n,r,s){if(!e)throw Error("Invalid event type");var o=h(r)?!!r.capture:!!r,a=ft(t);if(a||(t[it]=a=new Q(t)),(i=a.add(e,i,n,o,s)).proxy)return i;if(n=ot(),i.proxy=n,n.src=t,n.listener=i,t.addEventListener)S||(r=o),void 0===r&&(r=!1),t.addEventListener(e.toString(),n,r);else if(t.attachEvent)t.attachEvent(ut(e.toString()),n);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(n)}return i}function ot(){const t=ct;return function e(i){return t.call(e.src,e.listener,i)}}function ht(t,e,i,n,r){if(Array.isArray(e)){for(var s=0;s<e.length;s++)ht(t,e[s],i,n,r);return null}return i=pt(i),t&&t[Y]?t.P(e,i,h(n)?!!n.capture:!!n,r):st(t,e,i,!0,n,r)}function at(t,e,i,n,r){if(Array.isArray(e))for(var s=0;s<e.length;s++)at(t,e[s],i,n,r);else n=h(n)?!!n.capture:!!n,i=pt(i),t&&t[Y]?(t=t.i,(e=String(e).toString())in t.g&&(-1<(i=et(s=t.g[e],i,n,r))&&(W(s[i]),Array.prototype.splice.call(s,i,1),0==s.length&&(delete t.g[e],t.h--)))):t&&(t=ft(t))&&(e=t.g[e.toString()],t=-1,e&&(t=et(e,i,n,r)),(i=-1<t?e[t]:null)&&lt(i))}function lt(t){if("number"!=typeof t&&t&&!t.fa){var e=t.src;if(e&&e[Y])tt(e.i,t);else{var i=t.type,n=t.proxy;e.removeEventListener?e.removeEventListener(i,n,t.capture):e.detachEvent?e.detachEvent(ut(i),n):e.addListener&&e.removeListener&&e.removeListener(n),(i=ft(e))?(tt(i,t),0==i.h&&(i.src=null,e[it]=null)):W(t)}}}function ut(t){return t in nt?nt[t]:nt[t]="on"+t}function ct(t,e){if(t.fa)t=!0;else{e=new U(e,this);var i=t.listener,n=t.la||t.src;t.ia&&lt(t),t=i.call(n,e)}return t}function ft(t){return(t=t[it])instanceof Q?t:null}var gt="__closure_events_fn_"+(1e9*Math.random()>>>0);function pt(t){return"function"==typeof t?t:(t[gt]||(t[gt]=function(e){return t.handleEvent(e)}),t[gt])}function dt(){y.call(this),this.i=new Q(this),this.S=this,this.J=null}function yt(t,e){var i,n=t.J;if(n)for(i=[];n;n=n.J)i.push(n);if(t=t.S,n=e.type||e,"string"==typeof e)e=new T(e,t);else if(e instanceof T)e.target=e.target||t;else{var r=e;Z(e=new T(n,t),r)}if(r=!0,i)for(var s=i.length-1;0<=s;s--){var o=e.g=i[s];r=vt(o,n,!0,e)&&r}if(r=vt(o=e.g=t,n,!0,e)&&r,r=vt(o,n,!1,e)&&r,i)for(s=0;s<i.length;s++)r=vt(o=e.g=i[s],n,!1,e)&&r}function vt(t,e,i,n){if(!(e=t.i.g[String(e)]))return!0;e=e.concat();for(var r=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.fa&&o.capture==i){var h=o.listener,a=o.la||o.src;o.ia&&tt(t.i,o),r=!1!==h.call(a,n)&&r}}return r&&!n.defaultPrevented}d(dt,y),dt.prototype[Y]=!0,dt.prototype.removeEventListener=function(t,e,i,n){at(this,t,e,i,n)},dt.prototype.N=function(){if(dt.$.N.call(this),this.i){var t,e=this.i;for(t in e.g){for(var i=e.g[t],n=0;n<i.length;n++)W(i[n]);delete e.g[t],e.h--}}this.J=null},dt.prototype.O=function(t,e,i,n){return this.i.add(String(t),e,!1,i,n)},dt.prototype.P=function(t,e,i,n){return this.i.add(String(t),e,!0,i,n)};var mt=s.JSON.stringify;class bt{constructor(t,e){this.i=t,this.j=e,this.h=0,this.g=null}get(){let t;return 0<this.h?(this.h--,t=this.g,this.g=t.next,t.next=null):t=this.i(),t}}function wt(){var t=It;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}class Tt{constructor(){this.h=this.g=null}add(t,e){const i=St.get();i.set(t,e),this.h?this.h.next=i:this.g=i,this.h=i}}var St=new bt(()=>new Et,t=>t.reset());class Et{constructor(){this.next=this.g=this.h=null}set(t,e){this.h=t,this.g=e,this.next=null}reset(){this.next=this.g=this.h=null}}function xt(t){var e=1;t=t.split(":");const i=[];for(;0<e&&t.length;)i.push(t.shift()),e--;return t.length&&i.push(t.join(":")),i}function jt(t){s.setTimeout(()=>{throw t},0)}let Ct,At=!1,It=new Tt,Mt=()=>{const t=s.Promise.resolve(void 0);Ct=(()=>{t.then(Rt)})};var Rt=()=>{for(var t;t=wt();){try{t.h.call(t.g)}catch(i){jt(i)}var e=St;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}At=!1};function Ot(t,e){dt.call(this),this.h=t||1,this.g=e||s,this.j=g(this.qb,this),this.l=Date.now()}function Pt(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}function kt(t,e,i){if("function"==typeof t)i&&(t=g(t,i));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=g(t.handleEvent,t)}return 2147483647<Number(e)?-1:s.setTimeout(t,e||0)}function _t(t){t.g=kt(()=>{t.g=null,t.i&&(t.i=!1,_t(t))},t.j);const e=t.h;t.h=null,t.m.apply(null,e)}d(Ot,dt),(e=Ot.prototype).ga=!1,e.T=null,e.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),yt(this,"tick"),this.ga&&(Pt(this),this.start()))}},e.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},e.N=function(){Ot.$.N.call(this),Pt(this),delete this.g};class Dt extends y{constructor(t,e){super(),this.m=t,this.j=e,this.h=null,this.i=!1,this.g=null}l(t){this.h=arguments,this.g?this.i=!0:_t(this)}N(){super.N(),this.g&&(s.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Lt(t){y.call(this),this.h=t,this.g={}}d(Lt,y);var Ht=[];function Xt(t,e,i,n){Array.isArray(i)||(i&&(Ht[0]=i.toString()),i=Ht);for(var r=0;r<i.length;r++){var s=rt(e,i[r],n||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}}function Nt(t){z(t.g,function(t,e){this.g.hasOwnProperty(e)&&lt(t)},t),t.g={}}function Ft(){this.g=!0}function Bt(t,e,i,n,r,s){t.info(function(){if(t.g)if(s)for(var o="",h=s.split("&"),a=0;a<h.length;a++){var l=h[a].split("=");if(1<l.length){var u=l[0];l=l[1];var c=u.split("_");o=2<=c.length&&"type"==c[1]?o+(u+"=")+l+"&":o+(u+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+n+") [attempt "+r+"]: "+e+"\n"+i+"\n"+o})}function Ut(t,e,i,n,r,s,o){t.info(function(){return"XMLHTTP RESP ("+n+") [ attempt "+r+"]: "+e+"\n"+i+"\n"+s+" "+o})}function Kt(t,e,i,n){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+Gt(t,i)+(n?" "+n:"")})}function Yt(t,e){t.info(function(){return"TIMEOUT: "+e})}function Gt(t,e){if(!t.g)return e;if(!e)return null;try{var i=JSON.parse(e);if(i)for(t=0;t<i.length;t++)if(Array.isArray(i[t])){var n=i[t];if(!(2>n.length)){var r=n[1];if(Array.isArray(r)&&!(1>r.length)){var s=r[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<r.length;o++)r[o]=""}}}return mt(i)}catch(h){return e}}Lt.prototype.N=function(){Lt.$.N.call(this),Nt(this)},Lt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Ft.prototype.Ea=function(){this.g=!1},Ft.prototype.info=function(){};var Jt={},Wt=null;function zt(){return Wt=Wt||new dt}function qt(t){T.call(this,Jt.Ta,t)}function Vt(t){const e=zt();yt(e,new qt(e))}function $t(t,e){T.call(this,Jt.STAT_EVENT,t),this.stat=e}function Zt(t){const e=zt();yt(e,new $t(e,t))}function Qt(t,e){T.call(this,Jt.Ua,t),this.size=e}function te(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return s.setTimeout(function(){t()},e)}Jt.Ta="serverreachability",d(qt,T),Jt.STAT_EVENT="statevent",d($t,T),Jt.Ua="timingevent",d(Qt,T);var ee={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},ie={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function ne(){}function re(t){return t.h||(t.h=t.i())}function se(){}ne.prototype.h=null;var oe,he={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function ae(){T.call(this,"d")}function le(){T.call(this,"c")}function ue(){}function ce(t,e,i,n){this.l=t,this.j=e,this.m=i,this.W=n||1,this.U=new Lt(this),this.P=ge,t=k?125:void 0,this.V=new Ot(t),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new fe}function fe(){this.i=null,this.g="",this.h=!1}d(ae,T),d(le,T),d(ue,ne),ue.prototype.g=function(){return new XMLHttpRequest},ue.prototype.i=function(){return{}},oe=new ue;var ge=45e3,pe={},de={};function ye(t,e,i){t.L=1,t.A=Xe(ke(e)),t.u=i,t.S=!0,ve(t,null)}function ve(t,e){t.G=Date.now(),Te(t),t.B=ke(t.A);var i=t.B,n=t.W;Array.isArray(n)||(n=[String(n)]),$e(i.i,"t",n),t.o=0,i=t.l.J,t.h=new fe,t.g=nn(t.l,i?e:null,!t.u),0<t.O&&(t.M=new Dt(g(t.Pa,t,t.g),t.O)),Xt(t.U,t.g,"readystatechange",t.nb),e=t.I?V(t.I):{},t.u?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.B,t.v,t.u,e)):(t.v="GET",t.g.ha(t.B,t.v,null,e)),Vt(),Bt(t.j,t.v,t.B,t.m,t.W,t.u)}function me(t){return!!t.g&&("GET"==t.v&&2!=t.L&&t.l.Ha)}function be(t,e,i){let n,r=!0;for(;!t.J&&t.o<i.length;){if((n=we(t,i))==de){4==e&&(t.s=4,Zt(14),r=!1),Kt(t.j,t.m,null,"[Incomplete Response]");break}if(n==pe){t.s=4,Zt(15),Kt(t.j,t.m,i,"[Invalid Chunk]"),r=!1;break}Kt(t.j,t.m,n,null),Ce(t,n)}me(t)&&0!=t.o&&(t.h.g=t.h.g.slice(t.o),t.o=0),4!=e||0!=i.length||t.h.h||(t.s=1,Zt(16),r=!1),t.i=t.i&&r,r?0<i.length&&!t.ba&&(t.ba=!0,(e=t.l).g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+i.length),zi(e),e.M=!0,Zt(11))):(Kt(t.j,t.m,i,"[Invalid Chunked Response]"),je(t),xe(t))}function we(t,e){var i=t.o,n=e.indexOf("\n",i);return-1==n?de:(i=Number(e.substring(i,n)),isNaN(i)?pe:(n+=1)+i>e.length?de:(e=e.slice(n,n+i),t.o=n+i,e))}function Te(t){t.Y=Date.now()+t.P,Se(t,t.P)}function Se(t,e){if(null!=t.C)throw Error("WatchDog timer not null");t.C=te(g(t.lb,t),e)}function Ee(t){t.C&&(s.clearTimeout(t.C),t.C=null)}function xe(t){0==t.l.H||t.J||$i(t.l,t)}function je(t){Ee(t);var e=t.M;e&&"function"==typeof e.sa&&e.sa(),t.M=null,Pt(t.V),Nt(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function Ce(t,e){try{var i=t.l;if(0!=i.H&&(i.g==t||si(i.i,t)))if(!t.K&&si(i.i,t)&&3==i.H){try{var n=i.Ja.g.parse(e)}catch(l){n=null}if(Array.isArray(n)&&3==n.length){var r=n;if(0==r[0]){t:if(!i.u){if(i.g){if(!(i.g.G+3e3<t.G))break t;Vi(i),Ni(i)}Wi(i),Zt(18)}}else i.Fa=r[1],0<i.Fa-i.V&&37500>r[2]&&i.G&&0==i.A&&!i.v&&(i.v=te(g(i.ib,i),6e3));if(1>=ri(i.i)&&i.oa){try{i.oa()}catch(l){}i.oa=void 0}}else Qi(i,11)}else if((t.K||i.g==t)&&Vi(i),!E(e))for(r=i.Ja.g.parse(e),e=0;e<r.length;e++){let l=r[e];if(i.V=l[0],l=l[1],2==i.H)if("c"==l[0]){i.K=l[1],i.pa=l[2];const e=l[3];null!=e&&(i.ra=e,i.l.info("VER="+i.ra));const r=l[4];null!=r&&(i.Ga=r,i.l.info("SVER="+i.Ga));const u=l[5];null!=u&&"number"==typeof u&&0<u&&(n=1.5*u,i.L=n,i.l.info("backChannelRequestTimeoutMs_="+n)),n=i;const c=t.g;if(c){const t=c.g?c.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(t){var s=n.i;s.g||-1==t.indexOf("spdy")&&-1==t.indexOf("quic")&&-1==t.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(oi(s,s.h),s.h=null))}if(n.F){const t=c.g?c.g.getResponseHeader("X-HTTP-Session-Id"):null;t&&(n.Da=t,He(n.I,n.F,t))}}i.H=3,i.h&&i.h.Ba(),i.ca&&(i.S=Date.now()-t.G,i.l.info("Handshake RTT: "+i.S+"ms"));var o=t;if((n=i).wa=en(n,n.J?n.pa:null,n.Y),o.K){hi(n.i,o);var h=o,a=n.L;a&&h.setTimeout(a),h.C&&(Ee(h),Te(h)),n.g=o}else Ji(n);0<i.j.length&&Bi(i)}else"stop"!=l[0]&&"close"!=l[0]||Qi(i,7);else 3==i.H&&("stop"==l[0]||"close"==l[0]?"stop"==l[0]?Qi(i,7):Xi(i):"noop"!=l[0]&&i.h&&i.h.Aa(l),i.A=0)}Vt(4)}catch(l){}}function Ae(t){if(t.Z&&"function"==typeof t.Z)return t.Z();if("undefined"!=typeof Map&&t instanceof Map||"undefined"!=typeof Set&&t instanceof Set)return Array.from(t.values());if("string"==typeof t)return t.split("");if(o(t)){for(var e=[],i=t.length,n=0;n<i;n++)e.push(t[n]);return e}for(n in e=[],i=0,t)e[i++]=t[n];return e}function Ie(t){if(t.ta&&"function"==typeof t.ta)return t.ta();if(!t.Z||"function"!=typeof t.Z){if("undefined"!=typeof Map&&t instanceof Map)return Array.from(t.keys());if(!("undefined"!=typeof Set&&t instanceof Set)){if(o(t)||"string"==typeof t){var e=[];t=t.length;for(var i=0;i<t;i++)e.push(i);return e}e=[],i=0;for(const n in t)e[i++]=n;return e}}}function Me(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(o(t)||"string"==typeof t)Array.prototype.forEach.call(t,e,void 0);else for(var i=Ie(t),n=Ae(t),r=n.length,s=0;s<r;s++)e.call(void 0,n[s],i&&i[s],t)}(e=ce.prototype).setTimeout=function(t){this.P=t},e.nb=function(t){t=t.target;const e=this.M;e&&3==Oi(t)?e.l():this.Pa(t)},e.Pa=function(t){try{if(t==this.g)t:{const c=Oi(this.g);var e=this.g.Ia();const f=this.g.da();if(!(3>c)&&(3!=c||k||this.g&&(this.h.h||this.g.ja()||Pi(this.g)))){this.J||4!=c||7==e||Vt(8==e||0>=f?3:2),Ee(this);var i=this.g.da();this.ca=i;e:if(me(this)){var n=Pi(this.g);t="";var r=n.length,o=4==Oi(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){je(this),xe(this);var h="";break e}this.h.i=new s.TextDecoder}for(e=0;e<r;e++)this.h.h=!0,t+=this.h.i.decode(n[e],{stream:o&&e==r-1});n.length=0,this.h.g+=t,this.o=0,h=this.h.g}else h=this.g.ja();if(this.i=200==i,Ut(this.j,this.v,this.B,this.m,this.W,c,i),this.i){if(this.aa&&!this.K){e:{if(this.g){var a,l=this.g;if((a=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!E(a)){var u=a;break e}}u=null}if(!(i=u)){this.i=!1,this.s=3,Zt(12),je(this),xe(this);break t}Kt(this.j,this.m,i,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ce(this,i)}this.S?(be(this,c,h),k&&this.i&&3==c&&(Xt(this.U,this.V,"tick",this.mb),this.V.start())):(Kt(this.j,this.m,h,null),Ce(this,h)),4==c&&je(this),this.i&&!this.J&&(4==c?$i(this.l,this):(this.i=!1,Te(this)))}else ki(this.g),400==i&&0<h.indexOf("Unknown SID")?(this.s=3,Zt(12)):(this.s=0,Zt(13)),je(this),xe(this)}}}catch(c){}},e.mb=function(){if(this.g){var t=Oi(this.g),e=this.g.ja();this.o<e.length&&(Ee(this),be(this,t,e),this.i&&4!=t&&Te(this))}},e.cancel=function(){this.J=!0,je(this)},e.lb=function(){this.C=null;const t=Date.now();0<=t-this.Y?(Yt(this.j,this.B),2!=this.L&&(Vt(),Zt(17)),je(this),this.s=2,xe(this)):Se(this,this.Y-t)};var Re=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Oe(t,e){if(t){t=t.split("&");for(var i=0;i<t.length;i++){var n=t[i].indexOf("="),r=null;if(0<=n){var s=t[i].substring(0,n);r=t[i].substring(n+1)}else s=t[i];e(s,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}}function Pe(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof Pe){this.h=t.h,_e(this,t.j),this.s=t.s,this.g=t.g,De(this,t.m),this.l=t.l;var e=t.i,i=new We;i.i=e.i,e.g&&(i.g=new Map(e.g),i.h=e.h),Le(this,i),this.o=t.o}else t&&(e=String(t).match(Re))?(this.h=!1,_e(this,e[1]||"",!0),this.s=Ne(e[2]||""),this.g=Ne(e[3]||"",!0),De(this,e[4]),this.l=Ne(e[5]||"",!0),Le(this,e[6]||"",!0),this.o=Ne(e[7]||"")):(this.h=!1,this.i=new We(null,this.h))}function ke(t){return new Pe(t)}function _e(t,e,i){t.j=i?Ne(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function De(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function Le(t,e,i){e instanceof We?(t.i=e,Qe(t.i,t.h)):(i||(e=Fe(e,Ge)),t.i=new We(e,t.h))}function He(t,e,i){t.i.set(e,i)}function Xe(t){return He(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function Ne(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Fe(t,e,i){return"string"==typeof t?(t=encodeURI(t).replace(e,Be),i&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Be(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Pe.prototype.toString=function(){var t=[],e=this.j;e&&t.push(Fe(e,Ue,!0),":");var i=this.g;return(i||"file"==e)&&(t.push("//"),(e=this.s)&&t.push(Fe(e,Ue,!0),"@"),t.push(encodeURIComponent(String(i)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(i=this.m)&&t.push(":",String(i))),(i=this.l)&&(this.g&&"/"!=i.charAt(0)&&t.push("/"),t.push(Fe(i,"/"==i.charAt(0)?Ye:Ke,!0))),(i=this.i.toString())&&t.push("?",i),(i=this.o)&&t.push("#",Fe(i,Je)),t.join("")};var Ue=/[#\/\?@]/g,Ke=/[#\?:]/g,Ye=/[#\?]/g,Ge=/[#\?@]/g,Je=/#/g;function We(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function ze(t){t.g||(t.g=new Map,t.h=0,t.i&&Oe(t.i,function(e,i){t.add(decodeURIComponent(e.replace(/\+/g," ")),i)}))}function qe(t,e){ze(t),e=Ze(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function Ve(t,e){return ze(t),e=Ze(t,e),t.g.has(e)}function $e(t,e,i){qe(t,e),0<i.length&&(t.i=null,t.g.set(Ze(t,e),b(i)),t.h+=i.length)}function Ze(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function Qe(t,e){e&&!t.j&&(ze(t),t.i=null,t.g.forEach(function(t,e){var i=e.toLowerCase();e!=i&&(qe(this,e),$e(this,i,t))},t)),t.j=e}(e=We.prototype).add=function(t,e){ze(this),this.i=null,t=Ze(this,t);var i=this.g.get(t);return i||this.g.set(t,i=[]),i.push(e),this.h+=1,this},e.forEach=function(t,e){ze(this),this.g.forEach(function(i,n){i.forEach(function(i){t.call(e,i,n,this)},this)},this)},e.ta=function(){ze(this);const t=Array.from(this.g.values()),e=Array.from(this.g.keys()),i=[];for(let n=0;n<e.length;n++){const r=t[n];for(let t=0;t<r.length;t++)i.push(e[n])}return i},e.Z=function(t){ze(this);let e=[];if("string"==typeof t)Ve(this,t)&&(e=e.concat(this.g.get(Ze(this,t))));else{t=Array.from(this.g.values());for(let i=0;i<t.length;i++)e=e.concat(t[i])}return e},e.set=function(t,e){return ze(this),this.i=null,Ve(this,t=Ze(this,t))&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this},e.get=function(t,e){return t&&0<(t=this.Z(t)).length?String(t[0]):e},e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const t=[],e=Array.from(this.g.keys());for(var i=0;i<e.length;i++){var n=e[i];const s=encodeURIComponent(String(n)),o=this.Z(n);for(n=0;n<o.length;n++){var r=s;""!==o[n]&&(r+="="+encodeURIComponent(String(o[n]))),t.push(r)}}return this.i=t.join("&")};var ti=class{constructor(t,e){this.g=t,this.map=e}};function ei(t){this.l=t||ii,s.PerformanceNavigationTiming?t=0<(t=s.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):t=!!(s.g&&s.g.Ka&&s.g.Ka()&&s.g.Ka().dc),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var ii=10;function ni(t){return!!t.h||!!t.g&&t.g.size>=t.j}function ri(t){return t.h?1:t.g?t.g.size:0}function si(t,e){return t.h?t.h==e:!!t.g&&t.g.has(e)}function oi(t,e){t.g?t.g.add(e):t.h=e}function hi(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}function ai(t){if(null!=t.h)return t.i.concat(t.h.F);if(null!=t.g&&0!==t.g.size){let e=t.i;for(const i of t.g.values())e=e.concat(i.F);return e}return b(t.i)}ei.prototype.cancel=function(){if(this.i=ai(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const t of this.g.values())t.cancel();this.g.clear()}};var li=class{stringify(t){return s.JSON.stringify(t,void 0)}parse(t){return s.JSON.parse(t,void 0)}};function ui(){this.g=new li}function ci(t,e,i){const n=i||"";try{Me(t,function(t,i){let r=t;h(t)&&(r=mt(t)),e.push(n+i+"="+encodeURIComponent(r))})}catch(r){throw e.push(n+"type="+encodeURIComponent("_badmap")),r}}function fi(t,e){const i=new Ft;if(s.Image){const n=new Image;n.onload=p(gi,i,n,"TestLoadImage: loaded",!0,e),n.onerror=p(gi,i,n,"TestLoadImage: error",!1,e),n.onabort=p(gi,i,n,"TestLoadImage: abort",!1,e),n.ontimeout=p(gi,i,n,"TestLoadImage: timeout",!1,e),s.setTimeout(function(){n.ontimeout&&n.ontimeout()},1e4),n.src=t}else e(!1)}function gi(t,e,i,n,r){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,r(n)}catch(s){}}function pi(t){this.l=t.ec||null,this.j=t.ob||!1}function di(t,e){dt.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=yi,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}d(pi,ne),pi.prototype.g=function(){return new di(this.l,this.j)},pi.prototype.i=function(t){return function(){return t}}({}),d(di,dt);var yi=0;function vi(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}function mi(t){t.readyState=4,t.l=null,t.j=null,t.A=null,bi(t)}function bi(t){t.onreadystatechange&&t.onreadystatechange.call(t)}(e=di.prototype).open=function(t,e){if(this.readyState!=yi)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,bi(this)},e.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||s).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))},e.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,mi(this)),this.readyState=yi},e.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,bi(this)),this.g&&(this.readyState=3,bi(this),this.g)))if("arraybuffer"===this.responseType)t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(void 0!==s.ReadableStream&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;vi(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))},e.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?mi(this):bi(this),3==this.readyState&&vi(this)}},e.Za=function(t){this.g&&(this.response=this.responseText=t,mi(this))},e.Ya=function(t){this.g&&(this.response=t,mi(this))},e.ka=function(){this.g&&mi(this)},e.setRequestHeader=function(t,e){this.v.append(t,e)},e.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const t=[],e=this.h.entries();for(var i=e.next();!i.done;)i=i.value,t.push(i[0]+": "+i[1]),i=e.next();return t.join("\r\n")},Object.defineProperty(di.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(t){this.m=t?"include":"same-origin"}});var wi=s.JSON.parse;function Ti(t){dt.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=Si,this.L=this.M=!1}d(Ti,dt);var Si="",Ei=/^https?$/i,xi=["POST","PUT"];function ji(t){return O&&"number"==typeof t.timeout&&void 0!==t.ontimeout}function Ci(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,Ai(t),Mi(t)}function Ai(t){t.F||(t.F=!0,yt(t,"complete"),yt(t,"error"))}function Ii(t){if(t.h&&void 0!==r&&(!t.C[1]||4!=Oi(t)||2!=t.da()))if(t.v&&4==Oi(t))kt(t.La,0,t);else if(yt(t,"readystatechange"),4==Oi(t)){t.h=!1;try{const r=t.da();t:switch(r){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break t;default:e=!1}var i;if(!(i=e)){var n;if(n=0===r){var o=String(t.I).match(Re)[1]||null;!o&&s.self&&s.self.location&&(o=s.self.location.protocol.slice(0,-1)),n=!Ei.test(o?o.toLowerCase():"")}i=n}if(i)yt(t,"complete"),yt(t,"success");else{t.m=6;try{var h=2<Oi(t)?t.g.statusText:""}catch(a){h=""}t.j=h+" ["+t.da()+"]",Ai(t)}}finally{Mi(t)}}}function Mi(t,e){if(t.g){Ri(t);const n=t.g,r=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||yt(t,"ready");try{n.onreadystatechange=r}catch(i){}}}function Ri(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(s.clearTimeout(t.A),t.A=null)}function Oi(t){return t.g?t.g.readyState:0}function Pi(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case Si:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch(e){return null}}function ki(t){const e={};t=(t.g&&2<=Oi(t)&&t.g.getAllResponseHeaders()||"").split("\r\n");for(let n=0;n<t.length;n++){if(E(t[n]))continue;var i=xt(t[n]);const r=i[0];if("string"!=typeof(i=i[1]))continue;i=i.trim();const s=e[r]||[];e[r]=s,s.push(i)}q(e,function(t){return t.join(", ")})}function _i(t){let e="";return z(t,function(t,i){e+=i,e+=":",e+=t,e+="\r\n"}),e}function Di(t,e,i){t:{for(n in i){var n=!1;break t}n=!0}n||(i=_i(i),"string"==typeof t?null!=i&&encodeURIComponent(String(i)):He(t,e,i))}function Li(t,e,i){return i&&i.internalChannelParams&&i.internalChannelParams[t]||e}function Hi(t){this.Ga=0,this.j=[],this.l=new Ft,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=Li("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=Li("baseRetryDelayMs",5e3,t),this.hb=Li("retryDelaySeedMs",1e4,t),this.eb=Li("forwardChannelMaxRetries",2,t),this.xa=Li("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.useFetchStreams||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new ei(t&&t.concurrentRequestLimit),this.Ja=new ui,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}function Xi(t){if(Fi(t),3==t.H){var e=t.W++,i=ke(t.I);if(He(i,"SID",t.K),He(i,"RID",e),He(i,"TYPE","terminate"),Yi(t,i),(e=new ce(t,t.l,e)).L=2,e.A=Xe(ke(i)),i=!1,s.navigator&&s.navigator.sendBeacon)try{i=s.navigator.sendBeacon(e.A.toString(),"")}catch(n){}!i&&s.Image&&((new Image).src=e.A,i=!0),i||(e.g=nn(e.l,null),e.g.ha(e.A)),e.G=Date.now(),Te(e)}tn(t)}function Ni(t){t.g&&(zi(t),t.g.cancel(),t.g=null)}function Fi(t){Ni(t),t.u&&(s.clearTimeout(t.u),t.u=null),Vi(t),t.i.cancel(),t.m&&("number"==typeof t.m&&s.clearTimeout(t.m),t.m=null)}function Bi(t){if(!ni(t.i)&&!t.m){t.m=!0;var e=t.Na;Ct||Mt(),At||(Ct(),At=!0),It.add(e,t),t.C=0}}function Ui(t,e){return!(ri(t.i)>=t.i.j-(t.m?1:0))&&(t.m?(t.j=e.F.concat(t.j),!0):!(1==t.H||2==t.H||t.C>=(t.cb?0:t.eb))&&(t.m=te(g(t.Na,t,e),Zi(t,t.C)),t.C++,!0))}function Ki(t,e){var i;i=e?e.m:t.W++;const n=ke(t.I);He(n,"SID",t.K),He(n,"RID",i),He(n,"AID",t.V),Yi(t,n),t.o&&t.s&&Di(n,t.o,t.s),i=new ce(t,t.l,i,t.C+1),null===t.o&&(i.I=t.s),e&&(t.j=e.F.concat(t.j)),e=Gi(t,i,1e3),i.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),oi(t.i,i),ye(i,n,e)}function Yi(t,e){t.na&&z(t.na,function(t,i){He(e,i,t)}),t.h&&Me({},function(t,i){He(e,i,t)})}function Gi(t,e,i){i=Math.min(t.j.length,i);var n=t.h?g(t.h.Va,t.h,t):null;t:{var r=t.j;let e=-1;for(;;){const t=["count="+i];-1==e?0<i?(e=r[0].g,t.push("ofs="+e)):e=0:t.push("ofs="+e);let o=!0;for(let h=0;h<i;h++){let i=r[h].g;const a=r[h].map;if(0>(i-=e))e=Math.max(0,r[h].g-100),o=!1;else try{ci(a,t,"req"+i+"_")}catch(s){n&&n(a)}}if(o){n=t.join("&");break t}}}return t=t.j.splice(0,i),e.F=t,n}function Ji(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;Ct||Mt(),At||(Ct(),At=!0),It.add(e,t),t.A=0}}function Wi(t){return!(t.g||t.u||3<=t.A)&&(t.ba++,t.u=te(g(t.Ma,t),Zi(t,t.A)),t.A++,!0)}function zi(t){null!=t.B&&(s.clearTimeout(t.B),t.B=null)}function qi(t){t.g=new ce(t,t.l,"rpc",t.ba),null===t.o&&(t.g.I=t.s),t.g.O=0;var e=ke(t.wa);He(e,"RID","rpc"),He(e,"SID",t.K),He(e,"AID",t.V),He(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&He(e,"TO",t.qa),He(e,"TYPE","xmlhttp"),Yi(t,e),t.o&&t.s&&Di(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var i=t.g;t=t.pa,i.L=1,i.A=Xe(ke(e)),i.u=null,i.S=!0,ve(i,t)}function Vi(t){null!=t.v&&(s.clearTimeout(t.v),t.v=null)}function $i(t,e){var i=null;if(t.g==e){Vi(t),zi(t),t.g=null;var n=2}else{if(!si(t.i,e))return;i=e.F,hi(t.i,e),n=1}if(0!=t.H)if(e.i)if(1==n){i=e.u?e.u.length:0,e=Date.now()-e.G;var r=t.C;yt(n=zt(),new Qt(n,i)),Bi(t)}else Ji(t);else if(3==(r=e.s)||0==r&&0<e.ca||!(1==n&&Ui(t,e)||2==n&&Wi(t)))switch(i&&0<i.length&&(e=t.i,e.i=e.i.concat(i)),r){case 1:Qi(t,5);break;case 4:Qi(t,10);break;case 3:Qi(t,6);break;default:Qi(t,2)}}function Zi(t,e){let i=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(i*=2),i*e}function Qi(t,e){if(t.l.info("Error code "+e),2==e){var i=null;t.h&&(i=null);var n=g(t.pb,t);i||(i=new Pe("//www.google.com/images/cleardot.gif"),s.location&&"http"==s.location.protocol||_e(i,"https"),Xe(i)),fi(i.toString(),n)}else Zt(2);t.H=0,t.h&&t.h.za(e),tn(t),Fi(t)}function tn(t){if(t.H=0,t.ma=[],t.h){const e=ai(t.i);0==e.length&&0==t.j.length||(w(t.ma,e),w(t.ma,t.j),t.i.i.length=0,b(t.j),t.j.length=0),t.h.ya()}}function en(t,e,i){var n=i instanceof Pe?ke(i):new Pe(i);if(""!=n.g)e&&(n.g=e+"."+n.g),De(n,n.m);else{var r=s.location;n=r.protocol,e=e?e+"."+r.hostname:r.hostname,r=+r.port;var o=new Pe(null);n&&_e(o,n),e&&(o.g=e),r&&De(o,r),i&&(o.l=i),n=o}return i=t.F,e=t.Da,i&&e&&He(n,i,e),He(n,"VER",t.ra),Yi(t,n),n}function nn(t,e,i){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return(e=t.Ha&&!t.va?new Ti(new pi({ob:i})):new Ti(t.va)).Oa(t.J),e}function rn(){}function sn(){if(O&&!(10<=Number(B)))throw Error("Environmental error: no available transport.")}function on(t,e){dt.call(this),this.g=new Hi(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!E(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!E(e)&&(this.g.F=e,null!==(t=this.h)&&e in t&&(e in(t=this.h)&&delete t[e])),this.j=new ln(this)}function hn(t){ae.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){t:{for(const i in e){t=i;break t}t=void 0}(this.i=t)&&(t=this.i,e=null!==e&&t in e?e[t]:void 0),this.data=e}else this.data=t}function an(){le.call(this),this.status=1}function ln(t){this.g=t}function un(){this.blockSize=-1}function cn(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function fn(t,e,i){i||(i=0);var n=Array(16);if("string"==typeof e)for(var r=0;16>r;++r)n[r]=e.charCodeAt(i++)|e.charCodeAt(i++)<<8|e.charCodeAt(i++)<<16|e.charCodeAt(i++)<<24;else for(r=0;16>r;++r)n[r]=e[i++]|e[i++]<<8|e[i++]<<16|e[i++]<<24;e=t.g[0],i=t.g[1],r=t.g[2];var s=t.g[3],o=e+(s^i&(r^s))+n[0]+3614090360&4294967295;o=(i=(r=(s=(e=(i=(r=(s=(e=(i=(r=(s=(e=(i=(r=(s=(e=(i=(r=(s=(e=(i=(r=(s=(e=(i=(r=(s=(e=(i=(r=(s=(e=(i=(r=(s=(e=(i=(r=(s=(e=(i=(r=(s=(e=(i=(r=(s=(e=(i=(r=(s=(e=(i=(r=(s=(e=(i=(r=(s=(e=i+(o<<7&4294967295|o>>>25))+((o=s+(r^e&(i^r))+n[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=r+(i^s&(e^i))+n[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=i+(e^r&(s^e))+n[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^i&(r^s))+n[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=s+(r^e&(i^r))+n[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=r+(i^s&(e^i))+n[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=i+(e^r&(s^e))+n[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^i&(r^s))+n[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=s+(r^e&(i^r))+n[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=r+(i^s&(e^i))+n[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=i+(e^r&(s^e))+n[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=e+(s^i&(r^s))+n[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=s+(r^e&(i^r))+n[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=r+(i^s&(e^i))+n[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=i+(e^r&(s^e))+n[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=e+(r^s&(i^r))+n[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=s+(i^r&(e^i))+n[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=r+(e^i&(s^e))+n[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=i+(s^e&(r^s))+n[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=e+(r^s&(i^r))+n[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=s+(i^r&(e^i))+n[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=r+(e^i&(s^e))+n[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=i+(s^e&(r^s))+n[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=e+(r^s&(i^r))+n[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=s+(i^r&(e^i))+n[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=r+(e^i&(s^e))+n[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=i+(s^e&(r^s))+n[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=e+(r^s&(i^r))+n[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=s+(i^r&(e^i))+n[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=r+(e^i&(s^e))+n[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=i+(s^e&(r^s))+n[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=e+(i^r^s)+n[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^i^r)+n[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^e^i)+n[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=i+(r^s^e)+n[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=e+(i^r^s)+n[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^i^r)+n[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^e^i)+n[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=i+(r^s^e)+n[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=e+(i^r^s)+n[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^i^r)+n[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^e^i)+n[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=i+(r^s^e)+n[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=e+(i^r^s)+n[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=s+(e^i^r)+n[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=r+(s^e^i)+n[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=i+(r^s^e)+n[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=e+(r^(i|~s))+n[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=s+(i^(e|~r))+n[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=r+(e^(s|~i))+n[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=i+(s^(r|~e))+n[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=e+(r^(i|~s))+n[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=s+(i^(e|~r))+n[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=r+(e^(s|~i))+n[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=i+(s^(r|~e))+n[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=e+(r^(i|~s))+n[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=s+(i^(e|~r))+n[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=r+(e^(s|~i))+n[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=i+(s^(r|~e))+n[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((s=(e=i+((o=e+(r^(i|~s))+n[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=s+(i^(e|~r))+n[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((r=s+((o=r+(e^(s|~i))+n[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~e))+n[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(r+(o<<21&4294967295|o>>>11))&4294967295,t.g[2]=t.g[2]+r&4294967295,t.g[3]=t.g[3]+s&4294967295}function gn(t,e){this.h=e;for(var i=[],n=!0,r=t.length-1;0<=r;r--){var s=0|t[r];n&&s==e||(i[r]=s,n=!1)}this.g=i}(e=Ti.prototype).Oa=function(t){this.M=t},e.ha=function(t,e,i,n){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():oe.g(),this.C=this.u?re(this.u):re(oe),this.g.onreadystatechange=g(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(o){return void Ci(this,o)}if(t=i||"",i=new Map(this.headers),n)if(Object.getPrototypeOf(n)===Object.prototype)for(var r in n)i.set(r,n[r]);else{if("function"!=typeof n.keys||"function"!=typeof n.get)throw Error("Unknown input type for opt_headers: "+String(n));for(const t of n.keys())i.set(t,n.get(t))}n=Array.from(i.keys()).find(t=>"content-type"==t.toLowerCase()),r=s.FormData&&t instanceof s.FormData,!(0<=m(xi,e))||n||r||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[s,h]of i)this.g.setRequestHeader(s,h);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{Ri(this),0<this.B&&((this.L=ji(this.g))?(this.g.timeout=this.B,this.g.ontimeout=g(this.ua,this)):this.A=kt(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(o){Ci(this,o)}},e.ua=function(){void 0!==r&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,yt(this,"timeout"),this.abort(8))},e.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,yt(this,"complete"),yt(this,"abort"),Mi(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Mi(this,!0)),Ti.$.N.call(this)},e.La=function(){this.s||(this.G||this.v||this.l?Ii(this):this.kb())},e.kb=function(){Ii(this)},e.isActive=function(){return!!this.g},e.da=function(){try{return 2<Oi(this)?this.g.status:-1}catch(t){return-1}},e.ja=function(){try{return this.g?this.g.responseText:""}catch(t){return""}},e.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),wi(e)}},e.Ia=function(){return this.m},e.Sa=function(){return"string"==typeof this.j?this.j:String(this.j)},(e=Hi.prototype).ra=8,e.H=1,e.Na=function(t){if(this.m)if(this.m=null,1==this.H){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;const r=new ce(this,this.l,t);let s=this.s;if(this.U&&(s?Z(s=V(s),this.U):s=this.U),null!==this.o||this.O||(r.I=s,s=null),this.P)t:{for(var e=0,i=0;i<this.j.length;i++){var n=this.j[i];if(void 0===(n="__data__"in n.map&&"string"==typeof(n=n.map.__data__)?n.length:void 0))break;if(4096<(e+=n)){e=i;break t}if(4096===e||i===this.j.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Gi(this,r,e),He(i=ke(this.I),"RID",t),He(i,"CVER",22),this.F&&He(i,"X-HTTP-Session-Id",this.F),Yi(this,i),s&&(this.O?e="headers="+encodeURIComponent(String(_i(s)))+"&"+e:this.o&&Di(i,this.o,s)),oi(this.i,r),this.bb&&He(i,"TYPE","init"),this.P?(He(i,"$req",e),He(i,"SID","null"),r.aa=!0,ye(r,i,null)):ye(r,i,e),this.H=2}}else 3==this.H&&(t?Ki(this,t):0==this.j.length||ni(this.i)||Ki(this))},e.Ma=function(){if(this.u=null,qi(this),this.ca&&!(this.M||null==this.g||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=te(g(this.jb,this),t)}},e.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,Zt(10),Ni(this),qi(this))},e.ib=function(){null!=this.v&&(this.v=null,Ni(this),Wi(this),Zt(19))},e.pb=function(t){t?(this.l.info("Successfully pinged google.com"),Zt(2)):(this.l.info("Failed to ping google.com"),Zt(1))},e.isActive=function(){return!!this.h&&this.h.isActive(this)},(e=rn.prototype).Ba=function(){},e.Aa=function(){},e.za=function(){},e.ya=function(){},e.isActive=function(){return!0},e.Va=function(){},sn.prototype.g=function(t,e){return new on(t,e)},d(on,dt),on.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,i=this.h||void 0;Zt(0),t.Y=e,t.na=i||{},t.G=t.aa,t.I=en(t,null,t.Y),Bi(t)},on.prototype.close=function(){Xi(this.g)},on.prototype.u=function(t){var e=this.g;if("string"==typeof t){var i={};i.__data__=t,t=i}else this.v&&((i={}).__data__=mt(t),t=i);e.j.push(new ti(e.fb++,t)),3==e.H&&Bi(e)},on.prototype.N=function(){this.g.h=null,delete this.j,Xi(this.g),delete this.g,on.$.N.call(this)},d(hn,ae),d(an,le),d(ln,rn),ln.prototype.Ba=function(){yt(this.g,"a")},ln.prototype.Aa=function(t){yt(this.g,new hn(t))},ln.prototype.za=function(t){yt(this.g,new an)},ln.prototype.ya=function(){yt(this.g,"b")},d(cn,un),cn.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},cn.prototype.j=function(t,e){void 0===e&&(e=t.length);for(var i=e-this.blockSize,n=this.m,r=this.h,s=0;s<e;){if(0==r)for(;s<=i;)fn(this,t,s),s+=this.blockSize;if("string"==typeof t){for(;s<e;)if(n[r++]=t.charCodeAt(s++),r==this.blockSize){fn(this,n),r=0;break}}else for(;s<e;)if(n[r++]=t[s++],r==this.blockSize){fn(this,n),r=0;break}}this.h=r,this.i+=e},cn.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var i=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=255&i,i/=256;for(this.j(t),t=Array(16),e=i=0;4>e;++e)for(var n=0;32>n;n+=8)t[i++]=this.g[e]>>>n&255;return t};var pn={};function dn(t){return-128<=t&&128>t?A(t,function(t){return new gn([0|t],0>t?-1:0)}):new gn([0|t],0>t?-1:0)}function yn(t){if(isNaN(t)||!isFinite(t))return bn;if(0>t)return xn(yn(-t));for(var e=[],i=1,n=0;t>=i;n++)e[n]=t/i|0,i*=mn;return new gn(e,0)}function vn(t,e){if(0==t.length)throw Error("number format error: empty string");if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if("-"==t.charAt(0))return xn(vn(t.substring(1),e));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var i=yn(Math.pow(e,8)),n=bn,r=0;r<t.length;r+=8){var s=Math.min(8,t.length-r),o=parseInt(t.substring(r,r+s),e);8>s?(s=yn(Math.pow(e,s)),n=n.R(s).add(yn(o))):n=(n=n.R(i)).add(yn(o))}return n}var mn=4294967296,bn=dn(0),wn=dn(1),Tn=dn(16777216);function Sn(t){if(0!=t.h)return!1;for(var e=0;e<t.g.length;e++)if(0!=t.g[e])return!1;return!0}function En(t){return-1==t.h}function xn(t){for(var e=t.g.length,i=[],n=0;n<e;n++)i[n]=~t.g[n];return new gn(i,~t.h).add(wn)}function jn(t,e){return t.add(xn(e))}function Cn(t,e){for(;(65535&t[e])!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function An(t,e){this.g=t,this.h=e}function In(t,e){if(Sn(e))throw Error("division by zero");if(Sn(t))return new An(bn,bn);if(En(t))return e=In(xn(t),e),new An(xn(e.g),xn(e.h));if(En(e))return e=In(t,xn(e)),new An(xn(e.g),e.h);if(30<t.g.length){if(En(t)||En(e))throw Error("slowDivide_ only works with positive integers.");for(var i=wn,n=e;0>=n.X(t);)i=Mn(i),n=Mn(n);var r=Rn(i,1),s=Rn(n,1);for(n=Rn(n,2),i=Rn(i,2);!Sn(n);){var o=s.add(n);0>=o.X(t)&&(r=r.add(i),s=o),n=Rn(n,1),i=Rn(i,1)}return e=jn(t,r.R(e)),new An(r,e)}for(r=bn;0<=t.X(e);){for(i=Math.max(1,Math.floor(t.ea()/e.ea())),n=48>=(n=Math.ceil(Math.log(i)/Math.LN2))?1:Math.pow(2,n-48),o=(s=yn(i)).R(e);En(o)||0<o.X(t);)o=(s=yn(i-=n)).R(e);Sn(s)&&(s=wn),r=r.add(s),t=jn(t,o)}return new An(r,t)}function Mn(t){for(var e=t.g.length+1,i=[],n=0;n<e;n++)i[n]=t.D(n)<<1|t.D(n-1)>>>31;return new gn(i,t.h)}function Rn(t,e){var i=e>>5;e%=32;for(var n=t.g.length-i,r=[],s=0;s<n;s++)r[s]=0<e?t.D(s+i)>>>e|t.D(s+i+1)<<32-e:t.D(s+i);return new gn(r,t.h)}(e=gn.prototype).ea=function(){if(En(this))return-xn(this).ea();for(var t=0,e=1,i=0;i<this.g.length;i++){var n=this.D(i);t+=(0<=n?n:mn+n)*e,e*=mn}return t},e.toString=function(t){if(2>(t=t||10)||36<t)throw Error("radix out of range: "+t);if(Sn(this))return"0";if(En(this))return"-"+xn(this).toString(t);for(var e=yn(Math.pow(t,6)),i=this,n="";;){var r=In(i,e).g,s=((0<(i=jn(i,r.R(e))).g.length?i.g[0]:i.h)>>>0).toString(t);if(Sn(i=r))return s+n;for(;6>s.length;)s="0"+s;n=s+n}},e.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h},e.X=function(t){return En(t=jn(this,t))?-1:Sn(t)?0:1},e.abs=function(){return En(this)?xn(this):this},e.add=function(t){for(var e=Math.max(this.g.length,t.g.length),i=[],n=0,r=0;r<=e;r++){var s=n+(65535&this.D(r))+(65535&t.D(r)),o=(s>>>16)+(this.D(r)>>>16)+(t.D(r)>>>16);n=o>>>16,s&=65535,o&=65535,i[r]=o<<16|s}return new gn(i,-2147483648&i[i.length-1]?-1:0)},e.R=function(t){if(Sn(this)||Sn(t))return bn;if(En(this))return En(t)?xn(this).R(xn(t)):xn(xn(this).R(t));if(En(t))return xn(this.R(xn(t)));if(0>this.X(Tn)&&0>t.X(Tn))return yn(this.ea()*t.ea());for(var e=this.g.length+t.g.length,i=[],n=0;n<2*e;n++)i[n]=0;for(n=0;n<this.g.length;n++)for(var r=0;r<t.g.length;r++){var s=this.D(n)>>>16,o=65535&this.D(n),h=t.D(r)>>>16,a=65535&t.D(r);i[2*n+2*r]+=o*a,Cn(i,2*n+2*r),i[2*n+2*r+1]+=s*a,Cn(i,2*n+2*r+1),i[2*n+2*r+1]+=o*h,Cn(i,2*n+2*r+1),i[2*n+2*r+2]+=s*h,Cn(i,2*n+2*r+2)}for(n=0;n<e;n++)i[n]=i[2*n+1]<<16|i[2*n];for(n=e;n<2*e;n++)i[n]=0;return new gn(i,0)},e.gb=function(t){return In(this,t).h},e.and=function(t){for(var e=Math.max(this.g.length,t.g.length),i=[],n=0;n<e;n++)i[n]=this.D(n)&t.D(n);return new gn(i,this.h&t.h)},e.or=function(t){for(var e=Math.max(this.g.length,t.g.length),i=[],n=0;n<e;n++)i[n]=this.D(n)|t.D(n);return new gn(i,this.h|t.h)},e.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),i=[],n=0;n<e;n++)i[n]=this.D(n)^t.D(n);return new gn(i,this.h^t.h)},sn.prototype.createWebChannel=sn.prototype.g,on.prototype.send=on.prototype.u,on.prototype.open=on.prototype.m,on.prototype.close=on.prototype.close,ee.NO_ERROR=0,ee.TIMEOUT=8,ee.HTTP_ERROR=6,ie.COMPLETE="complete",se.EventType=he,he.OPEN="a",he.CLOSE="b",he.ERROR="c",he.MESSAGE="d",dt.prototype.listen=dt.prototype.O,Ti.prototype.listenOnce=Ti.prototype.P,Ti.prototype.getLastError=Ti.prototype.Sa,Ti.prototype.getLastErrorCode=Ti.prototype.Ia,Ti.prototype.getStatus=Ti.prototype.da,Ti.prototype.getResponseJson=Ti.prototype.Wa,Ti.prototype.getResponseText=Ti.prototype.ja,Ti.prototype.send=Ti.prototype.ha,Ti.prototype.setWithCredentials=Ti.prototype.Oa,cn.prototype.digest=cn.prototype.l,cn.prototype.reset=cn.prototype.reset,cn.prototype.update=cn.prototype.j,gn.prototype.add=gn.prototype.add,gn.prototype.multiply=gn.prototype.R,gn.prototype.modulo=gn.prototype.gb,gn.prototype.compare=gn.prototype.X,gn.prototype.toNumber=gn.prototype.ea,gn.prototype.toString=gn.prototype.toString,gn.prototype.getBits=gn.prototype.D,gn.fromNumber=yn,gn.fromString=vn;var On=exports.createWebChannelTransport=n.createWebChannelTransport=function(){return new sn},Pn=exports.getStatEventTarget=n.getStatEventTarget=function(){return zt()},kn=exports.ErrorCode=n.ErrorCode=ee,_n=exports.EventType=n.EventType=ie,Dn=exports.Event=n.Event=Jt,Ln=exports.Stat=n.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},Hn=exports.FetchXmlHttpFactory=n.FetchXmlHttpFactory=pi,Xn=exports.WebChannel=n.WebChannel=se,Nn=exports.XhrIo=n.XhrIo=Ti,Fn=exports.Md5=n.Md5=cn,Bn=exports.Integer=n.Integer=gn;
},{}],"lBbe":[function(require,module,exports) {
var process = require("process");
var e=require("process");Object.defineProperty(exports,"__esModule",{value:!0}),exports._TestingHooks=exports._FieldPath=exports._EmptyAuthCredentialsProvider=exports._EmptyAppCheckTokenProvider=exports._DocumentKey=exports._DatabaseId=exports._ByteString=exports._AutoId=exports.WriteBatch=exports.Transaction=exports.Timestamp=exports.SnapshotMetadata=exports.QueryStartAtConstraint=exports.QuerySnapshot=exports.QueryOrderByConstraint=exports.QueryLimitConstraint=exports.QueryFieldFilterConstraint=exports.QueryEndAtConstraint=exports.QueryDocumentSnapshot=exports.QueryConstraint=exports.QueryCompositeFilterConstraint=exports.Query=exports.PersistentCacheIndexManager=exports.LoadBundleTask=exports.GeoPoint=exports.FirestoreError=exports.Firestore=exports.FieldValue=exports.FieldPath=exports.DocumentSnapshot=exports.DocumentReference=exports.CollectionReference=exports.CACHE_SIZE_UNLIMITED=exports.Bytes=exports.AggregateQuerySnapshot=exports.AggregateField=exports.AbstractUserDataWriter=void 0,exports._cast=zu,exports._debugAssert=w,exports._isBase64Available=ot,exports._logWarn=m,exports._validateIsNotUsedTogether=Ou,exports.addDoc=Xh,exports.aggregateFieldEqual=Fh,exports.aggregateQuerySnapshotEqual=Rh,exports.and=hh,exports.arrayRemove=Td,exports.arrayUnion=xd,exports.average=Mh,exports.clearIndexedDbPersistence=fl,exports.collection=Yu,exports.collectionGroup=Ju,exports.connectFirestoreEmulator=Qu,exports.count=Lh,exports.deleteAllPersistentCacheIndexes=Fd,exports.deleteDoc=Jh,exports.deleteField=bd,exports.disableNetwork=gl,exports.disablePersistentCacheIndexAutoCreation=Ld,exports.doc=Xu,exports.documentId=Tl,exports.enableIndexedDbPersistence=ll,exports.enableMultiTabIndexedDbPersistence=hl,exports.enableNetwork=pl,exports.enablePersistentCacheIndexAutoCreation=Md,exports.endAt=bh,exports.endBefore=_h,exports.ensureFirestoreConfigured=cl,exports.executeWrite=td,exports.getAggregateFromServer=sd,exports.getCountFromServer=rd,exports.getDoc=zh,exports.getDocFromCache=Kh,exports.getDocFromServer=$h,exports.getDocs=Qh,exports.getDocsFromCache=jh,exports.getDocsFromServer=Wh,exports.getFirestore=al,exports.getPersistentCacheIndexManager=kd,exports.increment=Sd,exports.initializeFirestore=ol,exports.limit=ph,exports.limitToLast=gh,exports.loadBundle=wl,exports.memoryEagerGarbageCollector=ud,exports.memoryLocalCache=hd,exports.memoryLruGarbageCollector=ld,exports.namedQuery=vl,exports.onSnapshot=Zh,exports.onSnapshotsInSync=ed,exports.or=lh,exports.orderBy=fh,exports.persistentLocalCache=dd,exports.persistentMultipleTabManager=gd,exports.persistentSingleTabManager=pd,exports.query=oh,exports.queryEqual=el,exports.refEqual=Zu,exports.runTransaction=_d,exports.serverTimestamp=Ed,exports.setDoc=Hh,exports.setIndexConfiguration=Dd,exports.setLogLevel=h,exports.snapshotEqual=Bh,exports.startAfter=vh,exports.startAt=wh,exports.sum=kh,exports.terminate=yl,exports.updateDoc=Yh,exports.waitForPendingWrites=ml,exports.where=ch,exports.writeBatch=Cd;var t=require("@firebase/app"),n=require("@firebase/component"),r=require("@firebase/logger"),s=require("@firebase/util"),i=require("@firebase/webchannel-wrapper");const o="@firebase/firestore";class a{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}a.UNAUTHENTICATED=new a(null),a.GOOGLE_CREDENTIALS=new a("google-credentials-uid"),a.FIRST_PARTY=new a("first-party-uid"),a.MOCK_USER=new a("mock-user");let c="10.8.0";const u=new r.Logger("@firebase/firestore");function l(){return u.logLevel}function h(e){u.setLogLevel(e)}function d(e,...t){if(u.logLevel<=r.LogLevel.DEBUG){const n=t.map(p);u.debug(`Firestore (${c}): ${e}`,...n)}}function f(e,...t){if(u.logLevel<=r.LogLevel.ERROR){const n=t.map(p);u.error(`Firestore (${c}): ${e}`,...n)}}function m(e,...t){if(u.logLevel<=r.LogLevel.WARN){const n=t.map(p);u.warn(`Firestore (${c}): ${e}`,...n)}}function p(e){if("string"==typeof e)return e;try{return function(e){return JSON.stringify(e)}(e)}catch(t){return e}}function g(e="Unexpected state"){const t=`FIRESTORE (${c}) INTERNAL ASSERTION FAILED: `+e;throw f(t),new Error(t)}function y(e,t){e||g()}function w(e,t){e||g()}function v(e,t){return e}const I={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class _ extends s.FirebaseError{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=(()=>`${this.name}: [code=${this.code}]: ${this.message}`)}}exports.FirestoreError=_;class b{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class E{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class x{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(a.UNAUTHENTICATED))}shutdown(){}}exports._EmptyAuthCredentialsProvider=x;class T{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class S{constructor(e){this.t=e,this.currentUser=a.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let n=this.i;const r=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let s=new b;this.o=(()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new b,e.enqueueRetryable(()=>r(this.currentUser))});const i=()=>{const t=s;e.enqueueRetryable(async()=>{await t.promise,await r(this.currentUser)})},o=e=>{d("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.auth.addAuthTokenListener(this.o),i()};this.t.onInit(e=>o(e)),setTimeout(()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?o(e):(d("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new b)}},0),i()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(t=>this.i!==e?(d("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(y("string"==typeof t.accessToken),new E(t.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return y(null===e||"string"==typeof e),new a(e)}}class C{constructor(e,t,n){this.l=e,this.h=t,this.P=n,this.type="FirstParty",this.user=a.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class D{constructor(e,t,n){this.l=e,this.h=t,this.P=n}getToken(){return Promise.resolve(new C(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(a.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class N{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class A{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){const n=e=>{null!=e.error&&d("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);const n=e.token!==this.R;return this.R=e.token,d("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?t(e.token):Promise.resolve()};this.o=(t=>{e.enqueueRetryable(()=>n(t))});const r=e=>{d("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.appCheck.addTokenListener(this.o)};this.A.onInit(e=>r(e)),setTimeout(()=>{if(!this.appCheck){const e=this.A.getImmediate({optional:!0});e?r(e):d("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(e=>e?(y("string"==typeof e.token),this.R=e.token,new N(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}class k{getToken(){return Promise.resolve(new N(""))}invalidateToken(){}start(e,t){}shutdown(){}}function M(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}exports._EmptyAppCheckTokenProvider=k;class L{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const r=M(40);for(let s=0;s<r.length;++s)n.length<20&&r[s]<t&&(n+=e.charAt(r[s]%e.length))}return n}}function F(e,t){return e<t?-1:e>t?1:0}function R(e,t,n){return e.length===t.length&&e.every((e,r)=>n(e,t[r]))}function P(e){return e+"\0"}exports._AutoId=L;class V{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new _(I.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new _(I.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new _(I.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new _(I.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return V.fromMillis(Date.now())}static fromDate(e){return V.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new V(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?F(this.nanoseconds,e.nanoseconds):F(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}exports.Timestamp=V;class O{constructor(e){this.timestamp=e}static fromTimestamp(e){return new O(e)}static min(){return new O(new V(0,0))}static max(){return new O(new V(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class q{constructor(e,t,n){void 0===t?t=0:t>e.length&&g(),void 0===n?n=e.length-t:n>e.length-t&&g(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===q.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof q?e.forEach(e=>{t.push(e)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=e.get(r),s=t.get(r);if(n<s)return-1;if(n>s)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class U extends q{construct(e,t,n){return new U(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new _(I.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter(e=>e.length>0))}return new U(t)}static emptyPath(){return new U([])}}const B=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class z extends q{construct(e,t,n){return new z(e,t,n)}static isValidIdentifier(e){return B.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),z.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new z(["__name__"])}static fromServerFormat(e){const t=[];let n="",r=0;const s=()=>{if(0===n.length)throw new _(I.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let i=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new _(I.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new _(I.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(i=!i,r++):"."!==t||i?(n+=t,r++):(s(),r++)}if(s(),i)throw new _(I.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new z(t)}static emptyPath(){return new z([])}}exports._FieldPath=z;class G{constructor(e){this.path=e}static fromPath(e){return new G(U.fromString(e))}static fromName(e){return new G(U.fromString(e).popFirst(5))}static empty(){return new G(U.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===U.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return U.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new G(new U(e.slice()))}}exports._DocumentKey=G;class K{constructor(e,t,n,r){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=r}}function $(e){return e.fields.find(e=>2===e.kind)}function Q(e){return e.fields.filter(e=>2!==e.kind)}function j(e,t){let n=F(e.collectionGroup,t.collectionGroup);if(0!==n)return n;for(let r=0;r<Math.min(e.fields.length,t.fields.length);++r)if(0!==(n=H(e.fields[r],t.fields[r])))return n;return F(e.fields.length,t.fields.length)}K.UNKNOWN_ID=-1;class W{constructor(e,t){this.fieldPath=e,this.kind=t}}function H(e,t){const n=z.comparator(e.fieldPath,t.fieldPath);return 0!==n?n:F(e.kind,t.kind)}class Y{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Y(0,Z.min())}}function J(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,s=O.fromTimestamp(1e9===r?new V(n+1,0):new V(n,r));return new Z(s,G.empty(),t)}function X(e){return new Z(e.readTime,e.key,-1)}class Z{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new Z(O.min(),G.empty(),-1)}static max(){return new Z(O.max(),G.empty(),-1)}}function ee(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:0!==(n=G.comparator(e.documentKey,t.documentKey))?n:F(e.largestBatchId,t.largestBatchId)}const te="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class ne{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}async function re(e){if(e.code!==I.FAILED_PRECONDITION||e.message!==te)throw e;d("LocalStore","Unexpectedly lost primary lease")}class se{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&g(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new se((n,r)=>{this.nextCallback=(t=>{this.wrapSuccess(e,t).next(n,r)}),this.catchCallback=(e=>{this.wrapFailure(t,e).next(n,r)})})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof se?t:se.resolve(t)}catch(e){return se.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):se.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):se.reject(t)}static resolve(e){return new se((t,n)=>{t(e)})}static reject(e){return new se((t,n)=>{n(e)})}static waitFor(e){return new se((t,n)=>{let r=0,s=0,i=!1;e.forEach(e=>{++r,e.next(()=>{++s,i&&s===r&&t()},e=>n(e))}),i=!0,s===r&&t()})}static or(e){let t=se.resolve(!1);for(const n of e)t=t.next(e=>e?se.resolve(e):n());return t}static forEach(e,t){const n=[];return e.forEach((e,r)=>{n.push(t.call(this,e,r))}),this.waitFor(n)}static mapArray(e,t){return new se((n,r)=>{const s=e.length,i=new Array(s);let o=0;for(let a=0;a<s;a++){const c=a;t(e[c]).next(e=>{i[c]=e,++o===s&&n(i)},e=>r(e))}})}static doWhile(e,t){return new se((n,r)=>{const s=()=>{!0===e()?t().next(()=>{s()},r):n()};s()})}}class ie{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new b,this.transaction.oncomplete=(()=>{this.V.resolve()}),this.transaction.onabort=(()=>{t.error?this.V.reject(new ce(e,t.error)):this.V.resolve()}),this.transaction.onerror=(t=>{const n=fe(t.target.error);this.V.reject(new ce(e,n))})}static open(e,t,n,r){try{return new ie(t,e.transaction(r,n))}catch(e){throw new ce(t,e)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(d("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const t=this.transaction.objectStore(e);return new le(t)}}class oe{constructor(e,t,n){this.name=e,this.version=t,this.p=n,12.2===oe.S((0,s.getUA)())&&f("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return d("SimpleDb","Removing database:",e),he(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!(0,s.isIndexedDBAvailable)())return!1;if(oe.C())return!0;const e=(0,s.getUA)(),t=oe.S(e),n=0<t&&t<10,r=oe.v(e),i=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||i)}static C(){var t;return void 0!==e&&"YES"===(null===(t=e.__PRIVATE_env)||void 0===t?void 0:t.F)}static M(e,t){return e.store(t)}static S(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}static v(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}async O(e){return this.db||(d("SimpleDb","Opening database:",this.name),this.db=await new Promise((t,n)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=(e=>{const n=e.target.result;t(n)}),r.onblocked=(()=>{n(new ce(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))}),r.onerror=(t=>{const r=t.target.error;"VersionError"===r.name?n(new _(I.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===r.name?n(new _(I.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+r)):n(new ce(e,r))}),r.onupgradeneeded=(e=>{d("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',e.oldVersion);const t=e.target.result;this.p.N(t,r.transaction,e.oldVersion,this.version).next(()=>{d("SimpleDb","Database upgrade to version "+this.version+" complete")})})})),this.B&&(this.db.onversionchange=(e=>this.B(e))),this.db}L(e){this.B=e,this.db&&(this.db.onversionchange=(t=>e(t)))}async runTransaction(e,t,n,r){const s="readonly"===t;for(;;){0;try{this.db=await this.O(e);const t=ie.open(this.db,e,s?"readonly":"readwrite",n),i=r(t).next(e=>(t.g(),e)).catch(e=>(t.abort(e),se.reject(e))).toPromise();return i.catch(()=>{}),await t.m,i}catch(e){const t=e,n="FirebaseError"!==t.name&&i<3;if(d("SimpleDb","Transaction failed with error:",t.message,"Retrying:",n),this.close(),!n)return Promise.reject(t)}}}close(){this.db&&this.db.close(),this.db=void 0}}class ae{constructor(e){this.k=e,this.q=!1,this.K=null}get isDone(){return this.q}get $(){return this.K}set cursor(e){this.k=e}done(){this.q=!0}U(e){this.K=e}delete(){return he(this.k.delete())}}class ce extends _{constructor(e,t){super(I.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function ue(e){return"IndexedDbTransactionError"===e.name}class le{constructor(e){this.store=e}put(e,t){let n;return void 0!==t?(d("SimpleDb","PUT",this.store.name,e,t),n=this.store.put(t,e)):(d("SimpleDb","PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),he(n)}add(e){return d("SimpleDb","ADD",this.store.name,e,e),he(this.store.add(e))}get(e){return he(this.store.get(e)).next(t=>(void 0===t&&(t=null),d("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return d("SimpleDb","DELETE",this.store.name,e),he(this.store.delete(e))}count(){return d("SimpleDb","COUNT",this.store.name),he(this.store.count())}W(e,t){const n=this.options(e,t),r=n.index?this.store.index(n.index):this.store;if("function"==typeof r.getAll){const e=r.getAll(n.range);return new se((t,n)=>{e.onerror=(e=>{n(e.target.error)}),e.onsuccess=(e=>{t(e.target.result)})})}{const e=this.cursor(n),t=[];return this.G(e,(e,n)=>{t.push(n)}).next(()=>t)}}j(e,t){const n=this.store.getAll(e,null===t?void 0:t);return new se((e,t)=>{n.onerror=(e=>{t(e.target.error)}),n.onsuccess=(t=>{e(t.target.result)})})}H(e,t){d("SimpleDb","DELETE ALL",this.store.name);const n=this.options(e,t);n.J=!1;const r=this.cursor(n);return this.G(r,(e,t,n)=>n.delete())}Y(e,t){let n;t?n=e:(n={},t=e);const r=this.cursor(n);return this.G(r,t)}Z(e){const t=this.cursor({});return new se((n,r)=>{t.onerror=(e=>{const t=fe(e.target.error);r(t)}),t.onsuccess=(t=>{const r=t.target.result;r?e(r.primaryKey,r.value).next(e=>{e?r.continue():n()}):n()})})}G(e,t){const n=[];return new se((r,s)=>{e.onerror=(e=>{s(e.target.error)}),e.onsuccess=(e=>{const s=e.target.result;if(!s)return void r();const i=new ae(s),o=t(s.primaryKey,s.value,i);if(o instanceof se){const e=o.catch(e=>(i.done(),se.reject(e)));n.push(e)}i.isDone?r():null===i.$?s.continue():s.continue(i.$)})}).next(()=>se.waitFor(n))}options(e,t){let n;return void 0!==e&&("string"==typeof e?n=e:t=e),{index:n,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const n=this.store.index(e.index);return e.J?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function he(e){return new se((t,n)=>{e.onsuccess=(e=>{const n=e.target.result;t(n)}),e.onerror=(e=>{const t=fe(e.target.error);n(t)})})}let de=!1;function fe(e){const t=oe.S((0,s.getUA)());if(t>=12.2&&t<13){const t="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(t)>=0){const e=new _("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return de||(de=!0,setTimeout(()=>{throw e},0)),e}}return e}class me{constructor(e,t){this.asyncQueue=e,this.X=t,this.task=null}start(){this.ee(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}ee(e){d("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{d("IndexBackfiller",`Documents written: ${await this.X.te()}`)}catch(e){ue(e)?d("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",e):await re(e)}await this.ee(6e4)})}}class pe{constructor(e,t){this.localStore=e,this.persistence=t}async te(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.ne(t,e))}ne(e,t){const n=new Set;let r=t,s=!0;return se.doWhile(()=>!0===s&&r>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(t=>{if(null!==t&&!n.has(t))return d("IndexBackfiller",`Processing collection: ${t}`),this.re(e,t,r).next(e=>{r-=e,n.add(t)});s=!1})).next(()=>t-r)}re(e,t,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(r=>this.localStore.localDocuments.getNextDocuments(e,t,r,n).next(n=>{const s=n.changes;return this.localStore.indexManager.updateIndexEntries(e,s).next(()=>this.ie(r,n)).next(n=>(d("IndexBackfiller",`Updating offset: ${n}`),this.localStore.indexManager.updateCollectionGroup(e,t,n))).next(()=>s.size)}))}ie(e,t){let n=e;return t.changes.forEach((e,t)=>{const r=X(t);ee(r,n)>0&&(n=r)}),new Z(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}}class ge{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=(e=>this.se(e)),this.oe=(e=>t.writeSequenceNumber(e)))}se(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.oe&&this.oe(e),e}}function ye(e){return null==e}function we(e){return 0===e&&1/e==-1/0}function ve(e){return"number"==typeof e&&Number.isInteger(e)&&!we(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}function Ie(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=be(t)),t=_e(e.get(n),t);return be(t)}function _e(e,t){let n=t;const r=e.length;for(let s=0;s<r;s++){const t=e.charAt(s);switch(t){case"\0":n+="";break;case"":n+="";break;default:n+=t}}return n}function be(e){return e+""}function Ee(e){const t=e.length;if(y(t>=2),2===t)return y(""===e.charAt(0)&&""===e.charAt(1)),U.emptyPath();const n=t-2,r=[];let s="";for(let i=0;i<t;){const t=e.indexOf("",i);switch((t<0||t>n)&&g(),e.charAt(t+1)){case"":const o=e.substring(i,t);let a;0===s.length?a=o:(a=s+=o,s=""),r.push(a);break;case"":s+=e.substring(i,t),s+="\0";break;case"":s+=e.substring(i,t+1);break;default:g()}i=t+2}return new U(r)}ge._e=-1;const xe=["userId","batchId"];function Te(e,t){return[e,Ie(t)]}function Se(e,t,n){return[e,Ie(t),n]}const Ce={},De=["prefixPath","collectionGroup","readTime","documentId"],Ne=["prefixPath","collectionGroup","documentId"],Ae=["collectionGroup","readTime","prefixPath","documentId"],ke=["canonicalId","targetId"],Me=["targetId","path"],Le=["path","targetId"],Fe=["collectionId","parent"],Re=["indexId","uid"],Pe=["uid","sequenceNumber"],Ve=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Oe=["indexId","uid","orderedDocumentKey"],qe=["userId","collectionPath","documentId"],Ue=["userId","collectionPath","largestBatchId"],Be=["userId","collectionGroup","largestBatchId"],ze=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],Ge=[...ze,"documentOverlays"],Ke=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],$e=Ke,Qe=[...$e,"indexConfiguration","indexState","indexEntries"];class je extends ne{constructor(e,t){super(),this.ae=e,this.currentSequenceNumber=t}}function We(e,t){const n=v(e);return oe.M(n.ae,t)}function He(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function Ye(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function Je(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class Xe{constructor(e,t){this.comparator=e,this.root=t||et.EMPTY}insert(e,t){return new Xe(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,et.BLACK,null,null))}remove(e){return new Xe(this.comparator,this.root.remove(e,this.comparator).copy(null,null,et.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ze(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ze(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ze(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ze(this.root,e,this.comparator,!0)}}class Ze{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?n(e.key,t):1,t&&r&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(0===s){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class et{constructor(e,t,n,r,s){this.key=e,this.value=t,this.color=null!=n?n:et.RED,this.left=null!=r?r:et.EMPTY,this.right=null!=s?s:et.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,s){return new et(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=s?s:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const s=n(e,r.key);return(r=s<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===s?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n))).fixUp()}removeMin(){if(this.left.isEmpty())return et.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return et.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight())).rotateLeft()).colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=(e=e.rotateRight()).colorFlip()),e}rotateLeft(){const e=this.copy(null,null,et.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,et.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw g();if(this.right.isRed())throw g();const e=this.left.check();if(e!==this.right.check())throw g();return e+(this.isRed()?0:1)}}et.EMPTY=null,et.RED=!0,et.BLACK=!1,et.EMPTY=new class{constructor(){this.size=0}get key(){throw g()}get value(){throw g()}get color(){throw g()}get left(){throw g()}get right(){throw g()}copy(e,t,n,r,s){return this}insert(e,t,n){return new et(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class tt{constructor(e){this.comparator=e,this.data=new Xe(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new nt(this.data.getIterator())}getIteratorFrom(e){return new nt(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(e=>{t=t.add(e)}),t}isEqual(e){if(!(e instanceof tt))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new tt(this.comparator);return t.data=e,t}}class nt{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function rt(e){return e.hasNext()?e.getNext():void 0}class st{constructor(e){this.fields=e,e.sort(z.comparator)}static empty(){return new st([])}unionWith(e){let t=new tt(z.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new st(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return R(this.fields,e.fields,(e,t)=>e.isEqual(t))}}class it extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}function ot(){return"undefined"!=typeof atob}class at{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new it("Invalid base64 string: "+e):e}}(e);return new at(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new at(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return F(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}exports._ByteString=at,at.EMPTY_BYTE_STRING=new at("");const ct=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ut(e){if(y(!!e),"string"==typeof e){let t=0;const n=ct.exec(e);if(y(!!n),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:lt(e.seconds),nanos:lt(e.nanos)}}function lt(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function ht(e){return"string"==typeof e?at.fromBase64String(e):at.fromUint8Array(e)}function dt(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function ft(e){const t=e.mapValue.fields.__previous_value__;return dt(t)?ft(t):t}function mt(e){const t=ut(e.mapValue.fields.__local_write_time__.timestampValue);return new V(t.seconds,t.nanos)}class pt{constructor(e,t,n,r,s,i,o,a,c){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=s,this.forceLongPolling=i,this.autoDetectLongPolling=o,this.longPollingOptions=a,this.useFetchStreams=c}}class gt{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new gt("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof gt&&e.projectId===this.projectId&&e.database===this.database}}exports._DatabaseId=gt;const yt={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},wt={nullValue:"NULL_VALUE"};function vt(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?dt(e)?4:Ft(e)?9007199254740991:10:g()}function It(e,t){if(e===t)return!0;const n=vt(e);if(n!==vt(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return mt(e).isEqual(mt(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=ut(e.timestampValue),r=ut(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return ht(e.bytesValue).isEqual(ht(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return lt(e.geoPointValue.latitude)===lt(t.geoPointValue.latitude)&&lt(e.geoPointValue.longitude)===lt(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return lt(e.integerValue)===lt(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=lt(e.doubleValue),r=lt(t.doubleValue);return n===r?we(n)===we(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return R(e.arrayValue.values||[],t.arrayValue.values||[],It);case 10:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(He(n)!==He(r))return!1;for(const s in n)if(n.hasOwnProperty(s)&&(void 0===r[s]||!It(n[s],r[s])))return!1;return!0}(e,t);default:return g()}}function _t(e,t){return void 0!==(e.values||[]).find(e=>It(e,t))}function bt(e,t){if(e===t)return 0;const n=vt(e),r=vt(t);if(n!==r)return F(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return F(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=lt(e.integerValue||e.doubleValue),r=lt(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return Et(e.timestampValue,t.timestampValue);case 4:return Et(mt(e),mt(t));case 5:return F(e.stringValue,t.stringValue);case 6:return function(e,t){const n=ht(e),r=ht(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let s=0;s<n.length&&s<r.length;s++){const e=F(n[s],r[s]);if(0!==e)return e}return F(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=F(lt(e.latitude),lt(t.latitude));return 0!==n?n:F(lt(e.longitude),lt(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){const n=e.values||[],r=t.values||[];for(let s=0;s<n.length&&s<r.length;++s){const e=bt(n[s],r[s]);if(e)return e}return F(n.length,r.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){if(e===yt.mapValue&&t===yt.mapValue)return 0;if(e===yt.mapValue)return 1;if(t===yt.mapValue)return-1;const n=e.fields||{},r=Object.keys(n),s=t.fields||{},i=Object.keys(s);r.sort(),i.sort();for(let o=0;o<r.length&&o<i.length;++o){const e=F(r[o],i[o]);if(0!==e)return e;const t=bt(n[r[o]],s[i[o]]);if(0!==t)return t}return F(r.length,i.length)}(e.mapValue,t.mapValue);default:throw g()}}function Et(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return F(e,t);const n=ut(e),r=ut(t),s=F(n.seconds,r.seconds);return 0!==s?s:F(n.nanos,r.nanos)}function xt(e){return Tt(e)}function Tt(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=ut(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(e){return ht(e).toBase64()}(e.bytesValue):"referenceValue"in e?function(e){return G.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return`geo(${e.latitude},${e.longitude})`}(e.geoPointValue):"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=Tt(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const s of t)r?r=!1:n+=",",n+=`${s}:${Tt(e.fields[s])}`;return n+"}"}(e.mapValue):g()}function St(e){switch(vt(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=ft(e);return t?16+St(t):16;case 5:return 2*e.stringValue.length;case 6:return ht(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return function(e){return(e.values||[]).reduce((e,t)=>e+St(t),0)}(e.arrayValue);case 10:return function(e){let t=0;return Ye(e.fields,(e,n)=>{t+=e.length+St(n)}),t}(e.mapValue);default:throw g()}}function Ct(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function Dt(e){return!!e&&"integerValue"in e}function Nt(e){return!!e&&"arrayValue"in e}function At(e){return!!e&&"nullValue"in e}function kt(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function Mt(e){return!!e&&"mapValue"in e}function Lt(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return Ye(e.mapValue.fields,(e,n)=>t.mapValue.fields[e]=Lt(n)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=Lt(e.arrayValue.values[n]);return t}return Object.assign({},e)}function Ft(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}function Rt(e){return"nullValue"in e?wt:"booleanValue"in e?{booleanValue:!1}:"integerValue"in e||"doubleValue"in e?{doubleValue:NaN}:"timestampValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in e?{stringValue:""}:"bytesValue"in e?{bytesValue:""}:"referenceValue"in e?Ct(gt.empty(),G.empty()):"geoPointValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in e?{arrayValue:{}}:"mapValue"in e?{mapValue:{}}:g()}function Pt(e){return"nullValue"in e?{booleanValue:!1}:"booleanValue"in e?{doubleValue:NaN}:"integerValue"in e||"doubleValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in e?{stringValue:""}:"stringValue"in e?{bytesValue:""}:"bytesValue"in e?Ct(gt.empty(),G.empty()):"referenceValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in e?{arrayValue:{}}:"arrayValue"in e?{mapValue:{}}:"mapValue"in e?yt:g()}function Vt(e,t){const n=bt(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?-1:!e.inclusive&&t.inclusive?1:0}function Ot(e,t){const n=bt(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?1:!e.inclusive&&t.inclusive?-1:0}class qt{constructor(e){this.value=e}static empty(){return new qt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(!Mt(t=(t.mapValue.fields||{})[e.get(n)]))return null;return(t=(t.mapValue.fields||{})[e.lastSegment()])||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Lt(t)}setAll(e){let t=z.emptyPath(),n={},r=[];e.forEach((e,s)=>{if(!t.isImmediateParentOf(s)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=s.popLast()}e?n[s.lastSegment()]=Lt(e):r.push(s.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,n,r)}delete(e){const t=this.field(e.popLast());Mt(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return It(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];Mt(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){Ye(t,(t,n)=>e[t]=n);for(const r of n)delete e[r]}clone(){return new qt(Lt(this.value))}}function Ut(e){const t=[];return Ye(e.fields,(e,n)=>{const r=new z([e]);if(Mt(n)){const e=Ut(n.mapValue).fields;if(0===e.length)t.push(r);else for(const n of e)t.push(r.child(n))}else t.push(r)}),new st(t)}class Bt{constructor(e,t,n,r,s,i,o){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=s,this.data=i,this.documentState=o}static newInvalidDocument(e){return new Bt(e,0,O.min(),O.min(),O.min(),qt.empty(),0)}static newFoundDocument(e,t,n,r){return new Bt(e,1,t,O.min(),n,r,0)}static newNoDocument(e,t){return new Bt(e,2,t,O.min(),O.min(),qt.empty(),0)}static newUnknownDocument(e,t){return new Bt(e,3,t,O.min(),O.min(),qt.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(O.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=qt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=qt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=O.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof Bt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Bt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class zt{constructor(e,t){this.position=e,this.inclusive=t}}function Gt(e,t,n){let r=0;for(let s=0;s<e.position.length;s++){const i=t[s],o=e.position[s];if(r=i.field.isKeyField()?G.comparator(G.fromName(o.referenceValue),n.key):bt(o,n.data.field(i.field)),"desc"===i.dir&&(r*=-1),0!==r)break}return r}function Kt(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!It(e.position[n],t.position[n]))return!1;return!0}class $t{constructor(e,t="asc"){this.field=e,this.dir=t}}function Qt(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class jt{}class Wt extends jt{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new sn(e,t,n):"array-contains"===t?new un(e,n):"in"===t?new ln(e,n):"not-in"===t?new hn(e,n):"array-contains-any"===t?new dn(e,n):new Wt(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new on(e,n):new an(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(bt(t,this.value)):null!==t&&vt(this.value)===vt(t)&&this.matchesComparison(bt(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return g()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Ht extends jt{constructor(e,t){super(),this.filters=e,this.op=t,this.ue=null}static create(e,t){return new Ht(e,t)}matches(e){return Yt(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.ue||(this.ue=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ue}getFilters(){return Object.assign([],this.filters)}}function Yt(e){return"and"===e.op}function Jt(e){return"or"===e.op}function Xt(e){return Zt(e)&&Yt(e)}function Zt(e){for(const t of e.filters)if(t instanceof Ht)return!1;return!0}function en(e){if(e instanceof Wt)return e.field.canonicalString()+e.op.toString()+xt(e.value);if(Xt(e))return e.filters.map(e=>en(e)).join(",");{const t=e.filters.map(e=>en(e)).join(",");return`${e.op}(${t})`}}function tn(e,t){return e instanceof Wt?function(e,t){return t instanceof Wt&&e.op===t.op&&e.field.isEqual(t.field)&&It(e.value,t.value)}(e,t):e instanceof Ht?function(e,t){return t instanceof Ht&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce((e,n,r)=>e&&tn(n,t.filters[r]),!0)}(e,t):void g()}function nn(e,t){const n=e.filters.concat(t);return Ht.create(n,e.op)}function rn(e){return e instanceof Wt?function(e){return`${e.field.canonicalString()} ${e.op} ${xt(e.value)}`}(e):e instanceof Ht?function(e){return e.op.toString()+" {"+e.getFilters().map(rn).join(" ,")+"}"}(e):"Filter"}class sn extends Wt{constructor(e,t,n){super(e,t,n),this.key=G.fromName(n.referenceValue)}matches(e){const t=G.comparator(e.key,this.key);return this.matchesComparison(t)}}class on extends Wt{constructor(e,t){super(e,"in",t),this.keys=cn("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class an extends Wt{constructor(e,t){super(e,"not-in",t),this.keys=cn("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function cn(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map(e=>G.fromName(e.referenceValue))}class un extends Wt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Nt(t)&&_t(t.arrayValue,this.value)}}class ln extends Wt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&_t(this.value.arrayValue,t)}}class hn extends Wt{constructor(e,t){super(e,"not-in",t)}matches(e){if(_t(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!_t(this.value.arrayValue,t)}}class dn extends Wt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Nt(t)||!t.arrayValue.values)&&t.arrayValue.values.some(e=>_t(this.value.arrayValue,e))}}class fn{constructor(e,t=null,n=[],r=[],s=null,i=null,o=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=s,this.startAt=i,this.endAt=o,this.ce=null}}function mn(e,t=null,n=[],r=[],s=null,i=null,o=null){return new fn(e,t,n,r,s,i,o)}function pn(e){const t=v(e);if(null===t.ce){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(e=>en(e)).join(","),e+="|ob:",e+=t.orderBy.map(e=>(function(e){return e.field.canonicalString()+e.dir})(e)).join(","),ye(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(e=>xt(e)).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(e=>xt(e)).join(",")),t.ce=e}return t.ce}function gn(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!Qt(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!tn(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!Kt(e.startAt,t.startAt)&&Kt(e.endAt,t.endAt)}function yn(e){return G.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}function wn(e,t){return e.filters.filter(e=>e instanceof Wt&&e.field.isEqual(t))}function vn(e,t,n){let r=wt,s=!0;for(const i of wn(e,t)){let e=wt,t=!0;switch(i.op){case"<":case"<=":e=Rt(i.value);break;case"==":case"in":case">=":e=i.value;break;case">":e=i.value,t=!1;break;case"!=":case"not-in":e=wt}Vt({value:r,inclusive:s},{value:e,inclusive:t})<0&&(r=e,s=t)}if(null!==n)for(let i=0;i<e.orderBy.length;++i)if(e.orderBy[i].field.isEqual(t)){const e=n.position[i];Vt({value:r,inclusive:s},{value:e,inclusive:n.inclusive})<0&&(r=e,s=n.inclusive);break}return{value:r,inclusive:s}}function In(e,t,n){let r=yt,s=!0;for(const i of wn(e,t)){let e=yt,t=!0;switch(i.op){case">=":case">":e=Pt(i.value),t=!1;break;case"==":case"in":case"<=":e=i.value;break;case"<":e=i.value,t=!1;break;case"!=":case"not-in":e=yt}Ot({value:r,inclusive:s},{value:e,inclusive:t})>0&&(r=e,s=t)}if(null!==n)for(let i=0;i<e.orderBy.length;++i)if(e.orderBy[i].field.isEqual(t)){const e=n.position[i];Ot({value:r,inclusive:s},{value:e,inclusive:n.inclusive})>0&&(r=e,s=n.inclusive);break}return{value:r,inclusive:s}}class _n{constructor(e,t=null,n=[],r=[],s=null,i="F",o=null,a=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=s,this.limitType=i,this.startAt=o,this.endAt=a,this.le=null,this.he=null,this.Pe=null,this.startAt,this.endAt}}function bn(e,t,n,r,s,i,o,a){return new _n(e,t,n,r,s,i,o,a)}function En(e){return new _n(e)}function xn(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function Tn(e){return null!==e.collectionGroup}function Sn(e){const t=v(e);if(null===t.le){t.le=[];const e=new Set;for(const r of t.explicitOrderBy)t.le.push(r),e.add(r.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(e){let t=new tt(z.comparator);return e.filters.forEach(e=>{e.getFlattenedFilters().forEach(e=>{e.isInequality()&&(t=t.add(e.field))})}),t})(t).forEach(r=>{e.has(r.canonicalString())||r.isKeyField()||t.le.push(new $t(r,n))}),e.has(z.keyField().canonicalString())||t.le.push(new $t(z.keyField(),n))}return t.le}function Cn(e){const t=v(e);return t.he||(t.he=Dn(t,Sn(e))),t.he}function Dn(e,t){if("F"===e.limitType)return mn(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(e=>{const t="desc"===e.dir?"asc":"desc";return new $t(e.field,t)});const n=e.endAt?new zt(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new zt(e.startAt.position,e.startAt.inclusive):null;return mn(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}function Nn(e,t){const n=e.filters.concat([t]);return new _n(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function An(e,t,n){return new _n(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function kn(e,t){return gn(Cn(e),Cn(t))&&e.limitType===t.limitType}function Mn(e){return`${pn(Cn(e))}|lt:${e.limitType}`}function Ln(e){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map(e=>rn(e)).join(", ")}]`),ye(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map(e=>(function(e){return`${e.field.canonicalString()} (${e.dir})`})(e)).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(e=>xt(e)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(e=>xt(e)).join(",")),`Target(${t})`}(Cn(e))}; limitType=${e.limitType})`}function Fn(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):G.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of Sn(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const r=Gt(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,Sn(e),t))&&!(e.endAt&&!function(e,t,n){const r=Gt(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,Sn(e),t))}(e,t)}function Rn(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function Pn(e){return(t,n)=>{let r=!1;for(const s of Sn(e)){const e=Vn(s,t,n);if(0!==e)return e;r=r||s.field.isKeyField()}return 0}}function Vn(e,t,n){const r=e.field.isKeyField()?G.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),s=n.data.field(e);return null!==r&&null!==s?bt(r,s):g()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return g()}}class On{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[r,s]of n)if(this.equalsFn(r,e))return s}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return void(r[s]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Ye(this.inner,(t,n)=>{for(const[r,s]of n)e(r,s)})}isEmpty(){return Je(this.inner)}size(){return this.innerSize}}const qn=new Xe(G.comparator);function Un(){return qn}const Bn=new Xe(G.comparator);function zn(...e){let t=Bn;for(const n of e)t=t.insert(n.key,n);return t}function Gn(e){let t=Bn;return e.forEach((e,n)=>t=t.insert(e,n.overlayedDocument)),t}function Kn(){return Qn()}function $n(){return Qn()}function Qn(){return new On(e=>e.toString(),(e,t)=>e.isEqual(t))}const jn=new Xe(G.comparator),Wn=new tt(G.comparator);function Hn(...e){let t=Wn;for(const n of e)t=t.add(n);return t}const Yn=new tt(F);function Jn(){return Yn}function Xn(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:we(t)?"-0":t}}function Zn(e){return{integerValue:""+e}}function er(e,t){return ve(t)?Zn(t):Xn(e,t)}class tr{constructor(){this._=void 0}}function nr(e,t,n){return e instanceof ir?function(e,t){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&dt(t)&&(t=ft(t)),t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof or?ar(e,t):e instanceof cr?ur(e,t):function(e,t){const n=sr(e,t),r=hr(n)+hr(e.Ie);return Dt(n)&&Dt(e.Ie)?Zn(r):Xn(e.serializer,r)}(e,t)}function rr(e,t,n){return e instanceof or?ar(e,t):e instanceof cr?ur(e,t):n}function sr(e,t){return e instanceof lr?function(e){return Dt(e)||function(e){return!!e&&"doubleValue"in e}(e)}(t)?t:{integerValue:0}:null}class ir extends tr{}class or extends tr{constructor(e){super(),this.elements=e}}function ar(e,t){const n=dr(t);for(const r of e.elements)n.some(e=>It(e,r))||n.push(r);return{arrayValue:{values:n}}}class cr extends tr{constructor(e){super(),this.elements=e}}function ur(e,t){let n=dr(t);for(const r of e.elements)n=n.filter(e=>!It(e,r));return{arrayValue:{values:n}}}class lr extends tr{constructor(e,t){super(),this.serializer=e,this.Ie=t}}function hr(e){return lt(e.integerValue||e.doubleValue)}function dr(e){return Nt(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class fr{constructor(e,t){this.field=e,this.transform=t}}function mr(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof or&&t instanceof or||e instanceof cr&&t instanceof cr?R(e.elements,t.elements,It):e instanceof lr&&t instanceof lr?It(e.Ie,t.Ie):e instanceof ir&&t instanceof ir}(e.transform,t.transform)}class pr{constructor(e,t){this.version=e,this.transformResults=t}}class gr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new gr}static exists(e){return new gr(void 0,e)}static updateTime(e){return new gr(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function yr(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class wr{}function vr(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new Nr(e.key,gr.none()):new xr(e.key,e.data,gr.none());{const n=e.data,r=qt.empty();let s=new tt(z.comparator);for(let e of t.fields)if(!s.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?r.delete(e):r.set(e,t),s=s.add(e)}return new Tr(e.key,r,new st(s.toArray()),gr.none())}}function Ir(e,t,n){e instanceof xr?function(e,t,n){const r=e.value.clone(),s=Cr(e.fieldTransforms,t,n.transformResults);r.setAll(s),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof Tr?function(e,t,n){if(!yr(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=Cr(e.fieldTransforms,t,n.transformResults),s=t.data;s.setAll(Sr(e)),s.setAll(r),t.convertToFoundDocument(n.version,s).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function _r(e,t,n,r){return e instanceof xr?function(e,t,n,r){if(!yr(e.precondition,t))return n;const s=e.value.clone(),i=Dr(e.fieldTransforms,r,t);return s.setAll(i),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null}(e,t,n,r):e instanceof Tr?function(e,t,n,r){if(!yr(e.precondition,t))return n;const s=Dr(e.fieldTransforms,r,t),i=t.data;return i.setAll(Sr(e)),i.setAll(s),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map(e=>e.field))}(e,t,n,r):function(e,t,n){return yr(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function br(e,t){let n=null;for(const r of e.fieldTransforms){const e=t.data.field(r.field),s=sr(r.transform,e||null);null!=s&&(null===n&&(n=qt.empty()),n.set(r.field,s))}return n||null}function Er(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&R(e,t,(e,t)=>mr(e,t))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class xr extends wr{constructor(e,t,n,r=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Tr extends wr{constructor(e,t,n,r,s=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function Sr(e){const t=new Map;return e.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}}),t}function Cr(e,t,n){const r=new Map;y(e.length===n.length);for(let s=0;s<n.length;s++){const i=e[s],o=i.transform,a=t.data.field(i.field);r.set(i.field,rr(o,a,n[s]))}return r}function Dr(e,t,n){const r=new Map;for(const s of e){const e=s.transform,i=n.data.field(s.field);r.set(s.field,nr(e,i,t))}return r}class Nr extends wr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Ar extends wr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class kr{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const t=this.mutations[r];t.key.isEqual(e.key)&&Ir(t,e,n[r])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=_r(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=_r(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=$n();return this.mutations.forEach(r=>{const s=e.get(r.key),i=s.overlayedDocument;let o=this.applyToLocalView(i,s.mutatedFields);const a=vr(i,o=t.has(r.key)?null:o);null!==a&&n.set(r.key,a),i.isValidDocument()||i.convertToNoDocument(O.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Hn())}isEqual(e){return this.batchId===e.batchId&&R(this.mutations,e.mutations,(e,t)=>Er(e,t))&&R(this.baseMutations,e.baseMutations,(e,t)=>Er(e,t))}}class Mr{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){y(e.mutations.length===n.length);let r=jn;const s=e.mutations;for(let i=0;i<s.length;i++)r=r.insert(s[i].key,n[i].version);return new Mr(e,t,n,r)}}class Lr{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class Fr{constructor(e,t,n){this.alias=e,this.aggregateType=t,this.fieldPath=n}}class Rr{constructor(e,t){this.count=e,this.unchangedNames=t}}var Pr,Vr;function Or(e){switch(e){default:return g();case I.CANCELLED:case I.UNKNOWN:case I.DEADLINE_EXCEEDED:case I.RESOURCE_EXHAUSTED:case I.INTERNAL:case I.UNAVAILABLE:case I.UNAUTHENTICATED:return!1;case I.INVALID_ARGUMENT:case I.NOT_FOUND:case I.ALREADY_EXISTS:case I.PERMISSION_DENIED:case I.FAILED_PRECONDITION:case I.ABORTED:case I.OUT_OF_RANGE:case I.UNIMPLEMENTED:case I.DATA_LOSS:return!0}}function qr(e){if(void 0===e)return f("GRPC error has no .code"),I.UNKNOWN;switch(e){case Pr.OK:return I.OK;case Pr.CANCELLED:return I.CANCELLED;case Pr.UNKNOWN:return I.UNKNOWN;case Pr.DEADLINE_EXCEEDED:return I.DEADLINE_EXCEEDED;case Pr.RESOURCE_EXHAUSTED:return I.RESOURCE_EXHAUSTED;case Pr.INTERNAL:return I.INTERNAL;case Pr.UNAVAILABLE:return I.UNAVAILABLE;case Pr.UNAUTHENTICATED:return I.UNAUTHENTICATED;case Pr.INVALID_ARGUMENT:return I.INVALID_ARGUMENT;case Pr.NOT_FOUND:return I.NOT_FOUND;case Pr.ALREADY_EXISTS:return I.ALREADY_EXISTS;case Pr.PERMISSION_DENIED:return I.PERMISSION_DENIED;case Pr.FAILED_PRECONDITION:return I.FAILED_PRECONDITION;case Pr.ABORTED:return I.ABORTED;case Pr.OUT_OF_RANGE:return I.OUT_OF_RANGE;case Pr.UNIMPLEMENTED:return I.UNIMPLEMENTED;case Pr.DATA_LOSS:return I.DATA_LOSS;default:return g()}}(Vr=Pr||(Pr={}))[Vr.OK=0]="OK",Vr[Vr.CANCELLED=1]="CANCELLED",Vr[Vr.UNKNOWN=2]="UNKNOWN",Vr[Vr.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Vr[Vr.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Vr[Vr.NOT_FOUND=5]="NOT_FOUND",Vr[Vr.ALREADY_EXISTS=6]="ALREADY_EXISTS",Vr[Vr.PERMISSION_DENIED=7]="PERMISSION_DENIED",Vr[Vr.UNAUTHENTICATED=16]="UNAUTHENTICATED",Vr[Vr.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Vr[Vr.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Vr[Vr.ABORTED=10]="ABORTED",Vr[Vr.OUT_OF_RANGE=11]="OUT_OF_RANGE",Vr[Vr.UNIMPLEMENTED=12]="UNIMPLEMENTED",Vr[Vr.INTERNAL=13]="INTERNAL",Vr[Vr.UNAVAILABLE=14]="UNAVAILABLE",Vr[Vr.DATA_LOSS=15]="DATA_LOSS";let Ur=null;function Br(){return new TextEncoder}const zr=new i.Integer([4294967295,4294967295],0);function Gr(e){const t=Br().encode(e),n=new i.Md5;return n.update(t),new Uint8Array(n.digest())}function Kr(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),s=t.getUint32(8,!0),o=t.getUint32(12,!0);return[new i.Integer([n,r],0),new i.Integer([s,o],0)]}class $r{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new Qr(`Invalid padding: ${t}`);if(n<0)throw new Qr(`Invalid hash count: ${n}`);if(e.length>0&&0===this.hashCount)throw new Qr(`Invalid hash count: ${n}`);if(0===e.length&&0!==t)throw new Qr(`Invalid padding when bitmap length is 0: ${t}`);this.Te=8*e.length-t,this.Ee=i.Integer.fromNumber(this.Te)}de(e,t,n){let r=e.add(t.multiply(i.Integer.fromNumber(n)));return 1===r.compare(zr)&&(r=new i.Integer([r.getBits(0),r.getBits(1)],0)),r.modulo(this.Ee).toNumber()}Ae(e){return 0!=(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.Te)return!1;const t=Gr(e),[n,r]=Kr(t);for(let s=0;s<this.hashCount;s++){const e=this.de(n,r,s);if(!this.Ae(e))return!1}return!0}static create(e,t,n){const r=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),i=new $r(s,r,t);return n.forEach(e=>i.insert(e)),i}insert(e){if(0===this.Te)return;const t=Gr(e),[n,r]=Kr(t);for(let s=0;s<this.hashCount;s++){const e=this.de(n,r,s);this.Re(e)}}Re(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class Qr extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class jr{constructor(e,t,n,r,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,Wr.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new jr(O.min(),r,new Xe(F),Un(),Hn())}}class Wr{constructor(e,t,n,r,s){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new Wr(n,t,Hn(),Hn(),Hn())}}class Hr{constructor(e,t,n,r){this.Ve=e,this.removedTargetIds=t,this.key=n,this.me=r}}class Yr{constructor(e,t){this.targetId=e,this.fe=t}}class Jr{constructor(e,t,n=at.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class Xr{constructor(){this.ge=0,this.pe=ts(),this.ye=at.EMPTY_BYTE_STRING,this.we=!1,this.Se=!0}get current(){return this.we}get resumeToken(){return this.ye}get be(){return 0!==this.ge}get De(){return this.Se}Ce(e){e.approximateByteSize()>0&&(this.Se=!0,this.ye=e)}ve(){let e=Hn(),t=Hn(),n=Hn();return this.pe.forEach((r,s)=>{switch(s){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:g()}}),new Wr(this.ye,this.we,e,t,n)}Fe(){this.Se=!1,this.pe=ts()}Me(e,t){this.Se=!0,this.pe=this.pe.insert(e,t)}xe(e){this.Se=!0,this.pe=this.pe.remove(e)}Oe(){this.ge+=1}Ne(){this.ge-=1,y(this.ge>=0)}Be(){this.Se=!0,this.we=!0}}class Zr{constructor(e){this.Le=e,this.ke=new Map,this.qe=Un(),this.Qe=es(),this.Ke=new Xe(F)}$e(e){for(const t of e.Ve)e.me&&e.me.isFoundDocument()?this.Ue(t,e.me):this.We(t,e.key,e.me);for(const t of e.removedTargetIds)this.We(t,e.key,e.me)}Ge(e){this.forEachTarget(e,t=>{const n=this.ze(t);switch(e.state){case 0:this.je(t)&&n.Ce(e.resumeToken);break;case 1:n.Ne(),n.be||n.Fe(),n.Ce(e.resumeToken);break;case 2:n.Ne(),n.be||this.removeTarget(t);break;case 3:this.je(t)&&(n.Be(),n.Ce(e.resumeToken));break;case 4:this.je(t)&&(this.He(t),n.Ce(e.resumeToken));break;default:g()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ke.forEach((e,n)=>{this.je(n)&&t(n)})}Je(e){const t=e.targetId,n=e.fe.count,r=this.Ye(t);if(r){const s=r.target;if(yn(s))if(0===n){const e=new G(s.path);this.We(t,e,Bt.newNoDocument(e,O.min()))}else y(1===n);else{const r=this.Ze(t);if(r!==n){const n=this.Xe(e),s=n?this.et(n,e,r):1;if(0!==s){this.He(t);const e=2===s?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(t,e)}null==Ur||Ur.tt(function(e,t,n,r,s){var i,o,a,c,u,l;const h={localCacheCount:e,existenceFilterCount:t.count,databaseId:n.database,projectId:n.projectId},d=t.unchangedNames;return d&&(h.bloomFilter={applied:0===s,hashCount:null!==(i=null==d?void 0:d.hashCount)&&void 0!==i?i:0,bitmapLength:null!==(c=null===(a=null===(o=null==d?void 0:d.bits)||void 0===o?void 0:o.bitmap)||void 0===a?void 0:a.length)&&void 0!==c?c:0,padding:null!==(l=null===(u=null==d?void 0:d.bits)||void 0===u?void 0:u.padding)&&void 0!==l?l:0,mightContain:e=>{var t;return null!==(t=null==r?void 0:r.mightContain(e))&&void 0!==t&&t}}),h}(r,e.fe,this.Le.nt(),n,s))}}}}Xe(e){const t=e.fe.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:r=0},hashCount:s=0}=t;let i,o;try{i=ht(n).toUint8Array()}catch(e){if(e instanceof it)return m("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{o=new $r(i,r,s)}catch(e){return m(e instanceof Qr?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===o.Te?null:o}et(e,t,n){return t.fe.count===n-this.rt(e,t.targetId)?0:2}rt(e,t){const n=this.Le.getRemoteKeysForTarget(t);let r=0;return n.forEach(n=>{const s=this.Le.nt(),i=`projects/${s.projectId}/databases/${s.database}/documents/${n.path.canonicalString()}`;e.mightContain(i)||(this.We(t,n,null),r++)}),r}it(e){const t=new Map;this.ke.forEach((n,r)=>{const s=this.Ye(r);if(s){if(n.current&&yn(s.target)){const t=new G(s.target.path);null!==this.qe.get(t)||this.st(r,t)||this.We(r,t,Bt.newNoDocument(t,e))}n.De&&(t.set(r,n.ve()),n.Fe())}});let n=Hn();this.Qe.forEach((e,t)=>{let r=!0;t.forEachWhile(e=>{const t=this.Ye(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(r=!1,!1)}),r&&(n=n.add(e))}),this.qe.forEach((t,n)=>n.setReadTime(e));const r=new jr(e,t,this.Ke,this.qe,n);return this.qe=Un(),this.Qe=es(),this.Ke=new Xe(F),r}Ue(e,t){if(!this.je(e))return;const n=this.st(e,t.key)?2:0;this.ze(e).Me(t.key,n),this.qe=this.qe.insert(t.key,t),this.Qe=this.Qe.insert(t.key,this.ot(t.key).add(e))}We(e,t,n){if(!this.je(e))return;const r=this.ze(e);this.st(e,t)?r.Me(t,1):r.xe(t),this.Qe=this.Qe.insert(t,this.ot(t).delete(e)),n&&(this.qe=this.qe.insert(t,n))}removeTarget(e){this.ke.delete(e)}Ze(e){const t=this.ze(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Oe(e){this.ze(e).Oe()}ze(e){let t=this.ke.get(e);return t||(t=new Xr,this.ke.set(e,t)),t}ot(e){let t=this.Qe.get(e);return t||(t=new tt(F),this.Qe=this.Qe.insert(e,t)),t}je(e){const t=null!==this.Ye(e);return t||d("WatchChangeAggregator","Detected inactive target",e),t}Ye(e){const t=this.ke.get(e);return t&&t.be?null:this.Le._t(e)}He(e){this.ke.set(e,new Xr),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.We(e,t,null)})}st(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function es(){return new Xe(G.comparator)}function ts(){return new Xe(G.comparator)}const ns={asc:"ASCENDING",desc:"DESCENDING"},rs={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},ss={and:"AND",or:"OR"};class is{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function os(e,t){return e.useProto3Json||ye(t)?t:{value:t}}function as(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function cs(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function us(e,t){return as(e,t.toTimestamp())}function ls(e){return y(!!e),O.fromTimestamp(function(e){const t=ut(e);return new V(t.seconds,t.nanos)}(e))}function hs(e,t){return ds(e,t).canonicalString()}function ds(e,t){const n=function(e){return new U(["projects",e.projectId,"databases",e.database])}(e).child("documents");return void 0===t?n:n.child(t)}function fs(e){const t=U.fromString(e);return y(qs(t)),t}function ms(e,t){return hs(e.databaseId,t.path)}function ps(e,t){const n=fs(t);if(n.get(1)!==e.databaseId.projectId)throw new _(I.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new _(I.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new G(vs(n))}function gs(e,t){return hs(e.databaseId,t)}function ys(e){const t=fs(e);return 4===t.length?U.emptyPath():vs(t)}function ws(e){return new U(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function vs(e){return y(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function Is(e,t,n){return{name:ms(e,t),fields:n.value.mapValue.fields}}function _s(e,t,n){const r=ps(e,t.name),s=ls(t.updateTime),i=t.createTime?ls(t.createTime):O.min(),o=new qt({mapValue:{fields:t.fields}}),a=Bt.newFoundDocument(r,s,i,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function bs(e,t){return"found"in t?function(e,t){y(!!t.found),t.found.name,t.found.updateTime;const n=ps(e,t.found.name),r=ls(t.found.updateTime),s=t.found.createTime?ls(t.found.createTime):O.min(),i=new qt({mapValue:{fields:t.found.fields}});return Bt.newFoundDocument(n,r,s,i)}(e,t):"missing"in t?function(e,t){y(!!t.missing),y(!!t.readTime);const n=ps(e,t.missing),r=ls(t.readTime);return Bt.newNoDocument(n,r)}(e,t):g()}function Es(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:g()}(t.targetChange.targetChangeType||"NO_CHANGE"),s=t.targetChange.targetIds||[],i=function(e,t){return e.useProto3Json?(y(void 0===t||"string"==typeof t),at.fromBase64String(t||"")):(y(void 0===t||t instanceof Uint8Array),at.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,a=o&&function(e){const t=void 0===e.code?I.UNKNOWN:qr(e.code);return new _(t,e.message||"")}(o);n=new Jr(r,s,i,a||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const s=ps(e,r.document.name),i=ls(r.document.updateTime),o=r.document.createTime?ls(r.document.createTime):O.min(),a=new qt({mapValue:{fields:r.document.fields}}),c=Bt.newFoundDocument(s,i,o,a),u=r.targetIds||[],l=r.removedTargetIds||[];n=new Hr(u,l,c.key,c)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const s=ps(e,r.document),i=r.readTime?ls(r.readTime):O.min(),o=Bt.newNoDocument(s,i),a=r.removedTargetIds||[];n=new Hr([],a,o.key,o)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const s=ps(e,r.document),i=r.removedTargetIds||[];n=new Hr([],i,s,null)}else{if(!("filter"in t))return g();{t.filter;const e=t.filter;e.targetId;const{count:r=0,unchangedNames:s}=e,i=new Rr(r,s),o=e.targetId;n=new Yr(o,i)}}return n}function xs(e,t){let n;if(t instanceof xr)n={update:Is(e,t.key,t.value)};else if(t instanceof Nr)n={delete:ms(e,t.key)};else if(t instanceof Tr)n={update:Is(e,t.key,t.data),updateMask:Os(t.fieldMask)};else{if(!(t instanceof Ar))return g();n={verify:ms(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(e=>(function(e,t){const n=t.transform;if(n instanceof ir)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof or)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof cr)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof lr)return{fieldPath:t.field.canonicalString(),increment:n.Ie};throw g()})(0,e))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:us(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:g()}(e,t.precondition)),n}function Ts(e,t){const n=t.currentDocument?function(e){return void 0!==e.updateTime?gr.updateTime(ls(e.updateTime)):void 0!==e.exists?gr.exists(e.exists):gr.none()}(t.currentDocument):gr.none(),r=t.updateTransforms?t.updateTransforms.map(t=>(function(e,t){let n=null;if("setToServerValue"in t)y("REQUEST_TIME"===t.setToServerValue),n=new ir;else if("appendMissingElements"in t){const e=t.appendMissingElements.values||[];n=new or(e)}else if("removeAllFromArray"in t){const e=t.removeAllFromArray.values||[];n=new cr(e)}else"increment"in t?n=new lr(e,t.increment):g();const r=z.fromServerFormat(t.fieldPath);return new fr(r,n)})(e,t)):[];if(t.update){t.update.name;const s=ps(e,t.update.name),i=new qt({mapValue:{fields:t.update.fields}});if(t.updateMask){const e=function(e){const t=e.fieldPaths||[];return new st(t.map(e=>z.fromServerFormat(e)))}(t.updateMask);return new Tr(s,i,e,n,r)}return new xr(s,i,n,r)}if(t.delete){const r=ps(e,t.delete);return new Nr(r,n)}if(t.verify){const r=ps(e,t.verify);return new Ar(r,n)}return g()}function Ss(e,t){return e&&e.length>0?(y(void 0!==t),e.map(e=>(function(e,t){let n=e.updateTime?ls(e.updateTime):ls(t);return n.isEqual(O.min())&&(n=ls(t)),new pr(n,e.transformResults||[])})(e,t))):[]}function Cs(e,t){return{documents:[gs(e,t.path)]}}function Ds(e,t){const n={structuredQuery:{}},r=t.path;let s;null!==t.collectionGroup?(s=r,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=gs(e,s);const i=function(e){if(0!==e.length)return Vs(Ht.create(e,"and"))}(t.filters);i&&(n.structuredQuery.where=i);const o=function(e){if(0!==e.length)return e.map(e=>(function(e){return{field:Rs(e.field),direction:Ms(e.dir)}})(e))}(t.orderBy);o&&(n.structuredQuery.orderBy=o);const a=os(e,t.limit);return null!==a&&(n.structuredQuery.limit=a),t.startAt&&(n.structuredQuery.startAt=function(e){return{before:e.inclusive,values:e.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),{ut:n,parent:s}}function Ns(e){let t=ys(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){y(1===r);const e=n.from[0];e.allDescendants?s=e.collectionId:t=t.child(e.collectionId)}let i=[];n.where&&(i=function(e){const t=ks(e);return t instanceof Ht&&Xt(t)?t.getFilters():[t]}(n.where));let o=[];n.orderBy&&(o=function(e){return e.map(e=>(function(e){return new $t(Ps(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))})(e))}(n.orderBy));let a=null;n.limit&&(a=function(e){let t;return ye(t="object"==typeof e?e.value:e)?null:t}(n.limit));let c=null;n.startAt&&(c=function(e){const t=!!e.before,n=e.values||[];return new zt(n,t)}(n.startAt));let u=null;return n.endAt&&(u=function(e){const t=!e.before,n=e.values||[];return new zt(n,t)}(n.endAt)),bn(t,s,o,i,a,"F",c,u)}function As(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return g()}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}function ks(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=Ps(e.unaryFilter.field);return Wt.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=Ps(e.unaryFilter.field);return Wt.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Ps(e.unaryFilter.field);return Wt.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=Ps(e.unaryFilter.field);return Wt.create(s,"!=",{nullValue:"NULL_VALUE"});default:return g()}}(e):void 0!==e.fieldFilter?function(e){return Wt.create(Ps(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return g()}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return Ht.create(e.compositeFilter.filters.map(e=>ks(e)),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return g()}}(e.compositeFilter.op))}(e):g()}function Ms(e){return ns[e]}function Ls(e){return rs[e]}function Fs(e){return ss[e]}function Rs(e){return{fieldPath:e.canonicalString()}}function Ps(e){return z.fromServerFormat(e.fieldPath)}function Vs(e){return e instanceof Wt?function(e){if("=="===e.op){if(kt(e.value))return{unaryFilter:{field:Rs(e.field),op:"IS_NAN"}};if(At(e.value))return{unaryFilter:{field:Rs(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(kt(e.value))return{unaryFilter:{field:Rs(e.field),op:"IS_NOT_NAN"}};if(At(e.value))return{unaryFilter:{field:Rs(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Rs(e.field),op:Ls(e.op),value:e.value}}}(e):e instanceof Ht?function(e){const t=e.getFilters().map(e=>Vs(e));return 1===t.length?t[0]:{compositeFilter:{op:Fs(e.op),filters:t}}}(e):g()}function Os(e){const t=[];return e.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}function qs(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class Us{constructor(e,t,n,r,s=O.min(),i=O.min(),o=at.EMPTY_BYTE_STRING,a=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=i,this.resumeToken=o,this.expectedCount=a}withSequenceNumber(e){return new Us(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Us(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Us(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Us(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class Bs{constructor(e){this.ct=e}}function zs(e,t){let n;if(t.document)n=_s(e.ct,t.document,!!t.hasCommittedMutations);else if(t.noDocument){const e=G.fromSegments(t.noDocument.path),r=Qs(t.noDocument.readTime);n=Bt.newNoDocument(e,r),t.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!t.unknownDocument)return g();{const e=G.fromSegments(t.unknownDocument.path),r=Qs(t.unknownDocument.version);n=Bt.newUnknownDocument(e,r)}}return t.readTime&&n.setReadTime(function(e){const t=new V(e[0],e[1]);return O.fromTimestamp(t)}(t.readTime)),n}function Gs(e,t){const n=t.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:Ks(t.readTime),hasCommittedMutations:t.hasCommittedMutations};if(t.isFoundDocument())r.document=function(e,t){return{name:ms(e,t.key),fields:t.data.value.mapValue.fields,updateTime:as(e,t.version.toTimestamp()),createTime:as(e,t.createTime.toTimestamp())}}(e.ct,t);else if(t.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:$s(t.version)};else{if(!t.isUnknownDocument())return g();r.unknownDocument={path:n.path.toArray(),version:$s(t.version)}}return r}function Ks(e){const t=e.toTimestamp();return[t.seconds,t.nanoseconds]}function $s(e){const t=e.toTimestamp();return{seconds:t.seconds,nanoseconds:t.nanoseconds}}function Qs(e){const t=new V(e.seconds,e.nanoseconds);return O.fromTimestamp(t)}function js(e,t){const n=(t.baseMutations||[]).map(t=>Ts(e.ct,t));for(let i=0;i<t.mutations.length-1;++i){const e=t.mutations[i];if(i+1<t.mutations.length&&void 0!==t.mutations[i+1].transform){const n=t.mutations[i+1];e.updateTransforms=n.transform.fieldTransforms,t.mutations.splice(i+1,1),++i}}const r=t.mutations.map(t=>Ts(e.ct,t)),s=V.fromMillis(t.localWriteTimeMs);return new kr(t.batchId,s,n,r)}function Ws(e){const t=Qs(e.readTime),n=void 0!==e.lastLimboFreeSnapshotVersion?Qs(e.lastLimboFreeSnapshotVersion):O.min();let r;return r=function(e){return void 0!==e.documents}(e.query)?function(e){return y(1===e.documents.length),Cn(En(ys(e.documents[0])))}(e.query):function(e){return Cn(Ns(e))}(e.query),new Us(r,e.targetId,"TargetPurposeListen",e.lastListenSequenceNumber,t,n,at.fromBase64String(e.resumeToken))}function Hs(e,t){const n=$s(t.snapshotVersion),r=$s(t.lastLimboFreeSnapshotVersion);let s;s=yn(t.target)?Cs(e.ct,t.target):Ds(e.ct,t.target).ut;const i=t.resumeToken.toBase64();return{targetId:t.targetId,canonicalId:pn(t.target),readTime:n,resumeToken:i,lastListenSequenceNumber:t.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:s}}function Ys(e){const t=Ns({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?An(t,t.limit,"L"):t}function Js(e,t){return new Lr(t.largestBatchId,Ts(e.ct,t.overlayMutation))}function Xs(e,t){const n=t.path.lastSegment();return[e,Ie(t.path.popLast()),n]}function Zs(e,t,n,r){return{indexId:e,uid:t,sequenceNumber:n,readTime:$s(r.readTime),documentKey:Ie(r.documentKey.path),largestBatchId:r.largestBatchId}}class ei{getBundleMetadata(e,t){return ti(e).get(t).next(e=>{if(e)return function(e){return{id:e.bundleId,createTime:Qs(e.createTime),version:e.version}}(e)})}saveBundleMetadata(e,t){return ti(e).put(function(e){return{bundleId:e.id,createTime:$s(ls(e.createTime)),version:e.version}}(t))}getNamedQuery(e,t){return ni(e).get(t).next(e=>{if(e)return function(e){return{name:e.name,query:Ys(e.bundledQuery),readTime:Qs(e.readTime)}}(e)})}saveNamedQuery(e,t){return ni(e).put(function(e){return{name:e.name,readTime:$s(ls(e.readTime)),bundledQuery:e.bundledQuery}}(t))}}function ti(e){return We(e,"bundles")}function ni(e){return We(e,"namedQueries")}class ri{constructor(e,t){this.serializer=e,this.userId=t}static lt(e,t){const n=t.uid||"";return new ri(e,n)}getOverlay(e,t){return si(e).get(Xs(this.userId,t)).next(e=>e?Js(this.serializer,e):null)}getOverlays(e,t){const n=Kn();return se.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&n.set(t,e)})).next(()=>n)}saveOverlays(e,t,n){const r=[];return n.forEach((n,s)=>{const i=new Lr(t,s);r.push(this.ht(e,i))}),se.waitFor(r)}removeOverlaysForBatchId(e,t,n){const r=new Set;t.forEach(e=>r.add(Ie(e.getCollectionPath())));const s=[];return r.forEach(t=>{const r=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,n+1],!1,!0);s.push(si(e).H("collectionPathOverlayIndex",r))}),se.waitFor(s)}getOverlaysForCollection(e,t,n){const r=Kn(),s=Ie(t),i=IDBKeyRange.bound([this.userId,s,n],[this.userId,s,Number.POSITIVE_INFINITY],!0);return si(e).W("collectionPathOverlayIndex",i).next(e=>{for(const t of e){const e=Js(this.serializer,t);r.set(e.getKey(),e)}return r})}getOverlaysForCollectionGroup(e,t,n,r){const s=Kn();let i;const o=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return si(e).Y({index:"collectionGroupOverlayIndex",range:o},(e,t,n)=>{const o=Js(this.serializer,t);s.size()<r||o.largestBatchId===i?(s.set(o.getKey(),o),i=o.largestBatchId):n.done()}).next(()=>s)}ht(e,t){return si(e).put(function(e,t,n){const[r,s,i]=Xs(t,n.mutation.key);return{userId:t,collectionPath:s,documentId:i,collectionGroup:n.mutation.key.getCollectionGroup(),largestBatchId:n.largestBatchId,overlayMutation:xs(e.ct,n.mutation)}}(this.serializer,this.userId,t))}}function si(e){return We(e,"documentOverlays")}class ii{constructor(){}Pt(e,t){this.It(e,t),t.Tt()}It(e,t){if("nullValue"in e)this.Et(t,5);else if("booleanValue"in e)this.Et(t,10),t.dt(e.booleanValue?1:0);else if("integerValue"in e)this.Et(t,15),t.dt(lt(e.integerValue));else if("doubleValue"in e){const n=lt(e.doubleValue);isNaN(n)?this.Et(t,13):(this.Et(t,15),we(n)?t.dt(0):t.dt(n))}else if("timestampValue"in e){const n=e.timestampValue;this.Et(t,20),"string"==typeof n?t.At(n):(t.At(`${n.seconds||""}`),t.dt(n.nanos||0))}else if("stringValue"in e)this.Rt(e.stringValue,t),this.Vt(t);else if("bytesValue"in e)this.Et(t,30),t.ft(ht(e.bytesValue)),this.Vt(t);else if("referenceValue"in e)this.gt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.Et(t,45),t.dt(n.latitude||0),t.dt(n.longitude||0)}else"mapValue"in e?Ft(e)?this.Et(t,Number.MAX_SAFE_INTEGER):(this.yt(e.mapValue,t),this.Vt(t)):"arrayValue"in e?(this.wt(e.arrayValue,t),this.Vt(t)):g()}Rt(e,t){this.Et(t,25),this.St(e,t)}St(e,t){t.At(e)}yt(e,t){const n=e.fields||{};this.Et(t,55);for(const r of Object.keys(n))this.Rt(r,t),this.It(n[r],t)}wt(e,t){const n=e.values||[];this.Et(t,50);for(const r of n)this.It(r,t)}gt(e,t){this.Et(t,37),G.fromName(e).path.forEach(e=>{this.Et(t,60),this.St(e,t)})}Et(e,t){e.dt(t)}Vt(e){e.dt(2)}}function oi(e){if(0===e)return 8;let t=0;return e>>4==0&&(t+=4,e<<=4),e>>6==0&&(t+=2,e<<=2),e>>7==0&&(t+=1),t}function ai(e){const t=64-function(e){let t=0;for(let n=0;n<8;++n){const r=oi(255&e[n]);if(t+=r,8!==r)break}return t}(e);return Math.ceil(t/8)}ii.bt=new ii;class ci{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Dt(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Ct(n.value),n=t.next();this.vt()}Ft(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Mt(n.value),n=t.next();this.xt()}Ot(e){for(const t of e){const e=t.charCodeAt(0);if(e<128)this.Ct(e);else if(e<2048)this.Ct(960|e>>>6),this.Ct(128|63&e);else if(t<"\ud800"||"\udbff"<t)this.Ct(480|e>>>12),this.Ct(128|63&e>>>6),this.Ct(128|63&e);else{const e=t.codePointAt(0);this.Ct(240|e>>>18),this.Ct(128|63&e>>>12),this.Ct(128|63&e>>>6),this.Ct(128|63&e)}}this.vt()}Nt(e){for(const t of e){const e=t.charCodeAt(0);if(e<128)this.Mt(e);else if(e<2048)this.Mt(960|e>>>6),this.Mt(128|63&e);else if(t<"\ud800"||"\udbff"<t)this.Mt(480|e>>>12),this.Mt(128|63&e>>>6),this.Mt(128|63&e);else{const e=t.codePointAt(0);this.Mt(240|e>>>18),this.Mt(128|63&e>>>12),this.Mt(128|63&e>>>6),this.Mt(128|63&e)}}this.xt()}Bt(e){const t=this.Lt(e),n=ai(t);this.kt(1+n),this.buffer[this.position++]=255&n;for(let r=t.length-n;r<t.length;++r)this.buffer[this.position++]=255&t[r]}qt(e){const t=this.Lt(e),n=ai(t);this.kt(1+n),this.buffer[this.position++]=~(255&n);for(let r=t.length-n;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}Qt(){this.Kt(255),this.Kt(255)}$t(){this.Ut(255),this.Ut(255)}reset(){this.position=0}seed(e){this.kt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Wt(){return this.buffer.slice(0,this.position)}Lt(e){const t=function(e){const t=new DataView(new ArrayBuffer(8));return t.setFloat64(0,e,!1),new Uint8Array(t.buffer)}(e),n=0!=(128&t[0]);t[0]^=n?255:128;for(let r=1;r<t.length;++r)t[r]^=n?255:0;return t}Ct(e){const t=255&e;0===t?(this.Kt(0),this.Kt(255)):255===t?(this.Kt(255),this.Kt(0)):this.Kt(t)}Mt(e){const t=255&e;0===t?(this.Ut(0),this.Ut(255)):255===t?(this.Ut(255),this.Ut(0)):this.Ut(e)}vt(){this.Kt(0),this.Kt(1)}xt(){this.Ut(0),this.Ut(1)}Kt(e){this.kt(1),this.buffer[this.position++]=e}Ut(e){this.kt(1),this.buffer[this.position++]=~e}kt(e){const t=e+this.position;if(t<=this.buffer.length)return;let n=2*this.buffer.length;n<t&&(n=t);const r=new Uint8Array(n);r.set(this.buffer),this.buffer=r}}class ui{constructor(e){this.Gt=e}ft(e){this.Gt.Dt(e)}At(e){this.Gt.Ot(e)}dt(e){this.Gt.Bt(e)}Tt(){this.Gt.Qt()}}class li{constructor(e){this.Gt=e}ft(e){this.Gt.Ft(e)}At(e){this.Gt.Nt(e)}dt(e){this.Gt.qt(e)}Tt(){this.Gt.$t()}}class hi{constructor(){this.Gt=new ci,this.zt=new ui(this.Gt),this.jt=new li(this.Gt)}seed(e){this.Gt.seed(e)}Ht(e){return 0===e?this.zt:this.jt}Wt(){return this.Gt.Wt()}reset(){this.Gt.reset()}}class di{constructor(e,t,n,r){this.indexId=e,this.documentKey=t,this.arrayValue=n,this.directionalValue=r}Jt(){const e=this.directionalValue.length,t=0===e||255===this.directionalValue[e-1]?e+1:e,n=new Uint8Array(t);return n.set(this.directionalValue,0),t!==e?n.set([0],this.directionalValue.length):++n[n.length-1],new di(this.indexId,this.documentKey,this.arrayValue,n)}}function fi(e,t){let n=e.indexId-t.indexId;return 0!==n?n:0!==(n=mi(e.arrayValue,t.arrayValue))?n:0!==(n=mi(e.directionalValue,t.directionalValue))?n:G.comparator(e.documentKey,t.documentKey)}function mi(e,t){for(let n=0;n<e.length&&n<t.length;++n){const r=e[n]-t[n];if(0!==r)return r}return e.length-t.length}class pi{constructor(e){this.Yt=new tt((e,t)=>z.comparator(e.field,t.field)),this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.Zt=e.orderBy,this.Xt=[];for(const t of e.filters){const e=t;e.isInequality()?this.Yt=this.Yt.add(e):this.Xt.push(e)}}get en(){return this.Yt.size>1}tn(e){if(y(e.collectionGroup===this.collectionId),this.en)return!1;const t=$(e);if(void 0!==t&&!this.nn(t))return!1;const n=Q(e);let r=new Set,s=0,i=0;for(;s<n.length&&this.nn(n[s]);++s)r=r.add(n[s].fieldPath.canonicalString());if(s===n.length)return!0;if(this.Yt.size>0){const e=this.Yt.getIterator().getNext();if(!r.has(e.field.canonicalString())){const t=n[s];if(!this.rn(e,t)||!this.sn(this.Zt[i++],t))return!1}++s}for(;s<n.length;++s){const e=n[s];if(i>=this.Zt.length||!this.sn(this.Zt[i++],e))return!1}return!0}on(){if(this.en)return null;let e=new tt(z.comparator);const t=[];for(const n of this.Xt)if(!n.field.isKeyField())if("array-contains"===n.op||"array-contains-any"===n.op)t.push(new W(n.field,2));else{if(e.has(n.field))continue;e=e.add(n.field),t.push(new W(n.field,0))}for(const n of this.Zt)n.field.isKeyField()||e.has(n.field)||(e=e.add(n.field),t.push(new W(n.field,"asc"===n.dir?0:1)));return new K(K.UNKNOWN_ID,this.collectionId,t,Y.empty())}nn(e){for(const t of this.Xt)if(this.rn(t,e))return!0;return!1}rn(e,t){if(void 0===e||!e.field.isEqual(t.fieldPath))return!1;const n="array-contains"===e.op||"array-contains-any"===e.op;return 2===t.kind===n}sn(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}function gi(e){var t,n;if(y(e instanceof Wt||e instanceof Ht),e instanceof Wt){if(e instanceof ln){const r=(null===(n=null===(t=e.value.arrayValue)||void 0===t?void 0:t.values)||void 0===n?void 0:n.map(t=>Wt.create(e.field,"==",t)))||[];return Ht.create(r,"or")}return e}const r=e.filters.map(e=>gi(e));return Ht.create(r,e.op)}function yi(e){if(0===e.getFilters().length)return[];const t=_i(gi(e));return y(Ii(t)),wi(t)||vi(t)?[t]:t.getFilters()}function wi(e){return e instanceof Wt}function vi(e){return e instanceof Ht&&Xt(e)}function Ii(e){return wi(e)||vi(e)||function(e){if(e instanceof Ht&&Jt(e)){for(const t of e.getFilters())if(!wi(t)&&!vi(t))return!1;return!0}return!1}(e)}function _i(e){if(y(e instanceof Wt||e instanceof Ht),e instanceof Wt)return e;if(1===e.filters.length)return _i(e.filters[0]);const t=e.filters.map(e=>_i(e));let n=Ht.create(t,e.op);return Ii(n=xi(n))?n:(y(n instanceof Ht),y(Yt(n)),y(n.filters.length>1),n.filters.reduce((e,t)=>bi(e,t)))}function bi(e,t){let n;return y(e instanceof Wt||e instanceof Ht),y(t instanceof Wt||t instanceof Ht),xi(n=e instanceof Wt?t instanceof Wt?function(e,t){return Ht.create([e,t],"and")}(e,t):Ei(e,t):t instanceof Wt?Ei(t,e):function(e,t){if(y(e.filters.length>0&&t.filters.length>0),Yt(e)&&Yt(t))return nn(e,t.getFilters());const n=Jt(e)?e:t,r=Jt(e)?t:e,s=n.filters.map(e=>bi(e,r));return Ht.create(s,"or")}(e,t))}function Ei(e,t){if(Yt(t))return nn(t,e.getFilters());{const n=t.filters.map(t=>bi(e,t));return Ht.create(n,"or")}}function xi(e){if(y(e instanceof Wt||e instanceof Ht),e instanceof Wt)return e;const t=e.getFilters();if(1===t.length)return xi(t[0]);if(Zt(e))return e;const n=t.map(e=>xi(e)),r=[];return n.forEach(t=>{t instanceof Wt?r.push(t):t instanceof Ht&&(t.op===e.op?r.push(...t.filters):r.push(t))}),1===r.length?r[0]:Ht.create(r,e.op)}class Ti{constructor(){this._n=new Si}addToCollectionParentIndex(e,t){return this._n.add(t),se.resolve()}getCollectionParents(e,t){return se.resolve(this._n.getEntries(t))}addFieldIndex(e,t){return se.resolve()}deleteFieldIndex(e,t){return se.resolve()}deleteAllFieldIndexes(e){return se.resolve()}createTargetIndexes(e,t){return se.resolve()}getDocumentsMatchingTarget(e,t){return se.resolve(null)}getIndexType(e,t){return se.resolve(0)}getFieldIndexes(e,t){return se.resolve([])}getNextCollectionGroupToUpdate(e){return se.resolve(null)}getMinOffset(e,t){return se.resolve(Z.min())}getMinOffsetFromCollectionGroup(e,t){return se.resolve(Z.min())}updateCollectionGroup(e,t,n){return se.resolve()}updateIndexEntries(e,t){return se.resolve()}}class Si{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new tt(U.comparator),s=!r.has(n);return this.index[t]=r.add(n),s}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new tt(U.comparator)).toArray()}}const Ci=new Uint8Array(0);class Di{constructor(e,t){this.databaseId=t,this.an=new Si,this.un=new On(e=>pn(e),(e,t)=>gn(e,t)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.an.has(t)){const n=t.lastSegment(),r=t.popLast();e.addOnCommittedListener(()=>{this.an.add(t)});const s={collectionId:n,parent:Ie(r)};return Ni(e).put(s)}return se.resolve()}getCollectionParents(e,t){const n=[],r=IDBKeyRange.bound([t,""],[P(t),""],!1,!0);return Ni(e).W(r).next(e=>{for(const r of e){if(r.collectionId!==t)break;n.push(Ee(r.parent))}return n})}addFieldIndex(e,t){const n=ki(e),r=function(e){return{indexId:e.indexId,collectionGroup:e.collectionGroup,fields:e.fields.map(e=>[e.fieldPath.canonicalString(),e.kind])}}(t);delete r.indexId;const s=n.add(r);if(t.indexState){const n=Mi(e);return s.next(e=>{n.put(Zs(e,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return s.next()}deleteFieldIndex(e,t){const n=ki(e),r=Mi(e),s=Ai(e);return n.delete(t.indexId).next(()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const t=ki(e),n=Ai(e),r=Mi(e);return t.H().next(()=>n.H()).next(()=>r.H())}createTargetIndexes(e,t){return se.forEach(this.cn(t),t=>this.getIndexType(e,t).next(n=>{if(0===n||1===n){const n=new pi(t).on();if(null!=n)return this.addFieldIndex(e,n)}}))}getDocumentsMatchingTarget(e,t){const n=Ai(e);let r=!0;const s=new Map;return se.forEach(this.cn(t),t=>this.ln(e,t).next(e=>{r&&(r=!!e),s.set(t,e)})).next(()=>{if(r){let e=Hn();const r=[];return se.forEach(s,(s,i)=>{d("IndexedDbIndexManager",`Using index ${function(e){return`id=${e.indexId}|cg=${e.collectionGroup}|f=${e.fields.map(e=>`${e.fieldPath}:${e.kind}`).join(",")}`}(s)} to execute ${pn(t)}`);const o=function(e,t){const n=$(t);if(void 0===n)return null;for(const r of wn(e,n.fieldPath))switch(r.op){case"array-contains-any":return r.value.arrayValue.values||[];case"array-contains":return[r.value]}return null}(i,s),a=function(e,t){const n=new Map;for(const r of Q(t))for(const t of wn(e,r.fieldPath))switch(t.op){case"==":case"in":n.set(r.fieldPath.canonicalString(),t.value);break;case"not-in":case"!=":return n.set(r.fieldPath.canonicalString(),t.value),Array.from(n.values())}return null}(i,s),c=function(e,t){const n=[];let r=!0;for(const s of Q(t)){const t=0===s.kind?vn(e,s.fieldPath,e.startAt):In(e,s.fieldPath,e.startAt);n.push(t.value),r&&(r=t.inclusive)}return new zt(n,r)}(i,s),u=function(e,t){const n=[];let r=!0;for(const s of Q(t)){const t=0===s.kind?In(e,s.fieldPath,e.endAt):vn(e,s.fieldPath,e.endAt);n.push(t.value),r&&(r=t.inclusive)}return new zt(n,r)}(i,s),l=this.hn(s,i,c),h=this.hn(s,i,u),f=this.Pn(s,i,a),m=this.In(s.indexId,o,l,c.inclusive,h,u.inclusive,f);return se.forEach(m,s=>n.j(s,t.limit).next(t=>{t.forEach(t=>{const n=G.fromSegments(t.documentKey);e.has(n)||(e=e.add(n),r.push(n))})}))}).next(()=>r)}return se.resolve(null)})}cn(e){let t=this.un.get(e);return t||(t=0===e.filters.length?[e]:yi(Ht.create(e.filters,"and")).map(t=>mn(e.path,e.collectionGroup,e.orderBy,t.getFilters(),e.limit,e.startAt,e.endAt)),this.un.set(e,t),t)}In(e,t,n,r,s,i,o){const a=(null!=t?t.length:1)*Math.max(n.length,s.length),c=a/(null!=t?t.length:1),u=[];for(let l=0;l<a;++l){const a=t?this.Tn(t[l/c]):Ci,h=this.En(e,a,n[l%c],r),d=this.dn(e,a,s[l%c],i),f=o.map(t=>this.En(e,a,t,!0));u.push(...this.createRange(h,d,f))}return u}En(e,t,n,r){const s=new di(e,G.empty(),t,n);return r?s:s.Jt()}dn(e,t,n,r){const s=new di(e,G.empty(),t,n);return r?s.Jt():s}ln(e,t){const n=new pi(t),r=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next(e=>{let t=null;for(const r of e)n.tn(r)&&(!t||r.fields.length>t.fields.length)&&(t=r);return t})}getIndexType(e,t){let n=2;const r=this.cn(t);return se.forEach(r,t=>this.ln(e,t).next(e=>{e?0!==n&&e.fields.length<function(e){let t=new tt(z.comparator),n=!1;for(const r of e.filters)for(const e of r.getFlattenedFilters())e.field.isKeyField()||("array-contains"===e.op||"array-contains-any"===e.op?n=!0:t=t.add(e.field));for(const r of e.orderBy)r.field.isKeyField()||(t=t.add(r.field));return t.size+(n?1:0)}(t)&&(n=1):n=0})).next(()=>(function(e){return null!==e.limit})(t)&&r.length>1&&2===n?1:n)}An(e,t){const n=new hi;for(const r of Q(e)){const e=t.data.field(r.fieldPath);if(null==e)return null;const s=n.Ht(r.kind);ii.bt.Pt(e,s)}return n.Wt()}Tn(e){const t=new hi;return ii.bt.Pt(e,t.Ht(0)),t.Wt()}Rn(e,t){const n=new hi;return ii.bt.Pt(Ct(this.databaseId,t),n.Ht(function(e){const t=Q(e);return 0===t.length?0:t[t.length-1].kind}(e))),n.Wt()}Pn(e,t,n){if(null===n)return[];let r=[];r.push(new hi);let s=0;for(const i of Q(e)){const e=n[s++];for(const n of r)if(this.Vn(t,i.fieldPath)&&Nt(e))r=this.mn(r,i,e);else{const t=n.Ht(i.kind);ii.bt.Pt(e,t)}}return this.fn(r)}hn(e,t,n){return this.Pn(e,t,n.position)}fn(e){const t=[];for(let n=0;n<e.length;++n)t[n]=e[n].Wt();return t}mn(e,t,n){const r=[...e],s=[];for(const i of n.arrayValue.values||[])for(const e of r){const n=new hi;n.seed(e.Wt()),ii.bt.Pt(i,n.Ht(t.kind)),s.push(n)}return s}Vn(e,t){return!!e.filters.find(e=>e instanceof Wt&&e.field.isEqual(t)&&("in"===e.op||"not-in"===e.op))}getFieldIndexes(e,t){const n=ki(e),r=Mi(e);return(t?n.W("collectionGroupIndex",IDBKeyRange.bound(t,t)):n.W()).next(e=>{const t=[];return se.forEach(e,e=>r.get([e.indexId,this.uid]).next(n=>{t.push(function(e,t){const n=t?new Y(t.sequenceNumber,new Z(Qs(t.readTime),new G(Ee(t.documentKey)),t.largestBatchId)):Y.empty(),r=e.fields.map(([e,t])=>new W(z.fromServerFormat(e),t));return new K(e.indexId,e.collectionGroup,r,n)}(e,n))})).next(()=>t)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(e=>0===e.length?null:(e.sort((e,t)=>{const n=e.indexState.sequenceNumber-t.indexState.sequenceNumber;return 0!==n?n:F(e.collectionGroup,t.collectionGroup)}),e[0].collectionGroup))}updateCollectionGroup(e,t,n){const r=ki(e),s=Mi(e);return this.gn(e).next(e=>r.W("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(t=>se.forEach(t,t=>s.put(Zs(t.indexId,this.uid,e,n)))))}updateIndexEntries(e,t){const n=new Map;return se.forEach(t,(t,r)=>{const s=n.get(t.collectionGroup);return(s?se.resolve(s):this.getFieldIndexes(e,t.collectionGroup)).next(s=>(n.set(t.collectionGroup,s),se.forEach(s,n=>this.pn(e,t,n).next(t=>{const s=this.yn(r,n);return t.isEqual(s)?se.resolve():this.wn(e,r,n,t,s)}))))})}Sn(e,t,n,r){return Ai(e).put({indexId:r.indexId,uid:this.uid,arrayValue:r.arrayValue,directionalValue:r.directionalValue,orderedDocumentKey:this.Rn(n,t.key),documentKey:t.key.path.toArray()})}bn(e,t,n,r){return Ai(e).delete([r.indexId,this.uid,r.arrayValue,r.directionalValue,this.Rn(n,t.key),t.key.path.toArray()])}pn(e,t,n){const r=Ai(e);let s=new tt(fi);return r.Y({index:"documentKeyIndex",range:IDBKeyRange.only([n.indexId,this.uid,this.Rn(n,t)])},(e,r)=>{s=s.add(new di(n.indexId,t,r.arrayValue,r.directionalValue))}).next(()=>s)}yn(e,t){let n=new tt(fi);const r=this.An(t,e);if(null==r)return n;const s=$(t);if(null!=s){const i=e.data.field(s.fieldPath);if(Nt(i))for(const s of i.arrayValue.values||[])n=n.add(new di(t.indexId,e.key,this.Tn(s),r))}else n=n.add(new di(t.indexId,e.key,Ci,r));return n}wn(e,t,n,r,s){d("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const i=[];return function(e,t,n,r,s){const i=e.getIterator(),o=t.getIterator();let a=rt(i),c=rt(o);for(;a||c;){let e=!1,t=!1;if(a&&c){const r=n(a,c);r<0?t=!0:r>0&&(e=!0)}else null!=a?t=!0:e=!0;e?(r(c),c=rt(o)):t?(s(a),a=rt(i)):(a=rt(i),c=rt(o))}}(r,s,fi,r=>{i.push(this.Sn(e,t,n,r))},r=>{i.push(this.bn(e,t,n,r))}),se.waitFor(i)}gn(e){let t=1;return Mi(e).Y({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(e,n,r)=>{r.done(),t=n.sequenceNumber+1}).next(()=>t)}createRange(e,t,n){n=n.sort((e,t)=>fi(e,t)).filter((e,t,n)=>!t||0!==fi(e,n[t-1]));const r=[];r.push(e);for(const i of n){const n=fi(i,e),s=fi(i,t);if(0===n)r[0]=e.Jt();else if(n>0&&s<0)r.push(i),r.push(i.Jt());else if(s>0)break}r.push(t);const s=[];for(let i=0;i<r.length;i+=2){if(this.Dn(r[i],r[i+1]))return[];const e=[r[i].indexId,this.uid,r[i].arrayValue,r[i].directionalValue,Ci,[]],t=[r[i+1].indexId,this.uid,r[i+1].arrayValue,r[i+1].directionalValue,Ci,[]];s.push(IDBKeyRange.bound(e,t))}return s}Dn(e,t){return fi(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(Li)}getMinOffset(e,t){return se.mapArray(this.cn(t),t=>this.ln(e,t).next(e=>e||g())).next(Li)}}function Ni(e){return We(e,"collectionParents")}function Ai(e){return We(e,"indexEntries")}function ki(e){return We(e,"indexConfiguration")}function Mi(e){return We(e,"indexState")}function Li(e){y(0!==e.length);let t=e[0].indexState.offset,n=t.largestBatchId;for(let r=1;r<e.length;r++){const s=e[r].indexState.offset;ee(s,t)<0&&(t=s),n<s.largestBatchId&&(n=s.largestBatchId)}return new Z(t.readTime,t.documentKey,n)}const Fi={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Ri{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new Ri(e,Ri.DEFAULT_COLLECTION_PERCENTILE,Ri.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function Pi(e,t,n){const r=e.store("mutations"),s=e.store("documentMutations"),i=[],o=IDBKeyRange.only(n.batchId);let a=0;const c=r.Y({range:o},(e,t,n)=>(a++,n.delete()));i.push(c.next(()=>{y(1===a)}));const u=[];for(const l of n.mutations){const e=Se(t,l.key.path,n.batchId);i.push(s.delete(e)),u.push(l.key)}return se.waitFor(i).next(()=>u)}function Vi(e){if(!e)return 0;let t;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw g();t=e.noDocument}return JSON.stringify(t).length}Ri.DEFAULT_COLLECTION_PERCENTILE=10,Ri.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ri.DEFAULT=new Ri(41943040,Ri.DEFAULT_COLLECTION_PERCENTILE,Ri.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ri.DISABLED=new Ri(-1,0,0);class Oi{constructor(e,t,n,r){this.userId=e,this.serializer=t,this.indexManager=n,this.referenceDelegate=r,this.Cn={}}static lt(e,t,n,r){y(""!==e.uid);const s=e.isAuthenticated()?e.uid:"";return new Oi(s,t,n,r)}checkEmpty(e){let t=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ui(e).Y({index:"userMutationsIndex",range:n},(e,n,r)=>{t=!1,r.done()}).next(()=>t)}addMutationBatch(e,t,n,r){const s=Bi(e),i=Ui(e);return i.add({}).next(o=>{y("number"==typeof o);const a=new kr(o,t,n,r),c=function(e,t,n){const r=n.baseMutations.map(t=>xs(e.ct,t)),s=n.mutations.map(t=>xs(e.ct,t));return{userId:t,batchId:n.batchId,localWriteTimeMs:n.localWriteTime.toMillis(),baseMutations:r,mutations:s}}(this.serializer,this.userId,a),u=[];let l=new tt((e,t)=>F(e.canonicalString(),t.canonicalString()));for(const e of r){const t=Se(this.userId,e.key.path,o);l=l.add(e.key.path.popLast()),u.push(i.put(c)),u.push(s.put(t,Ce))}return l.forEach(t=>{u.push(this.indexManager.addToCollectionParentIndex(e,t))}),e.addOnCommittedListener(()=>{this.Cn[o]=a.keys()}),se.waitFor(u).next(()=>a)})}lookupMutationBatch(e,t){return Ui(e).get(t).next(e=>e?(y(e.userId===this.userId),js(this.serializer,e)):null)}vn(e,t){return this.Cn[t]?se.resolve(this.Cn[t]):this.lookupMutationBatch(e,t).next(e=>{if(e){const n=e.keys();return this.Cn[t]=n,n}return null})}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=IDBKeyRange.lowerBound([this.userId,n]);let s=null;return Ui(e).Y({index:"userMutationsIndex",range:r},(e,t,r)=>{t.userId===this.userId&&(y(t.batchId>=n),s=js(this.serializer,t)),r.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=-1;return Ui(e).Y({index:"userMutationsIndex",range:t,reverse:!0},(e,t,r)=>{n=t.batchId,r.done()}).next(()=>n)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Ui(e).W("userMutationsIndex",t).next(e=>e.map(e=>js(this.serializer,e)))}getAllMutationBatchesAffectingDocumentKey(e,t){const n=Te(this.userId,t.path),r=IDBKeyRange.lowerBound(n),s=[];return Bi(e).Y({range:r},(n,r,i)=>{const[o,a,c]=n,u=Ee(a);if(o===this.userId&&t.path.isEqual(u))return Ui(e).get(c).next(e=>{if(!e)throw g();y(e.userId===this.userId),s.push(js(this.serializer,e))});i.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new tt(F);const r=[];return t.forEach(t=>{const s=Te(this.userId,t.path),i=IDBKeyRange.lowerBound(s),o=Bi(e).Y({range:i},(e,r,s)=>{const[i,o,a]=e,c=Ee(o);i===this.userId&&t.path.isEqual(c)?n=n.add(a):s.done()});r.push(o)}),se.waitFor(r).next(()=>this.Fn(e,n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1,s=Te(this.userId,n),i=IDBKeyRange.lowerBound(s);let o=new tt(F);return Bi(e).Y({range:i},(e,t,s)=>{const[i,a,c]=e,u=Ee(a);i===this.userId&&n.isPrefixOf(u)?u.length===r&&(o=o.add(c)):s.done()}).next(()=>this.Fn(e,o))}Fn(e,t){const n=[],r=[];return t.forEach(t=>{r.push(Ui(e).get(t).next(e=>{if(null===e)throw g();y(e.userId===this.userId),n.push(js(this.serializer,e))}))}),se.waitFor(r).next(()=>n)}removeMutationBatch(e,t){return Pi(e.ae,this.userId,t).next(n=>(e.addOnCommittedListener(()=>{this.Mn(t.batchId)}),se.forEach(n,t=>this.referenceDelegate.markPotentiallyOrphaned(e,t))))}Mn(e){delete this.Cn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return se.resolve();const n=IDBKeyRange.lowerBound(function(e){return[e]}(this.userId)),r=[];return Bi(e).Y({range:n},(e,t,n)=>{if(e[0]===this.userId){const t=Ee(e[1]);r.push(t)}else n.done()}).next(()=>{y(0===r.length)})})}containsKey(e,t){return qi(e,this.userId,t)}xn(e){return zi(e).get(this.userId).next(e=>e||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function qi(e,t,n){const r=Te(t,n.path),s=r[1],i=IDBKeyRange.lowerBound(r);let o=!1;return Bi(e).Y({range:i,J:!0},(e,n,r)=>{const[i,a,c]=e;i===t&&a===s&&(o=!0),r.done()}).next(()=>o)}function Ui(e){return We(e,"mutations")}function Bi(e){return We(e,"documentMutations")}function zi(e){return We(e,"mutationQueues")}class Gi{constructor(e){this.On=e}next(){return this.On+=2,this.On}static Nn(){return new Gi(0)}static Bn(){return new Gi(-1)}}class Ki{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.Ln(e).next(t=>{const n=new Gi(t.highestTargetId);return t.highestTargetId=n.next(),this.kn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Ln(e).next(e=>O.fromTimestamp(new V(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Ln(e).next(e=>e.highestListenSequenceNumber)}setTargetsMetadata(e,t,n){return this.Ln(e).next(r=>(r.highestListenSequenceNumber=t,n&&(r.lastRemoteSnapshotVersion=n.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.kn(e,r)))}addTargetData(e,t){return this.qn(e,t).next(()=>this.Ln(e).next(n=>(n.targetCount+=1,this.Qn(t,n),this.kn(e,n))))}updateTargetData(e,t){return this.qn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>$i(e).delete(t.targetId)).next(()=>this.Ln(e)).next(t=>(y(t.targetCount>0),t.targetCount-=1,this.kn(e,t)))}removeTargets(e,t,n){let r=0;const s=[];return $i(e).Y((i,o)=>{const a=Ws(o);a.sequenceNumber<=t&&null===n.get(a.targetId)&&(r++,s.push(this.removeTargetData(e,a)))}).next(()=>se.waitFor(s)).next(()=>r)}forEachTarget(e,t){return $i(e).Y((e,n)=>{const r=Ws(n);t(r)})}Ln(e){return Qi(e).get("targetGlobalKey").next(e=>(y(null!==e),e))}kn(e,t){return Qi(e).put("targetGlobalKey",t)}qn(e,t){return $i(e).put(Hs(this.serializer,t))}Qn(e,t){let n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.Ln(e).next(e=>e.targetCount)}getTargetData(e,t){const n=pn(t),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let s=null;return $i(e).Y({range:r,index:"queryTargetsIndex"},(e,n,r)=>{const i=Ws(n);gn(t,i.target)&&(s=i,r.done())}).next(()=>s)}addMatchingKeys(e,t,n){const r=[],s=ji(e);return t.forEach(t=>{const i=Ie(t.path);r.push(s.put({targetId:n,path:i})),r.push(this.referenceDelegate.addReference(e,n,t))}),se.waitFor(r)}removeMatchingKeys(e,t,n){const r=ji(e);return se.forEach(t,t=>{const s=Ie(t.path);return se.waitFor([r.delete([n,s]),this.referenceDelegate.removeReference(e,n,t)])})}removeMatchingKeysForTargetId(e,t){const n=ji(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(r)}getMatchingKeysForTargetId(e,t){const n=IDBKeyRange.bound([t],[t+1],!1,!0),r=ji(e);let s=Hn();return r.Y({range:n,J:!0},(e,t,n)=>{const r=Ee(e[1]),i=new G(r);s=s.add(i)}).next(()=>s)}containsKey(e,t){const n=Ie(t.path),r=IDBKeyRange.bound([n],[P(n)],!1,!0);let s=0;return ji(e).Y({index:"documentTargetsIndex",J:!0,range:r},([e,t],n,r)=>{0!==e&&(s++,r.done())}).next(()=>s>0)}_t(e,t){return $i(e).get(t).next(e=>e?Ws(e):null)}}function $i(e){return We(e,"targets")}function Qi(e){return We(e,"targetGlobal")}function ji(e){return We(e,"targetDocuments")}function Wi([e,t],[n,r]){const s=F(e,n);return 0===s?F(t,r):s}class Hi{constructor(e){this.Kn=e,this.buffer=new tt(Wi),this.$n=0}Un(){return++this.$n}Wn(e){const t=[e,this.Un()];if(this.buffer.size<this.Kn)this.buffer=this.buffer.add(t);else{const e=this.buffer.last();Wi(t,e)<0&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}}class Yi{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Gn=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.zn(6e4)}stop(){this.Gn&&(this.Gn.cancel(),this.Gn=null)}get started(){return null!==this.Gn}zn(e){d("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Gn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Gn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){ue(e)?d("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e):await re(e)}await this.zn(3e5)})}}class Ji{constructor(e,t){this.jn=e,this.params=t}calculateTargetCount(e,t){return this.jn.Hn(e).next(e=>Math.floor(t/100*e))}nthSequenceNumber(e,t){if(0===t)return se.resolve(ge._e);const n=new Hi(t);return this.jn.forEachTarget(e,e=>n.Wn(e.sequenceNumber)).next(()=>this.jn.Jn(e,e=>n.Wn(e))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.jn.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.jn.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(d("LruGarbageCollector","Garbage collection skipped; disabled"),se.resolve(Fi)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(d("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Fi):this.Yn(e,t))}getCacheSize(e){return this.jn.getCacheSize(e)}Yn(e,t){let n,s,i,o,a,c,u;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(t=>(t>this.params.maximumSequenceNumbersToCollect?(d("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${t}`),s=this.params.maximumSequenceNumbersToCollect):s=t,o=Date.now(),this.nthSequenceNumber(e,s))).next(r=>(n=r,a=Date.now(),this.removeTargets(e,n,t))).next(t=>(i=t,c=Date.now(),this.removeOrphanedDocuments(e,n))).next(e=>(u=Date.now(),l()<=r.LogLevel.DEBUG&&d("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${o-h}ms\n\tDetermined least recently used ${s} in `+(a-o)+"ms\n"+`\tRemoved ${i} targets in `+(c-a)+"ms\n"+`\tRemoved ${e} documents in `+(u-c)+"ms\n"+`Total Duration: ${u-h}ms`),se.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:e})))}}function Xi(e,t){return new Ji(e,t)}class Zi{constructor(e,t){this.db=e,this.garbageCollector=Xi(this,t)}Hn(e){const t=this.Zn(e);return this.db.getTargetCache().getTargetCount(e).next(e=>t.next(t=>e+t))}Zn(e){let t=0;return this.Jn(e,e=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Jn(e,t){return this.Xn(e,(e,n)=>t(n))}addReference(e,t,n){return eo(e,n)}removeReference(e,t,n){return eo(e,n)}removeTargets(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}markPotentiallyOrphaned(e,t){return eo(e,t)}er(e,t){return function(e,t){let n=!1;return zi(e).Z(r=>qi(e,r,t).next(e=>(e&&(n=!0),se.resolve(!e)))).next(()=>n)}(e,t)}removeOrphanedDocuments(e,t){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let s=0;return this.Xn(e,(i,o)=>{if(o<=t){const t=this.er(e,i).next(t=>{if(!t)return s++,n.getEntry(e,i).next(()=>(n.removeEntry(i,O.min()),ji(e).delete(function(e){return[0,Ie(e.path)]}(i))))});r.push(t)}}).next(()=>se.waitFor(r)).next(()=>n.apply(e)).next(()=>s)}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,t){return eo(e,t)}Xn(e,t){const n=ji(e);let r,s=ge._e;return n.Y({index:"documentTargetsIndex"},([e,n],{path:i,sequenceNumber:o})=>{0===e?(s!==ge._e&&t(new G(Ee(r)),s),s=o,r=i):s=ge._e}).next(()=>{s!==ge._e&&t(new G(Ee(r)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function eo(e,t){return ji(e).put(function(e,t){return{targetId:0,path:Ie(e.path),sequenceNumber:t}}(t,e.currentSequenceNumber))}class to{constructor(){this.changes=new On(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Bt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?se.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class no{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,n){return oo(e).put(n)}removeEntry(e,t,n){return oo(e).delete(function(e,t){const n=e.path.toArray();return[n.slice(0,n.length-2),n[n.length-2],Ks(t),n[n.length-1]]}(t,n))}updateMetadata(e,t){return this.getMetadata(e).next(n=>(n.byteSize+=t,this.tr(e,n)))}getEntry(e,t){let n=Bt.newInvalidDocument(t);return oo(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(ao(t))},(e,r)=>{n=this.nr(t,r)}).next(()=>n)}rr(e,t){let n={size:0,document:Bt.newInvalidDocument(t)};return oo(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(ao(t))},(e,r)=>{n={document:this.nr(t,r),size:Vi(r)}}).next(()=>n)}getEntries(e,t){let n=Un();return this.ir(e,t,(e,t)=>{const r=this.nr(e,t);n=n.insert(e,r)}).next(()=>n)}sr(e,t){let n=Un(),r=new Xe(G.comparator);return this.ir(e,t,(e,t)=>{const s=this.nr(e,t);n=n.insert(e,s),r=r.insert(e,Vi(t))}).next(()=>({documents:n,_r:r}))}ir(e,t,n){if(t.isEmpty())return se.resolve();let r=new tt(uo);t.forEach(e=>r=r.add(e));const s=IDBKeyRange.bound(ao(r.first()),ao(r.last())),i=r.getIterator();let o=i.getNext();return oo(e).Y({index:"documentKeyIndex",range:s},(e,t,r)=>{const s=G.fromSegments([...t.prefixPath,t.collectionGroup,t.documentId]);for(;o&&uo(o,s)<0;)n(o,null),o=i.getNext();o&&o.isEqual(s)&&(n(o,t),o=i.hasNext()?i.getNext():null),o?r.U(ao(o)):r.done()}).next(()=>{for(;o;)n(o,null),o=i.hasNext()?i.getNext():null})}getDocumentsMatchingQuery(e,t,n,r,s){const i=t.path,o=[i.popLast().toArray(),i.lastSegment(),Ks(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],a=[i.popLast().toArray(),i.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return oo(e).W(IDBKeyRange.bound(o,a,!0)).next(e=>{null==s||s.incrementDocumentReadCount(e.length);let n=Un();for(const s of e){const e=this.nr(G.fromSegments(s.prefixPath.concat(s.collectionGroup,s.documentId)),s);e.isFoundDocument()&&(Fn(t,e)||r.has(e.key))&&(n=n.insert(e.key,e))}return n})}getAllFromCollectionGroup(e,t,n,r){let s=Un();const i=co(t,n),o=co(t,Z.max());return oo(e).Y({index:"collectionGroupIndex",range:IDBKeyRange.bound(i,o,!0)},(e,t,n)=>{const i=this.nr(G.fromSegments(t.prefixPath.concat(t.collectionGroup,t.documentId)),t);(s=s.insert(i.key,i)).size===r&&n.done()}).next(()=>s)}newChangeBuffer(e){return new so(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(e=>e.byteSize)}getMetadata(e){return io(e).get("remoteDocumentGlobalKey").next(e=>(y(!!e),e))}tr(e,t){return io(e).put("remoteDocumentGlobalKey",t)}nr(e,t){if(t){const e=zs(this.serializer,t);if(!e.isNoDocument()||!e.version.isEqual(O.min()))return e}return Bt.newInvalidDocument(e)}}function ro(e){return new no(e)}class so extends to{constructor(e,t){super(),this.ar=e,this.trackRemovals=t,this.ur=new On(e=>e.toString(),(e,t)=>e.isEqual(t))}applyChanges(e){const t=[];let n=0,r=new tt((e,t)=>F(e.canonicalString(),t.canonicalString()));return this.changes.forEach((s,i)=>{const o=this.ur.get(s);if(t.push(this.ar.removeEntry(e,s,o.readTime)),i.isValidDocument()){const a=Gs(this.ar.serializer,i);r=r.add(s.path.popLast());const c=Vi(a);n+=c-o.size,t.push(this.ar.addEntry(e,s,a))}else if(n-=o.size,this.trackRemovals){const n=Gs(this.ar.serializer,i.convertToNoDocument(O.min()));t.push(this.ar.addEntry(e,s,n))}}),r.forEach(n=>{t.push(this.ar.indexManager.addToCollectionParentIndex(e,n))}),t.push(this.ar.updateMetadata(e,n)),se.waitFor(t)}getFromCache(e,t){return this.ar.rr(e,t).next(e=>(this.ur.set(t,{size:e.size,readTime:e.document.readTime}),e.document))}getAllFromCache(e,t){return this.ar.sr(e,t).next(({documents:e,_r:t})=>(t.forEach((t,n)=>{this.ur.set(t,{size:n,readTime:e.get(t).readTime})}),e))}}function io(e){return We(e,"remoteDocumentGlobal")}function oo(e){return We(e,"remoteDocumentsV14")}function ao(e){const t=e.path.toArray();return[t.slice(0,t.length-2),t[t.length-2],t[t.length-1]]}function co(e,t){const n=t.documentKey.path.toArray();return[e,Ks(t.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function uo(e,t){const n=e.path.toArray(),r=t.path.toArray();let s=0;for(let i=0;i<n.length-2&&i<r.length-2;++i)if(s=F(n[i],r[i]))return s;return(s=F(n.length,r.length))||((s=F(n[n.length-2],r[r.length-2]))||F(n[n.length-1],r[r.length-1]))}class lo{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class ho{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(n=r,this.remoteDocumentCache.getEntry(e,t))).next(e=>(null!==n&&_r(n.mutation,e,st.empty(),V.now()),e))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.getLocalViewOfDocuments(e,t,Hn()).next(()=>t))}getLocalViewOfDocuments(e,t,n=Hn()){const r=Kn();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,n).next(e=>{let t=zn();return e.forEach((e,n)=>{t=t.insert(e,n.overlayedDocument)}),t}))}getOverlayedDocuments(e,t){const n=Kn();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,Hn()))}populateOverlays(e,t,n){const r=[];return n.forEach(e=>{t.has(e)||r.push(e)}),this.documentOverlayCache.getOverlays(e,r).next(e=>{e.forEach((e,n)=>{t.set(e,n)})})}computeViews(e,t,n,r){let s=Un();const i=Qn(),o=Qn();return t.forEach((e,t)=>{const o=n.get(t.key);r.has(t.key)&&(void 0===o||o.mutation instanceof Tr)?s=s.insert(t.key,t):void 0!==o?(i.set(t.key,o.mutation.getFieldMask()),_r(o.mutation,t,o.mutation.getFieldMask(),V.now())):i.set(t.key,st.empty())}),this.recalculateAndSaveOverlays(e,s).next(e=>(e.forEach((e,t)=>i.set(e,t)),t.forEach((e,t)=>{var n;return o.set(e,new lo(t,null!==(n=i.get(e))&&void 0!==n?n:null))}),o))}recalculateAndSaveOverlays(e,t){const n=Qn();let r=new Xe((e,t)=>e-t),s=Hn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(e=>{for(const s of e)s.keys().forEach(e=>{const i=t.get(e);if(null===i)return;let o=n.get(e)||st.empty();o=s.applyToLocalView(i,o),n.set(e,o);const a=(r.get(s.batchId)||Hn()).add(e);r=r.insert(s.batchId,a)})}).next(()=>{const i=[],o=r.getReverseIterator();for(;o.hasNext();){const r=o.getNext(),a=r.key,c=r.value,u=$n();c.forEach(e=>{if(!s.has(e)){const r=vr(t.get(e),n.get(e));null!==r&&u.set(e,r),s=s.add(e)}}),i.push(this.documentOverlayCache.saveOverlays(e,a,u))}return se.waitFor(i)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.recalculateAndSaveOverlays(e,t))}getDocumentsMatchingQuery(e,t,n,r){return function(e){return G.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Tn(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next(s=>{const i=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-s.size):se.resolve(Kn());let o=-1,a=s;return i.next(t=>se.forEach(t,(t,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),s.get(t)?se.resolve():this.remoteDocumentCache.getEntry(e,t).next(e=>{a=a.insert(t,e)}))).next(()=>this.populateOverlays(e,t,s)).next(()=>this.computeViews(e,a,t,Hn())).next(e=>({batchId:o,changes:Gn(e)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new G(t)).next(e=>{let t=zn();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){const s=t.collectionGroup;let i=zn();return this.indexManager.getCollectionParents(e,s).next(o=>se.forEach(o,o=>{const a=function(e,t){return new _n(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,o.child(s));return this.getDocumentsMatchingCollectionQuery(e,a,n,r).next(e=>{e.forEach((e,t)=>{i=i.insert(e,t)})})}).next(()=>i))}getDocumentsMatchingCollectionQuery(e,t,n,r){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(i=>(s=i,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,s,r))).next(e=>{s.forEach((t,n)=>{const r=n.getKey();null===e.get(r)&&(e=e.insert(r,Bt.newInvalidDocument(r)))});let n=zn();return e.forEach((e,r)=>{const i=s.get(e);void 0!==i&&_r(i.mutation,r,st.empty(),V.now()),Fn(t,r)&&(n=n.insert(e,r))}),n})}}class fo{constructor(e){this.serializer=e,this.cr=new Map,this.lr=new Map}getBundleMetadata(e,t){return se.resolve(this.cr.get(t))}saveBundleMetadata(e,t){return this.cr.set(t.id,function(e){return{id:e.id,version:e.version,createTime:ls(e.createTime)}}(t)),se.resolve()}getNamedQuery(e,t){return se.resolve(this.lr.get(t))}saveNamedQuery(e,t){return this.lr.set(t.name,function(e){return{name:e.name,query:Ys(e.bundledQuery),readTime:ls(e.readTime)}}(t)),se.resolve()}}class mo{constructor(){this.overlays=new Xe(G.comparator),this.hr=new Map}getOverlay(e,t){return se.resolve(this.overlays.get(t))}getOverlays(e,t){const n=Kn();return se.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&n.set(t,e)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((n,r)=>{this.ht(e,t,r)}),se.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.hr.get(n);return void 0!==r&&(r.forEach(e=>this.overlays=this.overlays.remove(e)),this.hr.delete(n)),se.resolve()}getOverlaysForCollection(e,t,n){const r=Kn(),s=t.length+1,i=new G(t.child("")),o=this.overlays.getIteratorFrom(i);for(;o.hasNext();){const e=o.getNext().value,i=e.getKey();if(!t.isPrefixOf(i.path))break;i.path.length===s&&e.largestBatchId>n&&r.set(e.getKey(),e)}return se.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let s=new Xe((e,t)=>e-t);const i=this.overlays.getIterator();for(;i.hasNext();){const e=i.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=s.get(e.largestBatchId);null===t&&(t=Kn(),s=s.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const o=Kn(),a=s.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach((e,t)=>o.set(e,t)),!(o.size()>=r)););return se.resolve(o)}ht(e,t,n){const r=this.overlays.get(n.key);if(null!==r){const e=this.hr.get(r.largestBatchId).delete(n.key);this.hr.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new Lr(t,n));let s=this.hr.get(t);void 0===s&&(s=Hn(),this.hr.set(t,s)),this.hr.set(t,s.add(n.key))}}class po{constructor(){this.Pr=new tt(go.Ir),this.Tr=new tt(go.Er)}isEmpty(){return this.Pr.isEmpty()}addReference(e,t){const n=new go(e,t);this.Pr=this.Pr.add(n),this.Tr=this.Tr.add(n)}dr(e,t){e.forEach(e=>this.addReference(e,t))}removeReference(e,t){this.Ar(new go(e,t))}Rr(e,t){e.forEach(e=>this.removeReference(e,t))}Vr(e){const t=new G(new U([])),n=new go(t,e),r=new go(t,e+1),s=[];return this.Tr.forEachInRange([n,r],e=>{this.Ar(e),s.push(e.key)}),s}mr(){this.Pr.forEach(e=>this.Ar(e))}Ar(e){this.Pr=this.Pr.delete(e),this.Tr=this.Tr.delete(e)}gr(e){const t=new G(new U([])),n=new go(t,e),r=new go(t,e+1);let s=Hn();return this.Tr.forEachInRange([n,r],e=>{s=s.add(e.key)}),s}containsKey(e){const t=new go(e,0),n=this.Pr.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class go{constructor(e,t){this.key=e,this.pr=t}static Ir(e,t){return G.comparator(e.key,t.key)||F(e.pr,t.pr)}static Er(e,t){return F(e.pr,t.pr)||G.comparator(e.key,t.key)}}class yo{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.yr=1,this.wr=new tt(go.Ir)}checkEmpty(e){return se.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){const s=this.yr;this.yr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const i=new kr(s,t,n,r);this.mutationQueue.push(i);for(const o of r)this.wr=this.wr.add(new go(o.key,s)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return se.resolve(i)}lookupMutationBatch(e,t){return se.resolve(this.Sr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.br(n),s=r<0?0:r;return se.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return se.resolve(0===this.mutationQueue.length?-1:this.yr-1)}getAllMutationBatches(e){return se.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new go(t,0),r=new go(t,Number.POSITIVE_INFINITY),s=[];return this.wr.forEachInRange([n,r],e=>{const t=this.Sr(e.pr);s.push(t)}),se.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new tt(F);return t.forEach(e=>{const t=new go(e,0),r=new go(e,Number.POSITIVE_INFINITY);this.wr.forEachInRange([t,r],e=>{n=n.add(e.pr)})}),se.resolve(this.Dr(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let s=n;G.isDocumentKey(s)||(s=s.child(""));const i=new go(new G(s),0);let o=new tt(F);return this.wr.forEachWhile(e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e.pr)),!0)},i),se.resolve(this.Dr(o))}Dr(e){const t=[];return e.forEach(e=>{const n=this.Sr(e);null!==n&&t.push(n)}),t}removeMutationBatch(e,t){y(0===this.Cr(t.batchId,"removed")),this.mutationQueue.shift();let n=this.wr;return se.forEach(t.mutations,r=>{const s=new go(r.key,t.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.wr=n})}Mn(e){}containsKey(e,t){const n=new go(t,0),r=this.wr.firstAfterOrEqual(n);return se.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,se.resolve()}Cr(e,t){return this.br(e)}br(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Sr(e){const t=this.br(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class wo{constructor(e){this.vr=e,this.docs=new Xe(G.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),s=r?r.size:0,i=this.vr(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:i}),this.size+=i-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return se.resolve(n?n.document.mutableCopy():Bt.newInvalidDocument(t))}getEntries(e,t){let n=Un();return t.forEach(e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():Bt.newInvalidDocument(e))}),se.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let s=Un();const i=t.path,o=new G(i.child("")),a=this.docs.getIteratorFrom(o);for(;a.hasNext();){const{key:e,value:{document:o}}=a.getNext();if(!i.isPrefixOf(e.path))break;e.path.length>i.length+1||ee(X(o),n)<=0||(r.has(o.key)||Fn(t,o))&&(s=s.insert(o.key,o.mutableCopy()))}return se.resolve(s)}getAllFromCollectionGroup(e,t,n,r){g()}Fr(e,t){return se.forEach(this.docs,e=>t(e))}newChangeBuffer(e){return new vo(this)}getSize(e){return se.resolve(this.size)}}class vo extends to{constructor(e){super(),this.ar=e}applyChanges(e){const t=[];return this.changes.forEach((n,r)=>{r.isValidDocument()?t.push(this.ar.addEntry(e,r)):this.ar.removeEntry(n)}),se.waitFor(t)}getFromCache(e,t){return this.ar.getEntry(e,t)}getAllFromCache(e,t){return this.ar.getEntries(e,t)}}class Io{constructor(e){this.persistence=e,this.Mr=new On(e=>pn(e),gn),this.lastRemoteSnapshotVersion=O.min(),this.highestTargetId=0,this.Or=0,this.Nr=new po,this.targetCount=0,this.Br=Gi.Nn()}forEachTarget(e,t){return this.Mr.forEach((e,n)=>t(n)),se.resolve()}getLastRemoteSnapshotVersion(e){return se.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return se.resolve(this.Or)}allocateTargetId(e){return this.highestTargetId=this.Br.next(),se.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Or&&(this.Or=t),se.resolve()}qn(e){this.Mr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Br=new Gi(t),this.highestTargetId=t),e.sequenceNumber>this.Or&&(this.Or=e.sequenceNumber)}addTargetData(e,t){return this.qn(t),this.targetCount+=1,se.resolve()}updateTargetData(e,t){return this.qn(t),se.resolve()}removeTargetData(e,t){return this.Mr.delete(t.target),this.Nr.Vr(t.targetId),this.targetCount-=1,se.resolve()}removeTargets(e,t,n){let r=0;const s=[];return this.Mr.forEach((i,o)=>{o.sequenceNumber<=t&&null===n.get(o.targetId)&&(this.Mr.delete(i),s.push(this.removeMatchingKeysForTargetId(e,o.targetId)),r++)}),se.waitFor(s).next(()=>r)}getTargetCount(e){return se.resolve(this.targetCount)}getTargetData(e,t){const n=this.Mr.get(t)||null;return se.resolve(n)}addMatchingKeys(e,t,n){return this.Nr.dr(t,n),se.resolve()}removeMatchingKeys(e,t,n){this.Nr.Rr(t,n);const r=this.persistence.referenceDelegate,s=[];return r&&t.forEach(t=>{s.push(r.markPotentiallyOrphaned(e,t))}),se.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Nr.Vr(t),se.resolve()}getMatchingKeysForTargetId(e,t){const n=this.Nr.gr(t);return se.resolve(n)}containsKey(e,t){return se.resolve(this.Nr.containsKey(t))}}class _o{constructor(e,t){this.Lr={},this.overlays={},this.kr=new ge(0),this.qr=!1,this.qr=!0,this.referenceDelegate=e(this),this.Qr=new Io(this),this.indexManager=new Ti,this.remoteDocumentCache=function(e){return new wo(e)}(e=>this.referenceDelegate.Kr(e)),this.serializer=new Bs(t),this.$r=new fo(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new mo,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.Lr[e.toKey()];return n||(n=new yo(t,this.referenceDelegate),this.Lr[e.toKey()]=n),n}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction(e,t,n){d("MemoryPersistence","Starting transaction:",e);const r=new bo(this.kr.next());return this.referenceDelegate.Ur(),n(r).next(e=>this.referenceDelegate.Wr(r).next(()=>e)).toPromise().then(e=>(r.raiseOnCommittedEvent(),e))}Gr(e,t){return se.or(Object.values(this.Lr).map(n=>()=>n.containsKey(e,t)))}}class bo extends ne{constructor(e){super(),this.currentSequenceNumber=e}}class Eo{constructor(e){this.persistence=e,this.zr=new po,this.jr=null}static Hr(e){return new Eo(e)}get Jr(){if(this.jr)return this.jr;throw g()}addReference(e,t,n){return this.zr.addReference(n,t),this.Jr.delete(n.toString()),se.resolve()}removeReference(e,t,n){return this.zr.removeReference(n,t),this.Jr.add(n.toString()),se.resolve()}markPotentiallyOrphaned(e,t){return this.Jr.add(t.toString()),se.resolve()}removeTarget(e,t){this.zr.Vr(t.targetId).forEach(e=>this.Jr.add(e.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(e=>{e.forEach(e=>this.Jr.add(e.toString()))}).next(()=>n.removeTargetData(e,t))}Ur(){this.jr=new Set}Wr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return se.forEach(this.Jr,n=>{const r=G.fromPath(n);return this.Yr(e,r).next(e=>{e||t.removeEntry(r,O.min())})}).next(()=>(this.jr=null,t.apply(e)))}updateLimboDocument(e,t){return this.Yr(e,t).next(e=>{e?this.Jr.delete(t.toString()):this.Jr.add(t.toString())})}Kr(e){return 0}Yr(e,t){return se.or([()=>se.resolve(this.zr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Gr(e,t)])}}class xo{constructor(e,t){this.persistence=e,this.Zr=new On(e=>Ie(e.path),(e,t)=>e.isEqual(t)),this.garbageCollector=Xi(this,t)}static Hr(e,t){return new xo(e,t)}Ur(){}Wr(e){return se.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}Hn(e){const t=this.Zn(e);return this.persistence.getTargetCache().getTargetCount(e).next(e=>t.next(t=>e+t))}Zn(e){let t=0;return this.Jn(e,e=>{t++}).next(()=>t)}Jn(e,t){return se.forEach(this.Zr,(n,r)=>this.er(e,n,r).next(e=>e?se.resolve():t(r)))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const r=this.persistence.getRemoteDocumentCache(),s=r.newChangeBuffer();return r.Fr(e,r=>this.er(e,r,t).next(e=>{e||(n++,s.removeEntry(r,O.min()))})).next(()=>s.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,t){return this.Zr.set(t,e.currentSequenceNumber),se.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.Zr.set(n,e.currentSequenceNumber),se.resolve()}removeReference(e,t,n){return this.Zr.set(n,e.currentSequenceNumber),se.resolve()}updateLimboDocument(e,t){return this.Zr.set(t,e.currentSequenceNumber),se.resolve()}Kr(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=St(e.data.value)),t}er(e,t,n){return se.or([()=>this.persistence.Gr(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const e=this.Zr.get(t);return se.resolve(void 0!==e&&e>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class To{constructor(e){this.serializer=e}N(e,t,n,r){const s=new ie("createOrUpgrade",t);n<1&&r>=1&&(function(e){e.createObjectStore("owner")}(e),function(e){e.createObjectStore("mutationQueues",{keyPath:"userId"}),e.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",xe,{unique:!0}),e.createObjectStore("documentMutations")}(e),So(e),function(e){e.createObjectStore("remoteDocuments")}(e));let i=se.resolve();return n<3&&r>=3&&(0!==n&&(function(e){e.deleteObjectStore("targetDocuments"),e.deleteObjectStore("targets"),e.deleteObjectStore("targetGlobal")}(e),So(e)),i=i.next(()=>(function(e){const t=e.store("targetGlobal"),n={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:O.min().toTimestamp(),targetCount:0};return t.put("targetGlobalKey",n)})(s))),n<4&&r>=4&&(0!==n&&(i=i.next(()=>(function(e,t){return t.store("mutations").W().next(n=>{e.deleteObjectStore("mutations"),e.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",xe,{unique:!0});const r=t.store("mutations"),s=n.map(e=>r.put(e));return se.waitFor(s)})})(e,s))),i=i.next(()=>{!function(e){e.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)})),n<5&&r>=5&&(i=i.next(()=>this.Xr(s))),n<6&&r>=6&&(i=i.next(()=>(function(e){e.createObjectStore("remoteDocumentGlobal")}(e),this.ei(s)))),n<7&&r>=7&&(i=i.next(()=>this.ti(s))),n<8&&r>=8&&(i=i.next(()=>this.ni(e,s))),n<9&&r>=9&&(i=i.next(()=>{!function(e){e.objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges")}(e)})),n<10&&r>=10&&(i=i.next(()=>this.ri(s))),n<11&&r>=11&&(i=i.next(()=>{!function(e){e.createObjectStore("bundles",{keyPath:"bundleId"})}(e),function(e){e.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),n<12&&r>=12&&(i=i.next(()=>{!function(e){const t=e.createObjectStore("documentOverlays",{keyPath:qe});t.createIndex("collectionPathOverlayIndex",Ue,{unique:!1}),t.createIndex("collectionGroupOverlayIndex",Be,{unique:!1})}(e)})),n<13&&r>=13&&(i=i.next(()=>(function(e){const t=e.createObjectStore("remoteDocumentsV14",{keyPath:De});t.createIndex("documentKeyIndex",Ne),t.createIndex("collectionGroupIndex",Ae)})(e)).next(()=>this.ii(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),n<14&&r>=14&&(i=i.next(()=>this.si(e,s))),n<15&&r>=15&&(i=i.next(()=>(function(e){e.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),e.createObjectStore("indexState",{keyPath:Re}).createIndex("sequenceNumberIndex",Pe,{unique:!1}),e.createObjectStore("indexEntries",{keyPath:Ve}).createIndex("documentKeyIndex",Oe,{unique:!1})})(e))),i}ei(e){let t=0;return e.store("remoteDocuments").Y((e,n)=>{t+=Vi(n)}).next(()=>{const n={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",n)})}Xr(e){const t=e.store("mutationQueues"),n=e.store("mutations");return t.W().next(t=>se.forEach(t,t=>{const r=IDBKeyRange.bound([t.userId,-1],[t.userId,t.lastAcknowledgedBatchId]);return n.W("userMutationsIndex",r).next(n=>se.forEach(n,n=>{y(n.userId===t.userId);const r=js(this.serializer,n);return Pi(e,t.userId,r).next(()=>{})}))}))}ti(e){const t=e.store("targetDocuments"),n=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(e=>{const r=[];return n.Y((n,s)=>{const i=new U(n),o=function(e){return[0,Ie(e)]}(i);r.push(t.get(o).next(n=>n?se.resolve():(n=>t.put({targetId:0,path:Ie(n),sequenceNumber:e.highestListenSequenceNumber}))(i)))}).next(()=>se.waitFor(r))})}ni(e,t){e.createObjectStore("collectionParents",{keyPath:Fe});const n=t.store("collectionParents"),r=new Si,s=e=>{if(r.add(e)){const t=e.lastSegment(),r=e.popLast();return n.put({collectionId:t,parent:Ie(r)})}};return t.store("remoteDocuments").Y({J:!0},(e,t)=>{const n=new U(e);return s(n.popLast())}).next(()=>t.store("documentMutations").Y({J:!0},([e,t,n],r)=>{const i=Ee(t);return s(i.popLast())}))}ri(e){const t=e.store("targets");return t.Y((e,n)=>{const r=Ws(n),s=Hs(this.serializer,r);return t.put(s)})}ii(e,t){const n=t.store("remoteDocuments"),r=[];return n.Y((e,n)=>{const s=t.store("remoteDocumentsV14"),i=function(e){return e.document?new G(U.fromString(e.document.name).popFirst(5)):e.noDocument?G.fromSegments(e.noDocument.path):e.unknownDocument?G.fromSegments(e.unknownDocument.path):g()}(n).path.toArray(),o={prefixPath:i.slice(0,i.length-2),collectionGroup:i[i.length-2],documentId:i[i.length-1],readTime:n.readTime||[0,0],unknownDocument:n.unknownDocument,noDocument:n.noDocument,document:n.document,hasCommittedMutations:!!n.hasCommittedMutations};r.push(s.put(o))}).next(()=>se.waitFor(r))}si(e,t){const n=t.store("mutations"),r=ro(this.serializer),s=new _o(Eo.Hr,this.serializer.ct);return n.W().next(e=>{const n=new Map;return e.forEach(e=>{var t;let r=null!==(t=n.get(e.userId))&&void 0!==t?t:Hn();js(this.serializer,e).keys().forEach(e=>r=r.add(e)),n.set(e.userId,r)}),se.forEach(n,(e,n)=>{const i=new a(n),o=ri.lt(this.serializer,i),c=s.getIndexManager(i),u=Oi.lt(i,this.serializer,c,s.referenceDelegate);return new ho(r,u,o,c).recalculateAndSaveOverlaysForDocumentKeys(new je(t,ge._e),e).next()})})}}function So(e){e.createObjectStore("targetDocuments",{keyPath:Me}).createIndex("documentTargetsIndex",Le,{unique:!0}),e.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",ke,{unique:!0}),e.createObjectStore("targetGlobal")}const Co="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class Do{constructor(e,t,n,r,s,i,o,a,c,u,l=15){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=n,this.oi=s,this.window=i,this.document=o,this._i=c,this.ai=u,this.ui=l,this.kr=null,this.qr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ci=null,this.inForeground=!1,this.li=null,this.hi=null,this.Pi=Number.NEGATIVE_INFINITY,this.Ii=(e=>Promise.resolve()),!Do.D())throw new _(I.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Zi(this,r),this.Ti=t+"main",this.serializer=new Bs(a),this.Ei=new oe(this.Ti,this.ui,new To(this.serializer)),this.Qr=new Ki(this.referenceDelegate,this.serializer),this.remoteDocumentCache=ro(this.serializer),this.$r=new ei,this.window&&this.window.localStorage?this.di=this.window.localStorage:(this.di=null,!1===u&&f("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Ai().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new _(I.FAILED_PRECONDITION,Co);return this.Ri(),this.Vi(),this.mi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Qr.getHighestSequenceNumber(e))}).then(e=>{this.kr=new ge(e,this._i)}).then(()=>{this.qr=!0}).catch(e=>(this.Ei&&this.Ei.close(),Promise.reject(e)))}fi(e){return this.Ii=(async t=>{if(this.started)return e(t)}),e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ei.L(async t=>{null===t.newVersion&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.oi.enqueueAndForget(async()=>{this.started&&await this.Ai()}))}Ai(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Ao(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.gi(e).next(e=>{e||(this.isPrimary=!1,this.oi.enqueueRetryable(()=>this.Ii(!1)))})}).next(()=>this.pi(e)).next(t=>this.isPrimary&&!t?this.yi(e).next(()=>!1):!!t&&this.wi(e).next(()=>!0))).catch(e=>{if(ue(e))return d("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return d("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.oi.enqueueRetryable(()=>this.Ii(e)),this.isPrimary=e})}gi(e){return No(e).get("owner").next(e=>se.resolve(this.Si(e)))}bi(e){return Ao(e).delete(this.clientId)}async Di(){if(this.isPrimary&&!this.Ci(this.Pi,18e5)){this.Pi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",e=>{const t=We(e,"clientMetadata");return t.W().next(e=>{const n=this.vi(e,18e5),r=e.filter(e=>-1===n.indexOf(e));return se.forEach(r,e=>t.delete(e.clientId)).next(()=>r)})}).catch(()=>[]);if(this.di)for(const t of e)this.di.removeItem(this.Fi(t.clientId))}}mi(){this.hi=this.oi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Ai().then(()=>this.Di()).then(()=>this.mi()))}Si(e){return!!e&&e.ownerId===this.clientId}pi(e){return this.ai?se.resolve(!0):No(e).get("owner").next(t=>{if(null!==t&&this.Ci(t.leaseTimestampMs,5e3)&&!this.Mi(t.ownerId)){if(this.Si(t)&&this.networkEnabled)return!0;if(!this.Si(t)){if(!t.allowTabSynchronization)throw new _(I.FAILED_PRECONDITION,Co);return!1}}return!(!this.networkEnabled||!this.inForeground)||Ao(e).W().next(e=>void 0===this.vi(e,5e3).find(e=>{if(this.clientId!==e.clientId){const t=!this.networkEnabled&&e.networkEnabled,n=!this.inForeground&&e.inForeground,r=this.networkEnabled===e.networkEnabled;if(t||n&&r)return!0}return!1}))}).next(e=>(this.isPrimary!==e&&d("IndexedDbPersistence",`Client ${e?"is":"is not"} eligible for a primary lease.`),e))}async shutdown(){this.qr=!1,this.xi(),this.hi&&(this.hi.cancel(),this.hi=null),this.Oi(),this.Ni(),await this.Ei.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const t=new je(e,ge._e);return this.yi(t).next(()=>this.bi(t))}),this.Ei.close(),this.Bi()}vi(e,t){return e.filter(e=>this.Ci(e.updateTimeMs,t)&&!this.Mi(e.clientId))}Li(){return this.runTransaction("getActiveClients","readonly",e=>Ao(e).W().next(e=>this.vi(e,18e5).map(e=>e.clientId)))}get started(){return this.qr}getMutationQueue(e,t){return Oi.lt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new Di(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return ri.lt(this.serializer,e)}getBundleCache(){return this.$r}runTransaction(e,t,n){d("IndexedDbPersistence","Starting transaction:",e);const r="readonly"===t?"readonly":"readwrite",s=function(e){return 15===e?Qe:14===e?$e:13===e?Ke:12===e?Ge:11===e?ze:void g()}(this.ui);let i;return this.Ei.runTransaction(e,r,s,r=>(i=new je(r,this.kr?this.kr.next():ge._e),"readwrite-primary"===t?this.gi(i).next(e=>!!e||this.pi(i)).next(t=>{if(!t)throw f(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.oi.enqueueRetryable(()=>this.Ii(!1)),new _(I.FAILED_PRECONDITION,te);return n(i)}).next(e=>this.wi(i).next(()=>e)):this.ki(i).next(()=>n(i)))).then(e=>(i.raiseOnCommittedEvent(),e))}ki(e){return No(e).get("owner").next(e=>{if(null!==e&&this.Ci(e.leaseTimestampMs,5e3)&&!this.Mi(e.ownerId)&&!this.Si(e)&&!(this.ai||this.allowTabSynchronization&&e.allowTabSynchronization))throw new _(I.FAILED_PRECONDITION,Co)})}wi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return No(e).put("owner",t)}static D(){return oe.D()}yi(e){const t=No(e);return t.get("owner").next(e=>this.Si(e)?(d("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):se.resolve())}Ci(e,t){const n=Date.now();return!(e<n-t||e>n&&(f(`Detected an update time that is in the future: ${e} > ${n}`),1))}Ri(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.li=(()=>{this.oi.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.Ai()))}),this.document.addEventListener("visibilitychange",this.li),this.inForeground="visible"===this.document.visibilityState)}Oi(){this.li&&(this.document.removeEventListener("visibilitychange",this.li),this.li=null)}Vi(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.ci=(()=>{this.xi();const e=/(?:Version|Mobile)\/1[456]/;(0,s.isSafari)()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.oi.enterRestrictedMode(!0),this.oi.enqueueAndForget(()=>this.shutdown())}),this.window.addEventListener("pagehide",this.ci))}Ni(){this.ci&&(this.window.removeEventListener("pagehide",this.ci),this.ci=null)}Mi(e){var t;try{const n=null!==(null===(t=this.di)||void 0===t?void 0:t.getItem(this.Fi(e)));return d("IndexedDbPersistence",`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(e){return f("IndexedDbPersistence","Failed to get zombied client id.",e),!1}}xi(){if(this.di)try{this.di.setItem(this.Fi(this.clientId),String(Date.now()))}catch(e){f("Failed to set zombie client id.",e)}}Bi(){if(this.di)try{this.di.removeItem(this.Fi(this.clientId))}catch(e){}}Fi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function No(e){return We(e,"owner")}function Ao(e){return We(e,"clientMetadata")}function ko(e,t){let n=e.projectId;return e.isDefaultDatabase||(n+="."+e.database),"firestore/"+t+"/"+n+"/"}class Mo{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.qi=n,this.Qi=r}static Ki(e,t){let n=Hn(),r=Hn();for(const s of t.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}return new Mo(e,t.fromCache,n,r)}}class Lo{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class Fo{constructor(){this.$i=!1,this.Ui=!1,this.Wi=100,this.Gi=(0,s.isSafari)()?8:oe.v((0,s.getUA)())>0?6:4}initialize(e,t){this.zi=e,this.indexManager=t,this.$i=!0}getDocumentsMatchingQuery(e,t,n,r){const s={result:null};return this.ji(e,t).next(e=>{s.result=e}).next(()=>{if(!s.result)return this.Hi(e,t,r,n).next(e=>{s.result=e})}).next(()=>{if(s.result)return;const n=new Lo;return this.Ji(e,t,n).next(r=>{if(s.result=r,this.Ui)return this.Yi(e,t,n,r.size)})}).next(()=>s.result)}Yi(e,t,n,s){return n.documentReadCount<this.Wi?(l()<=r.LogLevel.DEBUG&&d("QueryEngine","SDK will not create cache indexes for query:",Ln(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Wi,"documents"),se.resolve()):(l()<=r.LogLevel.DEBUG&&d("QueryEngine","Query:",Ln(t),"scans",n.documentReadCount,"local documents and returns",s,"documents as results."),n.documentReadCount>this.Gi*s?(l()<=r.LogLevel.DEBUG&&d("QueryEngine","The SDK decides to create cache indexes for query:",Ln(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Cn(t))):se.resolve())}ji(e,t){if(xn(t))return se.resolve(null);let n=Cn(t);return this.indexManager.getIndexType(e,n).next(r=>0===r?null:(null!==t.limit&&1===r&&(t=An(t,null,"F"),n=Cn(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(r=>{const s=Hn(...r);return this.zi.getDocuments(e,s).next(r=>this.indexManager.getMinOffset(e,n).next(n=>{const i=this.Zi(t,r);return this.Xi(t,i,s,n.readTime)?this.ji(e,An(t,null,"F")):this.es(e,i,t,n)}))})))}Hi(e,t,n,s){return xn(t)||s.isEqual(O.min())?se.resolve(null):this.zi.getDocuments(e,n).next(i=>{const o=this.Zi(t,i);return this.Xi(t,o,n,s)?se.resolve(null):(l()<=r.LogLevel.DEBUG&&d("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Ln(t)),this.es(e,o,t,J(s,-1)).next(e=>e))})}Zi(e,t){let n=new tt(Pn(e));return t.forEach((t,r)=>{Fn(e,r)&&(n=n.add(r))}),n}Xi(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const s="F"===e.limitType?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}Ji(e,t,n){return l()<=r.LogLevel.DEBUG&&d("QueryEngine","Using full collection scan to execute query:",Ln(t)),this.zi.getDocumentsMatchingQuery(e,t,Z.min(),n)}es(e,t,n,r){return this.zi.getDocumentsMatchingQuery(e,n,r).next(e=>(t.forEach(t=>{e=e.insert(t.key,t)}),e))}}class Ro{constructor(e,t,n,r){this.persistence=e,this.ts=t,this.serializer=r,this.ns=new Xe(F),this.rs=new On(e=>pn(e),gn),this.ss=new Map,this.os=e.getRemoteDocumentCache(),this.Qr=e.getTargetCache(),this.$r=e.getBundleCache(),this._s(n)}_s(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new ho(this.os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.os.setIndexManager(this.indexManager),this.ts.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.ns))}}function Po(e,t,n,r){return new Ro(e,t,n,r)}async function Vo(e,t){const n=v(e);return await n.persistence.runTransaction("Handle user change","readonly",e=>{let r;return n.mutationQueue.getAllMutationBatches(e).next(s=>(r=s,n._s(t),n.mutationQueue.getAllMutationBatches(e))).next(t=>{const s=[],i=[];let o=Hn();for(const e of r){s.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}for(const e of t){i.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}return n.localDocuments.getDocuments(e,o).next(e=>({us:e,removedBatchIds:s,addedBatchIds:i}))})})}function Oo(e,t){const n=v(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",e=>{const r=t.batch.keys(),s=n.os.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){const s=n.batch,i=s.keys();let o=se.resolve();return i.forEach(e=>{o=o.next(()=>r.getEntry(t,e)).next(t=>{const i=n.docVersions.get(e);y(null!==i),t.version.compareTo(i)<0&&(s.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))})}),o.next(()=>e.mutationQueue.removeMutationBatch(t,s))}(n,e,t,s).next(()=>s.apply(e)).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=Hn();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t))).next(()=>n.localDocuments.getDocuments(e,r))})}function qo(e){const t=v(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.Qr.getLastRemoteSnapshotVersion(e))}function Uo(e,t){const n=v(e),r=t.snapshotVersion;let s=n.ns;return n.persistence.runTransaction("Apply remote event","readwrite-primary",e=>{const i=n.os.newChangeBuffer({trackRemovals:!0});s=n.ns;const o=[];t.targetChanges.forEach((i,a)=>{const c=s.get(a);if(!c)return;o.push(n.Qr.removeMatchingKeys(e,i.removedDocuments,a).next(()=>n.Qr.addMatchingKeys(e,i.addedDocuments,a)));let u=c.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(a)?u=u.withResumeToken(at.EMPTY_BYTE_STRING,O.min()).withLastLimboFreeSnapshotVersion(O.min()):i.resumeToken.approximateByteSize()>0&&(u=u.withResumeToken(i.resumeToken,r)),s=s.insert(a,u),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||(t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0)}(c,u,i)&&o.push(n.Qr.updateTargetData(e,u))});let a=Un(),c=Hn();if(t.documentUpdates.forEach(r=>{t.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))}),o.push(Bo(e,i,t.documentUpdates).next(e=>{a=e.cs,c=e.ls})),!r.isEqual(O.min())){const t=n.Qr.getLastRemoteSnapshotVersion(e).next(t=>n.Qr.setTargetsMetadata(e,e.currentSequenceNumber,r));o.push(t)}return se.waitFor(o).next(()=>i.apply(e)).next(()=>n.localDocuments.getLocalViewOfDocuments(e,a,c)).next(()=>a)}).then(e=>(n.ns=s,e))}function Bo(e,t,n){let r=Hn(),s=Hn();return n.forEach(e=>r=r.add(e)),t.getEntries(e,r).next(e=>{let r=Un();return n.forEach((n,i)=>{const o=e.get(n);i.isFoundDocument()!==o.isFoundDocument()&&(s=s.add(n)),i.isNoDocument()&&i.version.isEqual(O.min())?(t.removeEntry(n,i.readTime),r=r.insert(n,i)):!o.isValidDocument()||i.version.compareTo(o.version)>0||0===i.version.compareTo(o.version)&&o.hasPendingWrites?(t.addEntry(i),r=r.insert(n,i)):d("LocalStore","Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",i.version)}),{cs:r,ls:s}})}function zo(e,t){const n=v(e);return n.persistence.runTransaction("Get next mutation batch","readonly",e=>(void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t)))}function Go(e,t){const n=v(e);return n.persistence.runTransaction("Allocate target","readwrite",e=>{let r;return n.Qr.getTargetData(e,t).next(s=>s?(r=s,se.resolve(r)):n.Qr.allocateTargetId(e).next(s=>(r=new Us(t,s,"TargetPurposeListen",e.currentSequenceNumber),n.Qr.addTargetData(e,r).next(()=>r))))}).then(e=>{const r=n.ns.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.ns=n.ns.insert(e.targetId,e),n.rs.set(t,e.targetId)),e})}async function Ko(e,t,n){const r=v(e),s=r.ns.get(t),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,e=>r.persistence.referenceDelegate.removeTarget(e,s))}catch(e){if(!ue(e))throw e;d("LocalStore",`Failed to update sequence numbers for target ${t}: ${e}`)}r.ns=r.ns.remove(t),r.rs.delete(s.target)}function $o(e,t,n){const r=v(e);let s=O.min(),i=Hn();return r.persistence.runTransaction("Execute query","readwrite",e=>(function(e,t,n){const r=v(e),s=r.rs.get(n);return void 0!==s?se.resolve(r.ns.get(s)):r.Qr.getTargetData(t,n)})(r,e,Cn(t)).next(t=>{if(t)return s=t.lastLimboFreeSnapshotVersion,r.Qr.getMatchingKeysForTargetId(e,t.targetId).next(e=>{i=e})}).next(()=>r.ts.getDocumentsMatchingQuery(e,t,n?s:O.min(),n?i:Hn())).next(e=>(Wo(r,Rn(t),e),{documents:e,hs:i})))}function Qo(e,t){const n=v(e),r=v(n.Qr),s=n.ns.get(t);return s?Promise.resolve(s.target):n.persistence.runTransaction("Get target data","readonly",e=>r._t(e,t).next(e=>e?e.target:null))}function jo(e,t){const n=v(e),r=n.ss.get(t)||O.min();return n.persistence.runTransaction("Get new document changes","readonly",e=>n.os.getAllFromCollectionGroup(e,t,J(r,-1),Number.MAX_SAFE_INTEGER)).then(e=>(Wo(n,t,e),e))}function Wo(e,t,n){let r=e.ss.get(t)||O.min();n.forEach((e,t)=>{t.readTime.compareTo(r)>0&&(r=t.readTime)}),e.ss.set(t,r)}async function Ho(e,t,n,r){const s=v(e);let i=Hn(),o=Un();for(const u of n){const e=t.Ps(u.metadata.name);u.document&&(i=i.add(e));const n=t.Is(u);n.setReadTime(t.Ts(u.metadata.readTime)),o=o.insert(e,n)}const a=s.os.newChangeBuffer({trackRemovals:!0}),c=await Go(s,function(e){return Cn(En(U.fromString(`__bundle__/docs/${e}`)))}(r));return s.persistence.runTransaction("Apply bundle documents","readwrite",e=>Bo(e,a,o).next(t=>(a.apply(e),t)).next(t=>s.Qr.removeMatchingKeysForTargetId(e,c.targetId).next(()=>s.Qr.addMatchingKeys(e,i,c.targetId)).next(()=>s.localDocuments.getLocalViewOfDocuments(e,t.cs,t.ls)).next(()=>t.cs)))}async function Yo(e,t,n=Hn()){const r=await Go(e,Cn(Ys(t.bundledQuery))),s=v(e);return s.persistence.runTransaction("Save named query","readwrite",e=>{const i=ls(t.readTime);if(r.snapshotVersion.compareTo(i)>=0)return s.$r.saveNamedQuery(e,t);const o=r.withResumeToken(at.EMPTY_BYTE_STRING,i);return s.ns=s.ns.insert(o.targetId,o),s.Qr.updateTargetData(e,o).next(()=>s.Qr.removeMatchingKeysForTargetId(e,r.targetId)).next(()=>s.Qr.addMatchingKeys(e,n,r.targetId)).next(()=>s.$r.saveNamedQuery(e,t))})}function Jo(e,t){return`firestore_clients_${e}_${t}`}function Xo(e,t,n){let r=`firestore_mutations_${e}_${n}`;return t.isAuthenticated()&&(r+=`_${t.uid}`),r}function Zo(e,t){return`firestore_targets_${e}_${t}`}class ea{constructor(e,t,n,r){this.user=e,this.batchId=t,this.state=n,this.error=r}static Es(e,t,n){const r=JSON.parse(n);let s,i="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return i&&r.error&&((i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(s=new _(r.error.code,r.error.message))),i?new ea(e,t,r.state,s):(f("SharedClientState",`Failed to parse mutation state for ID '${t}': ${n}`),null)}ds(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class ta{constructor(e,t,n){this.targetId=e,this.state=t,this.error=n}static Es(e,t){const n=JSON.parse(t);let r,s="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error);return s&&n.error&&((s="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(r=new _(n.error.code,n.error.message))),s?new ta(e,n.state,r):(f("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}ds(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class na{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Es(e,t){const n=JSON.parse(t);let r="object"==typeof n&&n.activeTargetIds instanceof Array,s=Jn();for(let i=0;r&&i<n.activeTargetIds.length;++i)r=ve(n.activeTargetIds[i]),s=s.add(n.activeTargetIds[i]);return r?new na(e,s):(f("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class ra{constructor(e,t){this.clientId=e,this.onlineState=t}static Es(e){const t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new ra(t.clientId,t.onlineState):(f("SharedClientState",`Failed to parse online state: ${e}`),null)}}class sa{constructor(){this.activeTargetIds=Jn()}As(e){this.activeTargetIds=this.activeTargetIds.add(e)}Rs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}ds(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class ia{constructor(e,t,n,r,s){this.window=e,this.oi=t,this.persistenceKey=n,this.Vs=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.fs=this.gs.bind(this),this.ps=new Xe(F),this.started=!1,this.ys=[];const i=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.ws=Jo(this.persistenceKey,this.Vs),this.Ss=function(e){return`firestore_sequence_number_${e}`}(this.persistenceKey),this.ps=this.ps.insert(this.Vs,new sa),this.bs=new RegExp(`^firestore_clients_${i}_([^_]*)$`),this.Ds=new RegExp(`^firestore_mutations_${i}_(\\d+)(?:_(.*))?$`),this.Cs=new RegExp(`^firestore_targets_${i}_(\\d+)$`),this.vs=function(e){return`firestore_online_state_${e}`}(this.persistenceKey),this.Fs=function(e){return`firestore_bundle_loaded_v2_${e}`}(this.persistenceKey),this.window.addEventListener("storage",this.fs)}static D(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Li();for(const n of e){if(n===this.Vs)continue;const e=this.getItem(Jo(this.persistenceKey,n));if(e){const t=na.Es(n,e);t&&(this.ps=this.ps.insert(t.clientId,t))}}this.Ms();const t=this.storage.getItem(this.vs);if(t){const e=this.xs(t);e&&this.Os(e)}for(const n of this.ys)this.gs(n);this.ys=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.Ss,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Ns(this.ps)}isActiveQueryTarget(e){let t=!1;return this.ps.forEach((n,r)=>{r.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.Bs(e,"pending")}updateMutationState(e,t,n){this.Bs(e,t,n),this.Ls(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){const n=this.storage.getItem(Zo(this.persistenceKey,e));if(n){const r=ta.Es(e,n);r&&(t=r.state)}}return this.ks.As(e),this.Ms(),t}removeLocalQueryTarget(e){this.ks.Rs(e),this.Ms()}isLocalQueryTarget(e){return this.ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Zo(this.persistenceKey,e))}updateQueryState(e,t,n){this.qs(e,t,n)}handleUserChange(e,t,n){t.forEach(e=>{this.Ls(e)}),this.currentUser=e,n.forEach(e=>{this.addPendingMutation(e)})}setOnlineState(e){this.Qs(e)}notifyBundleLoaded(e){this.Ks(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.fs),this.removeItem(this.ws),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return d("SharedClientState","READ",e,t),t}setItem(e,t){d("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){d("SharedClientState","REMOVE",e),this.storage.removeItem(e)}gs(e){const t=e;if(t.storageArea===this.storage){if(d("SharedClientState","EVENT",t.key,t.newValue),t.key===this.ws)return void f("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.oi.enqueueRetryable(async()=>{if(this.started){if(null!==t.key)if(this.bs.test(t.key)){if(null==t.newValue){const e=this.$s(t.key);return this.Us(e,null)}{const e=this.Ws(t.key,t.newValue);if(e)return this.Us(e.clientId,e)}}else if(this.Ds.test(t.key)){if(null!==t.newValue){const e=this.Gs(t.key,t.newValue);if(e)return this.zs(e)}}else if(this.Cs.test(t.key)){if(null!==t.newValue){const e=this.js(t.key,t.newValue);if(e)return this.Hs(e)}}else if(t.key===this.vs){if(null!==t.newValue){const e=this.xs(t.newValue);if(e)return this.Os(e)}}else if(t.key===this.Ss){const e=function(e){let t=ge._e;if(null!=e)try{const n=JSON.parse(e);y("number"==typeof n),t=n}catch(e){f("SharedClientState","Failed to read sequence number from WebStorage",e)}return t}(t.newValue);e!==ge._e&&this.sequenceNumberHandler(e)}else if(t.key===this.Fs){const e=this.Js(t.newValue);await Promise.all(e.map(e=>this.syncEngine.Ys(e)))}}else this.ys.push(t)})}}get ks(){return this.ps.get(this.Vs)}Ms(){this.setItem(this.ws,this.ks.ds())}Bs(e,t,n){const r=new ea(this.currentUser,e,t,n),s=Xo(this.persistenceKey,this.currentUser,e);this.setItem(s,r.ds())}Ls(e){const t=Xo(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Qs(e){const t={clientId:this.Vs,onlineState:e};this.storage.setItem(this.vs,JSON.stringify(t))}qs(e,t,n){const r=Zo(this.persistenceKey,e),s=new ta(e,t,n);this.setItem(r,s.ds())}Ks(e){const t=JSON.stringify(Array.from(e));this.setItem(this.Fs,t)}$s(e){const t=this.bs.exec(e);return t?t[1]:null}Ws(e,t){const n=this.$s(e);return na.Es(n,t)}Gs(e,t){const n=this.Ds.exec(e),r=Number(n[1]),s=void 0!==n[2]?n[2]:null;return ea.Es(new a(s),r,t)}js(e,t){const n=this.Cs.exec(e),r=Number(n[1]);return ta.Es(r,t)}xs(e){return ra.Es(e)}Js(e){return JSON.parse(e)}async zs(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Zs(e.batchId,e.state,e.error);d("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}Hs(e){return this.syncEngine.Xs(e.targetId,e.state,e.error)}Us(e,t){const n=t?this.ps.insert(e,t):this.ps.remove(e),r=this.Ns(this.ps),s=this.Ns(n),i=[],o=[];return s.forEach(e=>{r.has(e)||i.push(e)}),r.forEach(e=>{s.has(e)||o.push(e)}),this.syncEngine.eo(i,o).then(()=>{this.ps=n})}Os(e){this.ps.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Ns(e){let t=Jn();return e.forEach((e,n)=>{t=t.unionWith(n.activeTargetIds)}),t}}class oa{constructor(){this.no=new sa,this.ro={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return this.no.As(e),this.ro[e]||"not-current"}updateQueryState(e,t,n){this.ro[e]=t}removeLocalQueryTarget(e){this.no.Rs(e)}isLocalQueryTarget(e){return this.no.activeTargetIds.has(e)}clearQueryState(e){delete this.ro[e]}getAllActiveQueryTargets(){return this.no.activeTargetIds}isActiveQueryTarget(e){return this.no.activeTargetIds.has(e)}start(){return this.no=new sa,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class aa{io(e){}shutdown(){}}class ca{constructor(){this.so=(()=>this.oo()),this._o=(()=>this.ao()),this.uo=[],this.co()}io(e){this.uo.push(e)}shutdown(){window.removeEventListener("online",this.so),window.removeEventListener("offline",this._o)}co(){window.addEventListener("online",this.so),window.addEventListener("offline",this._o)}oo(){d("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.uo)e(0)}ao(){d("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.uo)e(1)}static D(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let ua=null;function la(){return null===ua?ua=268435456+Math.round(2147483648*Math.random()):ua++,"0x"+ua.toString(16)}const ha={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class da{constructor(e){this.lo=e.lo,this.ho=e.ho}Po(e){this.Io=e}To(e){this.Eo=e}onMessage(e){this.Ao=e}close(){this.ho()}send(e){this.lo(e)}Ro(){this.Io()}Vo(e){this.Eo(e)}mo(e){this.Ao(e)}}const fa="WebChannelConnection";class ma extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.fo=t+"://"+e.host,this.po=`projects/${n}/databases/${r}`,this.yo="(default)"===this.databaseId.database?`project_id=${n}`:`project_id=${n}&database_id=${r}`}get wo(){return!1}So(e,t,n,r,s){const i=la(),o=this.bo(e,t.toUriEncodedString());d("RestConnection",`Sending RPC '${e}' ${i}:`,o,n);const a={"google-cloud-resource-prefix":this.po,"x-goog-request-params":this.yo};return this.Do(a,r,s),this.Co(e,o,a,n).then(t=>(d("RestConnection",`Received RPC '${e}' ${i}: `,t),t),t=>{throw m("RestConnection",`RPC '${e}' ${i} failed with error: `,t,"url: ",o,"request:",n),t})}vo(e,t,n,r,s,i){return this.So(e,t,n,r,s)}Do(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+c,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((t,n)=>e[n]=t),n&&n.headers.forEach((t,n)=>e[n]=t)}bo(e,t){const n=ha[e];return`${this.fo}/v1/${t}:${n}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Co(e,t,n,r){const s=la();return new Promise((o,a)=>{const c=new i.XhrIo;c.setWithCredentials(!0),c.listenOnce(i.EventType.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case i.ErrorCode.NO_ERROR:const t=c.getResponseJson();d(fa,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(t)),o(t);break;case i.ErrorCode.TIMEOUT:d(fa,`RPC '${e}' ${s} timed out`),a(new _(I.DEADLINE_EXCEEDED,"Request time out"));break;case i.ErrorCode.HTTP_ERROR:const n=c.getStatus();if(d(fa,`RPC '${e}' ${s} failed with status:`,n,"response text:",c.getResponseText()),n>0){let e=c.getResponseJson();Array.isArray(e)&&(e=e[0]);const t=null==e?void 0:e.error;if(t&&t.status&&t.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(I).indexOf(t)>=0?t:I.UNKNOWN}(t.status);a(new _(e,t.message))}else a(new _(I.UNKNOWN,"Server responded with status "+c.getStatus()))}else a(new _(I.UNAVAILABLE,"Connection failed."));break;default:g()}}finally{d(fa,`RPC '${e}' ${s} completed.`)}});const u=JSON.stringify(r);d(fa,`RPC '${e}' ${s} sending request:`,r),c.send(t,"POST",u,n,15)})}Fo(e,t,n){const r=la(),s=[this.fo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=(0,i.createWebChannelTransport)(),a=(0,i.getStatEventTarget)(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;void 0!==u&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Do(c.initMessageHeaders,t,n),c.encodeInitMessageHeaders=!0;const l=s.join("");d(fa,`Creating RPC '${e}' stream ${r}: ${l}`,c);const h=o.createWebChannel(l,c);let f=!1,p=!1;const g=new da({lo:t=>{p?d(fa,`Not sending because RPC '${e}' stream ${r} is closed:`,t):(f||(d(fa,`Opening RPC '${e}' stream ${r} transport.`),h.open(),f=!0),d(fa,`RPC '${e}' stream ${r} sending:`,t),h.send(t))},ho:()=>h.close()}),w=(e,t,n)=>{e.listen(t,e=>{try{n(e)}catch(e){setTimeout(()=>{throw e},0)}})};return w(h,i.WebChannel.EventType.OPEN,()=>{p||d(fa,`RPC '${e}' stream ${r} transport opened.`)}),w(h,i.WebChannel.EventType.CLOSE,()=>{p||(p=!0,d(fa,`RPC '${e}' stream ${r} transport closed`),g.Vo())}),w(h,i.WebChannel.EventType.ERROR,t=>{p||(p=!0,m(fa,`RPC '${e}' stream ${r} transport errored:`,t),g.Vo(new _(I.UNAVAILABLE,"The operation could not be completed")))}),w(h,i.WebChannel.EventType.MESSAGE,t=>{var n;if(!p){const s=t.data[0];y(!!s);const i=s,o=i.error||(null===(n=i[0])||void 0===n?void 0:n.error);if(o){d(fa,`RPC '${e}' stream ${r} received error:`,o);const t=o.status;let n=function(e){const t=Pr[e];if(void 0!==t)return qr(t)}(t),s=o.message;void 0===n&&(n=I.INTERNAL,s="Unknown error status: "+t+" with message "+o.message),p=!0,g.Vo(new _(n,s)),h.close()}else d(fa,`RPC '${e}' stream ${r} received:`,s),g.mo(s)}}),w(a,i.Event.STAT_EVENT,t=>{t.stat===i.Stat.PROXY?d(fa,`RPC '${e}' stream ${r} detected buffering proxy`):t.stat===i.Stat.NOPROXY&&d(fa,`RPC '${e}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{g.Ro()},0),g}}function pa(){return"undefined"!=typeof window?window:null}function ga(){return"undefined"!=typeof document?document:null}function ya(e){return new is(e,!0)}class wa{constructor(e,t,n=1e3,r=1.5,s=6e4){this.oi=e,this.timerId=t,this.Mo=n,this.xo=r,this.Oo=s,this.No=0,this.Bo=null,this.Lo=Date.now(),this.reset()}reset(){this.No=0}ko(){this.No=this.Oo}qo(e){this.cancel();const t=Math.floor(this.No+this.Qo()),n=Math.max(0,Date.now()-this.Lo),r=Math.max(0,t-n);r>0&&d("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.No} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.Bo=this.oi.enqueueAfterDelay(this.timerId,r,()=>(this.Lo=Date.now(),e())),this.No*=this.xo,this.No<this.Mo&&(this.No=this.Mo),this.No>this.Oo&&(this.No=this.Oo)}Ko(){null!==this.Bo&&(this.Bo.skipDelay(),this.Bo=null)}cancel(){null!==this.Bo&&(this.Bo.cancel(),this.Bo=null)}Qo(){return(Math.random()-.5)*this.No}}class va{constructor(e,t,n,r,s,i,o,a){this.oi=e,this.$o=n,this.Uo=r,this.connection=s,this.authCredentialsProvider=i,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.Wo=0,this.Go=null,this.zo=null,this.stream=null,this.jo=new wa(e,t)}Ho(){return 1===this.state||5===this.state||this.Jo()}Jo(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Yo()}async stop(){this.Ho()&&await this.close(0)}Zo(){this.state=0,this.jo.reset()}Xo(){this.Jo()&&null===this.Go&&(this.Go=this.oi.enqueueAfterDelay(this.$o,6e4,()=>this.e_()))}t_(e){this.n_(),this.stream.send(e)}async e_(){if(this.Jo())return this.close(0)}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}r_(){this.zo&&(this.zo.cancel(),this.zo=null)}async close(e,t){this.n_(),this.r_(),this.jo.cancel(),this.Wo++,4!==e?this.jo.reset():t&&t.code===I.RESOURCE_EXHAUSTED?(f(t.toString()),f("Using maximum backoff delay to prevent overloading the backend."),this.jo.ko()):t&&t.code===I.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.i_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.To(t)}i_(){}auth(){this.state=1;const e=this.s_(this.Wo),t=this.Wo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([e,n])=>{this.Wo===t&&this.o_(e,n)},t=>{e(()=>{const e=new _(I.UNKNOWN,"Fetching auth token failed: "+t.message);return this.__(e)})})}o_(e,t){const n=this.s_(this.Wo);this.stream=this.a_(e,t),this.stream.Po(()=>{n(()=>(this.state=2,this.zo=this.oi.enqueueAfterDelay(this.Uo,1e4,()=>(this.Jo()&&(this.state=3),Promise.resolve())),this.listener.Po()))}),this.stream.To(e=>{n(()=>this.__(e))}),this.stream.onMessage(e=>{n(()=>this.onMessage(e))})}Yo(){this.state=5,this.jo.qo(async()=>{this.state=0,this.start()})}__(e){return d("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}s_(e){return t=>{this.oi.enqueueAndForget(()=>this.Wo===e?t():(d("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Ia extends va{constructor(e,t,n,r,s,i){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,i),this.serializer=s}a_(e,t){return this.connection.Fo("Listen",e,t)}onMessage(e){this.jo.reset();const t=Es(this.serializer,e),n=function(e){if(!("targetChange"in e))return O.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?O.min():t.readTime?ls(t.readTime):O.min()}(e);return this.listener.u_(t,n)}c_(e){const t={};t.database=ws(this.serializer),t.addTarget=function(e,t){let n;const r=t.target;if((n=yn(r)?{documents:Cs(e,r)}:{query:Ds(e,r).ut}).targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=cs(e,t.resumeToken);const r=os(e,t.expectedCount);null!==r&&(n.expectedCount=r)}else if(t.snapshotVersion.compareTo(O.min())>0){n.readTime=as(e,t.snapshotVersion.toTimestamp());const r=os(e,t.expectedCount);null!==r&&(n.expectedCount=r)}return n}(this.serializer,e);const n=As(this.serializer,e);n&&(t.labels=n),this.t_(t)}l_(e){const t={};t.database=ws(this.serializer),t.removeTarget=e,this.t_(t)}}class _a extends va{constructor(e,t,n,r,s,i){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,i),this.serializer=s,this.h_=!1}get P_(){return this.h_}start(){this.h_=!1,this.lastStreamToken=void 0,super.start()}i_(){this.h_&&this.I_([])}a_(e,t){return this.connection.Fo("Write",e,t)}onMessage(e){if(y(!!e.streamToken),this.lastStreamToken=e.streamToken,this.h_){this.jo.reset();const t=Ss(e.writeResults,e.commitTime),n=ls(e.commitTime);return this.listener.T_(n,t)}return y(!e.writeResults||0===e.writeResults.length),this.h_=!0,this.listener.E_()}d_(){const e={};e.database=ws(this.serializer),this.t_(e)}I_(e){const t={streamToken:this.lastStreamToken,writes:e.map(e=>xs(this.serializer,e))};this.t_(t)}}class ba extends class{}{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.A_=!1}R_(){if(this.A_)throw new _(I.FAILED_PRECONDITION,"The client has already been terminated.")}So(e,t,n,r){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,i])=>this.connection.So(e,ds(t,n),r,s,i)).catch(e=>{throw"FirebaseError"===e.name?(e.code===I.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new _(I.UNKNOWN,e.toString())})}vo(e,t,n,r,s){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.vo(e,ds(t,n),r,i,o,s)).catch(e=>{throw"FirebaseError"===e.name?(e.code===I.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new _(I.UNKNOWN,e.toString())})}terminate(){this.A_=!0,this.connection.terminate()}}async function Ea(e,t,n){var r;const s=v(e),{request:i,V_:o,parent:a}=function(e,t,n){const{ut:r,parent:s}=Ds(e,t),i={},o=[];let a=0;return n.forEach(e=>{const t="aggregate_"+a++;i[t]=e.alias,"count"===e.aggregateType?o.push({alias:t,count:{}}):"avg"===e.aggregateType?o.push({alias:t,avg:{field:Rs(e.fieldPath)}}):"sum"===e.aggregateType&&o.push({alias:t,sum:{field:Rs(e.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:o,structuredQuery:r.structuredQuery},parent:r.parent},V_:i,parent:s}}(s.serializer,function(e){const t=v(e);return t.Pe||(t.Pe=Dn(t,e.explicitOrderBy)),t.Pe}(t),n);s.connection.wo||delete i.parent;const c=(await s.vo("RunAggregationQuery",s.serializer.databaseId,a,i,1)).filter(e=>!!e.result);y(1===c.length);const u=null===(r=c[0].result)||void 0===r?void 0:r.aggregateFields;return Object.keys(u).reduce((e,t)=>(e[o[t]]=u[t],e),{})}class xa{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.m_=0,this.f_=null,this.g_=!0}p_(){0===this.m_&&(this.y_("Unknown"),this.f_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.f_=null,this.w_("Backend didn't respond within 10 seconds."),this.y_("Offline"),Promise.resolve())))}S_(e){"Online"===this.state?this.y_("Unknown"):(this.m_++,this.m_>=1&&(this.b_(),this.w_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.y_("Offline")))}set(e){this.b_(),this.m_=0,"Online"===e&&(this.g_=!1),this.y_(e)}y_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}w_(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.g_?(f(t),this.g_=!1):d("OnlineStateTracker",t)}b_(){null!==this.f_&&(this.f_.cancel(),this.f_=null)}}class Ta{constructor(e,t,n,r,s){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.D_=[],this.C_=new Map,this.v_=new Set,this.F_=[],this.M_=s,this.M_.io(e=>{n.enqueueAndForget(async()=>{Fa(this)&&(d("RemoteStore","Restarting streams for network reachability change."),await async function(e){const t=v(e);t.v_.add(4),await Ca(t),t.x_.set("Unknown"),t.v_.delete(4),await Sa(t)}(this))})}),this.x_=new xa(n,r)}}async function Sa(e){if(Fa(e))for(const t of e.F_)await t(!0)}async function Ca(e){for(const t of e.F_)await t(!1)}function Da(e,t){const n=v(e);n.C_.has(t.targetId)||(n.C_.set(t.targetId,t),La(n)?Ma(n):Xa(n).Jo()&&Aa(n,t))}function Na(e,t){const n=v(e),r=Xa(n);n.C_.delete(t),r.Jo()&&ka(n,t),0===n.C_.size&&(r.Jo()?r.Xo():Fa(n)&&n.x_.set("Unknown"))}function Aa(e,t){if(e.O_.Oe(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(O.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}Xa(e).c_(t)}function ka(e,t){e.O_.Oe(t),Xa(e).l_(t)}function Ma(e){e.O_=new Zr({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),_t:t=>e.C_.get(t)||null,nt:()=>e.datastore.serializer.databaseId}),Xa(e).start(),e.x_.p_()}function La(e){return Fa(e)&&!Xa(e).Ho()&&e.C_.size>0}function Fa(e){return 0===v(e).v_.size}function Ra(e){e.O_=void 0}async function Pa(e){e.C_.forEach((t,n)=>{Aa(e,t)})}async function Va(e,t){Ra(e),La(e)?(e.x_.S_(t),Ma(e)):e.x_.set("Unknown")}async function Oa(e,t,n){if(e.x_.set("Online"),t instanceof Jr&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const r of t.targetIds)e.C_.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.C_.delete(r),e.O_.removeTarget(r))}(e,t)}catch(n){d("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),n),await qa(e,n)}else if(t instanceof Hr?e.O_.$e(t):t instanceof Yr?e.O_.Je(t):e.O_.Ge(t),!n.isEqual(O.min()))try{const r=await qo(e.localStore);n.compareTo(r)>=0&&await function(e,t){const n=e.O_.it(t);return n.targetChanges.forEach((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const s=e.C_.get(r);s&&e.C_.set(r,s.withResumeToken(n.resumeToken,t))}}),n.targetMismatches.forEach((t,n)=>{const r=e.C_.get(t);if(!r)return;e.C_.set(t,r.withResumeToken(at.EMPTY_BYTE_STRING,r.snapshotVersion)),ka(e,t);const s=new Us(r.target,t,n,r.sequenceNumber);Aa(e,s)}),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){d("RemoteStore","Failed to raise snapshot:",t),await qa(e,t)}}async function qa(e,t,n){if(!ue(t))throw t;e.v_.add(1),await Ca(e),e.x_.set("Offline"),n||(n=(()=>qo(e.localStore))),e.asyncQueue.enqueueRetryable(async()=>{d("RemoteStore","Retrying IndexedDB access"),await n(),e.v_.delete(1),await Sa(e)})}function Ua(e,t){return t().catch(n=>qa(e,n,t))}async function Ba(e){const t=v(e),n=Za(t);let r=t.D_.length>0?t.D_[t.D_.length-1].batchId:-1;for(;za(t);)try{const s=await zo(t.localStore,r);if(null===s){0===t.D_.length&&n.Xo();break}r=s.batchId,Ga(t,s)}catch(e){await qa(t,e)}Ka(t)&&$a(t)}function za(e){return Fa(e)&&e.D_.length<10}function Ga(e,t){e.D_.push(t);const n=Za(e);n.Jo()&&n.P_&&n.I_(t.mutations)}function Ka(e){return Fa(e)&&!Za(e).Ho()&&e.D_.length>0}function $a(e){Za(e).start()}async function Qa(e){Za(e).d_()}async function ja(e){const t=Za(e);for(const n of e.D_)t.I_(n.mutations)}async function Wa(e,t,n){const r=e.D_.shift(),s=Mr.from(r,t,n);await Ua(e,()=>e.remoteSyncer.applySuccessfulWrite(s)),await Ba(e)}async function Ha(e,t){t&&Za(e).P_&&await async function(e,t){if(function(e){return Or(e)&&e!==I.ABORTED}(t.code)){const n=e.D_.shift();Za(e).Zo(),await Ua(e,()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t)),await Ba(e)}}(e,t),Ka(e)&&$a(e)}async function Ya(e,t){const n=v(e);n.asyncQueue.verifyOperationInProgress(),d("RemoteStore","RemoteStore received new credentials");const r=Fa(n);n.v_.add(3),await Ca(n),r&&n.x_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.v_.delete(3),await Sa(n)}async function Ja(e,t){const n=v(e);t?(n.v_.delete(2),await Sa(n)):t||(n.v_.add(2),await Ca(n),n.x_.set("Unknown"))}function Xa(e){return e.N_||(e.N_=function(e,t,n){const r=v(e);return r.R_(),new Ia(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Po:Pa.bind(null,e),To:Va.bind(null,e),u_:Oa.bind(null,e)}),e.F_.push(async t=>{t?(e.N_.Zo(),La(e)?Ma(e):e.x_.set("Unknown")):(await e.N_.stop(),Ra(e))})),e.N_}function Za(e){return e.B_||(e.B_=function(e,t,n){const r=v(e);return r.R_(),new _a(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Po:Qa.bind(null,e),To:Ha.bind(null,e),E_:ja.bind(null,e),T_:Wa.bind(null,e)}),e.F_.push(async t=>{t?(e.B_.Zo(),await Ba(e)):(await e.B_.stop(),e.D_.length>0&&(d("RemoteStore",`Stopping write stream with ${e.D_.length} pending writes`),e.D_=[]))})),e.B_}class ec{constructor(e,t,n,r,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=s,this.deferred=new b,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(e=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,r,s){const i=Date.now()+n,o=new ec(e,t,i,r,s);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new _(I.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function tc(e,t){if(f("AsyncQueue",`${t}: ${e}`),ue(e))return new _(I.UNAVAILABLE,`${t}: ${e}`);throw e}class nc{constructor(e){this.comparator=e?(t,n)=>e(t,n)||G.comparator(t.key,n.key):(e,t)=>G.comparator(e.key,t.key),this.keyedMap=zn(),this.sortedSet=new Xe(this.comparator)}static emptySet(e){return new nc(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof nc))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new nc;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class rc{constructor(){this.L_=new Xe(G.comparator)}track(e){const t=e.doc.key,n=this.L_.get(t);n?0!==e.type&&3===n.type?this.L_=this.L_.insert(t,e):3===e.type&&1!==n.type?this.L_=this.L_.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.L_=this.L_.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.L_=this.L_.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.L_=this.L_.remove(t):1===e.type&&2===n.type?this.L_=this.L_.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.L_=this.L_.insert(t,{type:2,doc:e.doc}):g():this.L_=this.L_.insert(t,e)}k_(){const e=[];return this.L_.inorderTraversal((t,n)=>{e.push(n)}),e}}class sc{constructor(e,t,n,r,s,i,o,a,c){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=s,this.fromCache=i,this.syncStateChanged=o,this.excludesMetadataChanges=a,this.hasCachedResults=c}static fromInitialDocuments(e,t,n,r,s){const i=[];return t.forEach(e=>{i.push({type:0,doc:e})}),new sc(e,t,nc.emptySet(t),i,n,r,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&kn(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}class ic{constructor(){this.q_=void 0,this.Q_=[]}}class oc{constructor(){this.queries=new On(e=>Mn(e),kn),this.onlineState="Unknown",this.K_=new Set}}async function ac(e,t){const n=v(e),r=t.query;let s=!1,i=n.queries.get(r);if(i||(s=!0,i=new ic),s)try{i.q_=await n.onListen(r)}catch(e){const n=tc(e,`Initialization of query '${Ln(t.query)}' failed`);return void t.onError(n)}n.queries.set(r,i),i.Q_.push(t),t.U_(n.onlineState),i.q_&&t.W_(i.q_)&&hc(n)}async function cc(e,t){const n=v(e),r=t.query;let s=!1;const i=n.queries.get(r);if(i){const e=i.Q_.indexOf(t);e>=0&&(i.Q_.splice(e,1),s=0===i.Q_.length)}if(s)return n.queries.delete(r),n.onUnlisten(r)}function uc(e,t){const n=v(e);let r=!1;for(const s of t){const e=s.query,t=n.queries.get(e);if(t){for(const e of t.Q_)e.W_(s)&&(r=!0);t.q_=s}}r&&hc(n)}function lc(e,t,n){const r=v(e),s=r.queries.get(t);if(s)for(const i of s.Q_)i.onError(n);r.queries.delete(t)}function hc(e){e.K_.forEach(e=>{e.next()})}class dc{constructor(e,t,n){this.query=e,this.G_=t,this.z_=!1,this.j_=null,this.onlineState="Unknown",this.options=n||{}}W_(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new sc(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.z_?this.H_(e)&&(this.G_.next(e),t=!0):this.J_(e,this.onlineState)&&(this.Y_(e),t=!0),this.j_=e,t}onError(e){this.G_.error(e)}U_(e){this.onlineState=e;let t=!1;return this.j_&&!this.z_&&this.J_(this.j_,e)&&(this.Y_(this.j_),t=!0),t}J_(e,t){if(!e.fromCache)return!0;const n="Offline"!==t;return(!this.options.Z_||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}H_(e){if(e.docChanges.length>0)return!0;const t=this.j_&&this.j_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}Y_(e){e=sc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.z_=!0,this.G_.next(e)}}class fc{constructor(e,t){this.X_=e,this.byteLength=t}ea(){return"metadata"in this.X_}}class mc{constructor(e){this.serializer=e}Ps(e){return ps(this.serializer,e)}Is(e){return e.metadata.exists?_s(this.serializer,e.document,!1):Bt.newNoDocument(this.Ps(e.metadata.name),this.Ts(e.metadata.readTime))}Ts(e){return ls(e)}}class pc{constructor(e,t,n){this.ta=e,this.localStore=t,this.serializer=n,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=gc(e)}na(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.X_.namedQuery)this.queries.push(e.X_.namedQuery);else if(e.X_.documentMetadata){this.documents.push({metadata:e.X_.documentMetadata}),e.X_.documentMetadata.exists||++t;const n=U.fromString(e.X_.documentMetadata.name);this.collectionGroups.add(n.get(n.length-2))}else e.X_.document&&(this.documents[this.documents.length-1].document=e.X_.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}ra(e){const t=new Map,n=new mc(this.serializer);for(const r of e)if(r.metadata.queries){const e=n.Ps(r.metadata.name);for(const n of r.metadata.queries){const r=(t.get(n)||Hn()).add(e);t.set(n,r)}}return t}async complete(){const e=await Ho(this.localStore,new mc(this.serializer),this.documents,this.ta.id),t=this.ra(this.documents);for(const n of this.queries)await Yo(this.localStore,n,t.get(n.name));return this.progress.taskState="Success",{progress:this.progress,ia:this.collectionGroups,sa:e}}}function gc(e){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}class yc{constructor(e){this.key=e}}class wc{constructor(e){this.key=e}}class vc{constructor(e,t){this.query=e,this.oa=t,this._a=null,this.hasCachedResults=!1,this.current=!1,this.aa=Hn(),this.mutatedKeys=Hn(),this.ua=Pn(e),this.ca=new nc(this.ua)}get la(){return this.oa}ha(e,t){const n=t?t.Pa:new rc,r=t?t.ca:this.ca;let s=t?t.mutatedKeys:this.mutatedKeys,i=r,o=!1;const a="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,c="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((e,t)=>{const u=r.get(e),l=Fn(this.query,t)?t:null,h=!!u&&this.mutatedKeys.has(u.key),d=!!l&&(l.hasLocalMutations||this.mutatedKeys.has(l.key)&&l.hasCommittedMutations);let f=!1;u&&l?u.data.isEqual(l.data)?h!==d&&(n.track({type:3,doc:l}),f=!0):this.Ia(u,l)||(n.track({type:2,doc:l}),f=!0,(a&&this.ua(l,a)>0||c&&this.ua(l,c)<0)&&(o=!0)):!u&&l?(n.track({type:0,doc:l}),f=!0):u&&!l&&(n.track({type:1,doc:u}),f=!0,(a||c)&&(o=!0)),f&&(l?(i=i.add(l),s=d?s.add(e):s.delete(e)):(i=i.delete(e),s=s.delete(e)))}),null!==this.query.limit)for(;i.size>this.query.limit;){const e="F"===this.query.limitType?i.last():i.first();i=i.delete(e.key),s=s.delete(e.key),n.track({type:1,doc:e})}return{ca:i,Pa:n,Xi:o,mutatedKeys:s}}Ia(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,r){const s=this.ca;this.ca=e.ca,this.mutatedKeys=e.mutatedKeys;const i=e.Pa.k_();i.sort((e,t)=>(function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return g()}};return n(e)-n(t)})(e.type,t.type)||this.ua(e.doc,t.doc)),this.Ta(n),r=null!=r&&r;const o=t&&!r?this.Ea():[],a=0===this.aa.size&&this.current&&!r?1:0,c=a!==this._a;return this._a=a,0!==i.length||c?{snapshot:new sc(this.query,e.ca,s,i,e.mutatedKeys,0===a,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),da:o}:{da:o}}U_(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({ca:this.ca,Pa:new rc,mutatedKeys:this.mutatedKeys,Xi:!1},!1)):{da:[]}}Aa(e){return!this.oa.has(e)&&!!this.ca.has(e)&&!this.ca.get(e).hasLocalMutations}Ta(e){e&&(e.addedDocuments.forEach(e=>this.oa=this.oa.add(e)),e.modifiedDocuments.forEach(e=>{}),e.removedDocuments.forEach(e=>this.oa=this.oa.delete(e)),this.current=e.current)}Ea(){if(!this.current)return[];const e=this.aa;this.aa=Hn(),this.ca.forEach(e=>{this.Aa(e.key)&&(this.aa=this.aa.add(e.key))});const t=[];return e.forEach(e=>{this.aa.has(e)||t.push(new wc(e))}),this.aa.forEach(n=>{e.has(n)||t.push(new yc(n))}),t}Ra(e){this.oa=e.hs,this.aa=Hn();const t=this.ha(e.documents);return this.applyChanges(t,!0)}Va(){return sc.fromInitialDocuments(this.query,this.ca,this.mutatedKeys,0===this._a,this.hasCachedResults)}}class Ic{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class _c{constructor(e){this.key=e,this.ma=!1}}class bc{constructor(e,t,n,r,s,i){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=i,this.fa={},this.ga=new On(e=>Mn(e),kn),this.pa=new Map,this.ya=new Set,this.wa=new Xe(G.comparator),this.Sa=new Map,this.ba=new po,this.Da={},this.Ca=new Map,this.va=Gi.Bn(),this.onlineState="Unknown",this.Fa=void 0}get isPrimaryClient(){return!0===this.Fa}}async function Ec(e,t){const n=Xc(e);let r,s;const i=n.ga.get(t);if(i)r=i.targetId,n.sharedClientState.addLocalQueryTarget(r),s=i.view.Va();else{const e=await Go(n.localStore,Cn(t)),i=n.sharedClientState.addLocalQueryTarget(e.targetId);r=e.targetId,s=await xc(n,t,r,"current"===i,e.resumeToken),n.isPrimaryClient&&Da(n.remoteStore,e)}return s}async function xc(e,t,n,r,s){e.Ma=((t,n,r)=>(async function(e,t,n,r){let s=t.view.ha(n);s.Xi&&(s=await $o(e.localStore,t.query,!1).then(({documents:e})=>t.view.ha(e,s)));const i=r&&r.targetChanges.get(t.targetId),o=r&&null!=r.targetMismatches.get(t.targetId),a=t.view.applyChanges(s,e.isPrimaryClient,i,o);return Vc(e,t.targetId,a.da),a.snapshot})(e,t,n,r));const i=await $o(e.localStore,t,!0),o=new vc(t,i.hs),a=o.ha(i.documents),c=Wr.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState,s),u=o.applyChanges(a,e.isPrimaryClient,c);Vc(e,n,u.da);const l=new Ic(t,n,o);return e.ga.set(t,l),e.pa.has(n)?e.pa.get(n).push(t):e.pa.set(n,[t]),u.snapshot}async function Tc(e,t){const n=v(e),r=n.ga.get(t),s=n.pa.get(r.targetId);if(s.length>1)return n.pa.set(r.targetId,s.filter(e=>!kn(e,t))),void n.ga.delete(t);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||await Ko(n.localStore,r.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(r.targetId),Na(n.remoteStore,r.targetId),Rc(n,r.targetId)}).catch(re)):(Rc(n,r.targetId),await Ko(n.localStore,r.targetId,!0))}async function Sc(e,t,n){const r=Zc(e);try{const s=await function(e,t){const n=v(e),r=V.now(),s=t.reduce((e,t)=>e.add(t.key),Hn());let i,o;return n.persistence.runTransaction("Locally write mutations","readwrite",e=>{let a=Un(),c=Hn();return n.os.getEntries(e,s).next(e=>{(a=e).forEach((e,t)=>{t.isValidDocument()||(c=c.add(e))})}).next(()=>n.localDocuments.getOverlayedDocuments(e,a)).next(s=>{i=s;const o=[];for(const e of t){const t=br(e,i.get(e.key).overlayedDocument);null!=t&&o.push(new Tr(e.key,t,Ut(t.value.mapValue),gr.exists(!0)))}return n.mutationQueue.addMutationBatch(e,r,o,t)}).next(t=>{o=t;const r=t.applyToLocalDocumentSet(i,c);return n.documentOverlayCache.saveOverlays(e,t.batchId,r)})}).then(()=>({batchId:o.batchId,changes:Gn(i)}))}(r.localStore,t);r.sharedClientState.addPendingMutation(s.batchId),function(e,t,n){let r=e.Da[e.currentUser.toKey()];r||(r=new Xe(F)),r=r.insert(t,n),e.Da[e.currentUser.toKey()]=r}(r,s.batchId,n),await Uc(r,s.changes),await Ba(r.remoteStore)}catch(e){const t=tc(e,"Failed to persist write");n.reject(t)}}async function Cc(e,t){const n=v(e);try{const r=await Uo(n.localStore,t);t.targetChanges.forEach((e,t)=>{const r=n.Sa.get(t);r&&(y(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?r.ma=!0:e.modifiedDocuments.size>0?y(r.ma):e.removedDocuments.size>0&&(y(r.ma),r.ma=!1))}),await Uc(n,r,t)}catch(e){await re(e)}}function Dc(e,t,n){const r=v(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.ga.forEach((n,r)=>{const s=r.view.U_(t);s.snapshot&&e.push(s.snapshot)}),function(e,t){const n=v(e);n.onlineState=t;let r=!1;n.queries.forEach((e,n)=>{for(const s of n.Q_)s.U_(t)&&(r=!0)}),r&&hc(n)}(r.eventManager,t),e.length&&r.fa.u_(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function Nc(e,t,n){const r=v(e);r.sharedClientState.updateQueryState(t,"rejected",n);const s=r.Sa.get(t),i=s&&s.key;if(i){let e=new Xe(G.comparator);e=e.insert(i,Bt.newNoDocument(i,O.min()));const n=Hn().add(i),s=new jr(O.min(),new Map,new Xe(F),e,n);await Cc(r,s),r.wa=r.wa.remove(i),r.Sa.delete(t),qc(r)}else await Ko(r.localStore,t,!1).then(()=>Rc(r,t,n)).catch(re)}async function Ac(e,t){const n=v(e),r=t.batch.batchId;try{const s=await Oo(n.localStore,t);Fc(n,r,null),Lc(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Uc(n,s)}catch(e){await re(e)}}async function kc(e,t,n){const r=v(e);try{const e=await function(e,t){const n=v(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next(t=>(y(null!==t),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t))).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r)).next(()=>n.localDocuments.getDocuments(e,r))})}(r.localStore,t);Fc(r,t,n),Lc(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await Uc(r,e)}catch(n){await re(n)}}async function Mc(e,t){const n=v(e);Fa(n.remoteStore)||d("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=await function(e){const t=v(e);return t.persistence.runTransaction("Get highest unacknowledged batch id","readonly",e=>t.mutationQueue.getHighestUnacknowledgedBatchId(e))}(n.localStore);if(-1===r)return void t.resolve();const s=n.Ca.get(r)||[];s.push(t),n.Ca.set(r,s)}catch(e){const n=tc(e,"Initialization of waitForPendingWrites() operation failed");t.reject(n)}}function Lc(e,t){(e.Ca.get(t)||[]).forEach(e=>{e.resolve()}),e.Ca.delete(t)}function Fc(e,t,n){const r=v(e);let s=r.Da[r.currentUser.toKey()];if(s){const e=s.get(t);e&&(n?e.reject(n):e.resolve(),s=s.remove(t)),r.Da[r.currentUser.toKey()]=s}}function Rc(e,t,n=null){e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.pa.get(t))e.ga.delete(r),n&&e.fa.xa(r,n);e.pa.delete(t),e.isPrimaryClient&&e.ba.Vr(t).forEach(t=>{e.ba.containsKey(t)||Pc(e,t)})}function Pc(e,t){e.ya.delete(t.path.canonicalString());const n=e.wa.get(t);null!==n&&(Na(e.remoteStore,n),e.wa=e.wa.remove(t),e.Sa.delete(n),qc(e))}function Vc(e,t,n){for(const r of n)r instanceof yc?(e.ba.addReference(r.key,t),Oc(e,r)):r instanceof wc?(d("SyncEngine","Document no longer in limbo: "+r.key),e.ba.removeReference(r.key,t),e.ba.containsKey(r.key)||Pc(e,r.key)):g()}function Oc(e,t){const n=t.key,r=n.path.canonicalString();e.wa.get(n)||e.ya.has(r)||(d("SyncEngine","New document in limbo: "+n),e.ya.add(r),qc(e))}function qc(e){for(;e.ya.size>0&&e.wa.size<e.maxConcurrentLimboResolutions;){const t=e.ya.values().next().value;e.ya.delete(t);const n=new G(U.fromString(t)),r=e.va.next();e.Sa.set(r,new _c(n)),e.wa=e.wa.insert(n,r),Da(e.remoteStore,new Us(Cn(En(n.path)),r,"TargetPurposeLimboResolution",ge._e))}}async function Uc(e,t,n){const r=v(e),s=[],i=[],o=[];r.ga.isEmpty()||(r.ga.forEach((e,a)=>{o.push(r.Ma(a,t,n).then(e=>{if((e||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(a.targetId,(null==e?void 0:e.fromCache)?"not-current":"current"),e){s.push(e);const t=Mo.Ki(a.targetId,e);i.push(t)}}))}),await Promise.all(o),r.fa.u_(s),await async function(e,t){const n=v(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",e=>se.forEach(t,t=>se.forEach(t.qi,r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r)).next(()=>se.forEach(t.Qi,r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))}catch(e){if(!ue(e))throw e;d("LocalStore","Failed to update sequence numbers: "+e)}for(const r of t){const e=r.targetId;if(!r.fromCache){const t=n.ns.get(e),r=t.snapshotVersion,s=t.withLastLimboFreeSnapshotVersion(r);n.ns=n.ns.insert(e,s)}}}(r.localStore,i))}async function Bc(e,t){const n=v(e);if(!n.currentUser.isEqual(t)){d("SyncEngine","User change. New user:",t.toKey());const e=await Vo(n.localStore,t);n.currentUser=t,function(e,t){e.Ca.forEach(e=>{e.forEach(e=>{e.reject(new _(I.CANCELLED,t))})}),e.Ca.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await Uc(n,e.us)}}function zc(e,t){const n=v(e),r=n.Sa.get(t);if(r&&r.ma)return Hn().add(r.key);{let e=Hn();const r=n.pa.get(t);if(!r)return e;for(const t of r){const r=n.ga.get(t);e=e.unionWith(r.view.la)}return e}}async function Gc(e,t){const n=v(e),r=await $o(n.localStore,t.query,!0),s=t.view.Ra(r);return n.isPrimaryClient&&Vc(n,t.targetId,s.da),s}async function Kc(e,t){const n=v(e);return jo(n.localStore,t).then(e=>Uc(n,e))}async function $c(e,t,n,r){const s=v(e),i=await function(e,t){const n=v(e),r=v(n.mutationQueue);return n.persistence.runTransaction("Lookup mutation documents","readonly",e=>r.vn(e,t).next(t=>t?n.localDocuments.getDocuments(e,t):se.resolve(null)))}(s.localStore,t);null!==i?("pending"===n?await Ba(s.remoteStore):"acknowledged"===n||"rejected"===n?(Fc(s,t,r||null),Lc(s,t),function(e,t){v(v(e).mutationQueue).Mn(t)}(s.localStore,t)):g(),await Uc(s,i)):d("SyncEngine","Cannot apply mutation batch with id: "+t)}async function Qc(e,t){const n=v(e);if(Xc(n),Zc(n),!0===t&&!0!==n.Fa){const e=n.sharedClientState.getAllActiveQueryTargets(),t=await jc(n,e.toArray());n.Fa=!0,await Ja(n.remoteStore,!0);for(const r of t)Da(n.remoteStore,r)}else if(!1===t&&!1!==n.Fa){const e=[];let t=Promise.resolve();n.pa.forEach((r,s)=>{n.sharedClientState.isLocalQueryTarget(s)?e.push(s):t=t.then(()=>(Rc(n,s),Ko(n.localStore,s,!0))),Na(n.remoteStore,s)}),await t,await jc(n,e),function(e){const t=v(e);t.Sa.forEach((e,n)=>{Na(t.remoteStore,n)}),t.ba.mr(),t.Sa=new Map,t.wa=new Xe(G.comparator)}(n),n.Fa=!1,await Ja(n.remoteStore,!1)}}async function jc(e,t,n){const r=v(e),s=[],i=[];for(const o of t){let e;const t=r.pa.get(o);if(t&&0!==t.length){e=await Go(r.localStore,Cn(t[0]));for(const e of t){const t=r.ga.get(e),n=await Gc(r,t);n.snapshot&&i.push(n.snapshot)}}else{const t=await Qo(r.localStore,o);e=await Go(r.localStore,t),await xc(r,Wc(t),o,!1,e.resumeToken)}s.push(e)}return r.fa.u_(i),s}function Wc(e){return bn(e.path,e.collectionGroup,e.orderBy,e.filters,e.limit,"F",e.startAt,e.endAt)}function Hc(e){return function(e){return v(v(e).persistence).Li()}(v(e).localStore)}async function Yc(e,t,n,r){const s=v(e);if(s.Fa)return void d("SyncEngine","Ignoring unexpected query state notification.");const i=s.pa.get(t);if(i&&i.length>0)switch(n){case"current":case"not-current":{const e=await jo(s.localStore,Rn(i[0])),r=jr.createSynthesizedRemoteEventForCurrentChange(t,"current"===n,at.EMPTY_BYTE_STRING);await Uc(s,e,r);break}case"rejected":await Ko(s.localStore,t,!0),Rc(s,t,r);break;default:g()}}async function Jc(e,t,n){const r=Xc(e);if(r.Fa){for(const e of t){if(r.pa.has(e)){d("SyncEngine","Adding an already active target "+e);continue}const t=await Qo(r.localStore,e),n=await Go(r.localStore,t);await xc(r,Wc(t),n.targetId,!1,n.resumeToken),Da(r.remoteStore,n)}for(const e of n)r.pa.has(e)&&await Ko(r.localStore,e,!1).then(()=>{Na(r.remoteStore,e),Rc(r,e)}).catch(re)}}function Xc(e){const t=v(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=Cc.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=zc.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Nc.bind(null,t),t.fa.u_=uc.bind(null,t.eventManager),t.fa.xa=lc.bind(null,t.eventManager),t}function Zc(e){const t=v(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=Ac.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=kc.bind(null,t),t}function eu(e,t,n){const r=v(e);(async function(e,t,n){try{const r=await t.getMetadata();if(await function(e,t){const n=v(e),r=ls(t.createTime);return n.persistence.runTransaction("hasNewerBundle","readonly",e=>n.$r.getBundleMetadata(e,t.id)).then(e=>!!e&&e.createTime.compareTo(r)>=0)}(e.localStore,r))return await t.close(),n._completeWith(function(e){return{taskState:"Success",documentsLoaded:e.totalDocuments,bytesLoaded:e.totalBytes,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}(r)),Promise.resolve(new Set);n._updateProgress(gc(r));const s=new pc(r,e.localStore,t.serializer);let i=await t.Oa();for(;i;){const e=await s.na(i);e&&n._updateProgress(e),i=await t.Oa()}const o=await s.complete();return await Uc(e,o.sa,void 0),await function(e,t){const n=v(e);return n.persistence.runTransaction("Save bundle","readwrite",e=>n.$r.saveBundleMetadata(e,t))}(e.localStore,r),n._completeWith(o.progress),Promise.resolve(o.ia)}catch(e){return m("SyncEngine",`Loading bundle failed with ${e}`),n._failWith(e),Promise.resolve(new Set)}})(r,t,n).then(e=>{r.sharedClientState.notifyBundleLoaded(e)})}class tu{constructor(){this.synchronizeTabs=!1}async initialize(e){this.serializer=ya(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return Po(this.persistence,new Fo,e.initialUser,this.serializer)}createPersistence(e){return new _o(Eo.Hr,this.serializer)}createSharedClientState(e){return new oa}async terminate(){var e,t;null===(e=this.gcScheduler)||void 0===e||e.stop(),null===(t=this.indexBackfillerScheduler)||void 0===t||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class nu extends tu{constructor(e){super(),this.cacheSizeBytes=e}createGarbageCollectionScheduler(e,t){y(this.persistence.referenceDelegate instanceof xo);const n=this.persistence.referenceDelegate.garbageCollector;return new Yi(n,e.asyncQueue,t)}createPersistence(e){const t=void 0!==this.cacheSizeBytes?Ri.withCacheSize(this.cacheSizeBytes):Ri.DEFAULT;return new _o(e=>xo.Hr(e,t),this.serializer)}}class ru extends tu{constructor(e,t,n){super(),this.Na=e,this.cacheSizeBytes=t,this.forceOwnership=n,this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Na.initialize(this,e),await Zc(this.Na.syncEngine),await Ba(this.Na.remoteStore),await this.persistence.fi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}createLocalStore(e){return Po(this.persistence,new Fo,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,t){const n=this.persistence.referenceDelegate.garbageCollector;return new Yi(n,e.asyncQueue,t)}createIndexBackfillerScheduler(e,t){const n=new pe(t,this.persistence);return new me(e.asyncQueue,n)}createPersistence(e){const t=ko(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?Ri.withCacheSize(this.cacheSizeBytes):Ri.DEFAULT;return new Do(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,pa(),ga(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new oa}}class su extends ru{constructor(e,t){super(e,t,!1),this.Na=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.Na.syncEngine;this.sharedClientState instanceof ia&&(this.sharedClientState.syncEngine={Zs:$c.bind(null,t),Xs:Yc.bind(null,t),eo:Jc.bind(null,t),Li:Hc.bind(null,t),Ys:Kc.bind(null,t)},await this.sharedClientState.start()),await this.persistence.fi(async e=>{await Qc(this.Na.syncEngine,e),this.gcScheduler&&(e&&!this.gcScheduler.started?this.gcScheduler.start():e||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(e&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():e||this.indexBackfillerScheduler.stop())})}createSharedClientState(e){const t=pa();if(!ia.D(t))throw new _(I.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const n=ko(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new ia(t,e.asyncQueue,n,e.clientId,e.initialUser)}}class iu{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=(e=>Dc(this.syncEngine,e,1)),this.remoteStore.remoteSyncer.handleCredentialChange=Bc.bind(null,this.syncEngine),await Ja(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new oc}createDatastore(e){const t=ya(e.databaseInfo.databaseId),n=function(e){return new ma(e)}(e.databaseInfo);return function(e,t,n,r){return new ba(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(e,t,n,r,s){return new Ta(e,t,n,r,s)}(this.localStore,this.datastore,e.asyncQueue,e=>Dc(this.syncEngine,e,0),ca.D()?new ca:new aa)}createSyncEngine(e,t){return function(e,t,n,r,s,i,o){const a=new bc(e,t,n,r,s,i);return o&&(a.Fa=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e;await async function(e){const t=v(e);d("RemoteStore","RemoteStore shutting down."),t.v_.add(5),await Ca(t),t.M_.shutdown(),t.x_.set("Unknown")}(this.remoteStore),null===(e=this.datastore)||void 0===e||e.terminate()}}function ou(e,t=10240){let n=0;return{async read(){if(n<e.byteLength){const r={value:e.slice(n,n+t),done:!1};return n+=t,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}class au{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ba(this.observer.next,e)}error(e){this.observer.error?this.Ba(this.observer.error,e):f("Uncaught Error in snapshot listener:",e.toString())}La(){this.muted=!0}Ba(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}class cu{constructor(e,t){this.ka=e,this.serializer=t,this.metadata=new b,this.buffer=new Uint8Array,this.qa=new TextDecoder("utf-8"),this.Qa().then(e=>{e&&e.ea()?this.metadata.resolve(e.X_.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is\n             ${JSON.stringify(null==e?void 0:e.X_)}`))},e=>this.metadata.reject(e))}close(){return this.ka.cancel()}async getMetadata(){return this.metadata.promise}async Oa(){return await this.getMetadata(),this.Qa()}async Qa(){const e=await this.Ka();if(null===e)return null;const t=this.qa.decode(e),n=Number(t);isNaN(n)&&this.$a(`length string (${t}) is not valid number`);const r=await this.Ua(n);return new fc(JSON.parse(r),e.length+n)}Wa(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}async Ka(){for(;this.Wa()<0&&!(await this.Ga()););if(0===this.buffer.length)return null;const e=this.Wa();e<0&&this.$a("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async Ua(e){for(;this.buffer.length<e;)await this.Ga()&&this.$a("Reached the end of bundle when more is expected.");const t=this.qa.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}$a(e){throw this.ka.cancel(),new Error(`Invalid bundle format: ${e}`)}async Ga(){const e=await this.ka.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}class uu{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new _(I.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await async function(e,t){const n=v(e),r={documents:t.map(e=>ms(n.serializer,e))},s=await n.vo("BatchGetDocuments",n.serializer.databaseId,U.emptyPath(),r,t.length),i=new Map;s.forEach(e=>{const t=bs(n.serializer,e);i.set(t.key.toString(),t)});const o=[];return t.forEach(e=>{const t=i.get(e.toString());y(!!t),o.push(t)}),o}(this.datastore,e);return t.forEach(e=>this.recordVersion(e)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(e){this.lastTransactionError=e}this.writtenDocs.add(e.toString())}delete(e){this.write(new Nr(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((e,t)=>{const n=G.fromPath(t);this.mutations.push(new Ar(n,this.precondition(n)))}),await async function(e,t){const n=v(e),r={writes:t.map(e=>xs(n.serializer,e))};await n.So("Commit",n.serializer.databaseId,U.emptyPath(),r)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw g();t=O.min()}const n=this.readVersions.get(e.key.toString());if(n){if(!t.isEqual(n))throw new _(I.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(O.min())?gr.exists(!1):gr.updateTime(t):gr.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(O.min()))throw new _(I.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return gr.updateTime(t)}return gr.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class lu{constructor(e,t,n,r,s){this.asyncQueue=e,this.datastore=t,this.options=n,this.updateFunction=r,this.deferred=s,this.za=n.maxAttempts,this.jo=new wa(this.asyncQueue,"transaction_retry")}ja(){this.za-=1,this.Ha()}Ha(){this.jo.qo(async()=>{const e=new uu(this.datastore),t=this.Ja(e);t&&t.then(t=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(t)}).catch(e=>{this.Ya(e)}))}).catch(e=>{this.Ya(e)})})}Ja(e){try{const t=this.updateFunction(e);return!ye(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(e){return this.deferred.reject(e),null}}Ya(e){this.za>0&&this.Za(e)?(this.za-=1,this.asyncQueue.enqueueAndForget(()=>(this.Ha(),Promise.resolve()))):this.deferred.reject(e)}Za(e){if("FirebaseError"===e.name){const t=e.code;return"aborted"===t||"failed-precondition"===t||"already-exists"===t||!Or(t)}return!1}}class hu{constructor(e,t,n,r){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=a.UNAUTHENTICATED,this.clientId=L.newId(),this.authCredentialListener=(()=>Promise.resolve()),this.appCheckCredentialListener=(()=>Promise.resolve()),this.authCredentials.start(n,async e=>{d("FirestoreClient","Received user=",e.uid),await this.authCredentialListener(e),this.user=e}),this.appCheckCredentials.start(n,e=>(d("FirestoreClient","Received new app check token=",e),this.appCheckCredentialListener(e,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new _(I.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new b;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=tc(t,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function du(e,t){e.asyncQueue.verifyOperationInProgress(),d("FirestoreClient","Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener(async e=>{r.isEqual(e)||(await Vo(t.localStore,e),r=e)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t}async function fu(e,t){e.asyncQueue.verifyOperationInProgress();const n=await pu(e);d("FirestoreClient","Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener(e=>Ya(t.remoteStore,e)),e.setAppCheckTokenChangeListener((e,n)=>Ya(t.remoteStore,n)),e._onlineComponents=t}function mu(e){return"FirebaseError"===e.name?e.code===I.FAILED_PRECONDITION||e.code===I.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}async function pu(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){d("FirestoreClient","Using user provided OfflineComponentProvider");try{await du(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!mu(n))throw n;m("Error using user provided cache. Falling back to memory cache: "+n),await du(e,new tu)}}else d("FirestoreClient","Using default OfflineComponentProvider"),await du(e,new tu);return e._offlineComponents}async function gu(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(d("FirestoreClient","Using user provided OnlineComponentProvider"),await fu(e,e._uninitializedComponentsProvider._online)):(d("FirestoreClient","Using default OnlineComponentProvider"),await fu(e,new iu))),e._onlineComponents}function yu(e){return pu(e).then(e=>e.persistence)}function wu(e){return pu(e).then(e=>e.localStore)}function vu(e){return gu(e).then(e=>e.remoteStore)}function Iu(e){return gu(e).then(e=>e.syncEngine)}function _u(e){return gu(e).then(e=>e.datastore)}async function bu(e){const t=await gu(e),n=t.eventManager;return n.onListen=Ec.bind(null,t.syncEngine),n.onUnlisten=Tc.bind(null,t.syncEngine),n}function Eu(e){return e.asyncQueue.enqueue(async()=>{const t=await yu(e),n=await vu(e);return t.setNetworkEnabled(!0),function(e){const t=v(e);return t.v_.delete(0),Sa(t)}(n)})}function xu(e){return e.asyncQueue.enqueue(async()=>{const t=await yu(e),n=await vu(e);return t.setNetworkEnabled(!1),async function(e){const t=v(e);t.v_.add(0),await Ca(t),t.x_.set("Offline")}(n)})}function Tu(e,t){const n=new b;return e.asyncQueue.enqueueAndForget(async()=>(async function(e,t,n){try{const r=await function(e,t){const n=v(e);return n.persistence.runTransaction("read document","readonly",e=>n.localDocuments.getDocument(e,t))}(e,t);r.isFoundDocument()?n.resolve(r):r.isNoDocument()?n.resolve(null):n.reject(new _(I.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(e){const r=tc(e,`Failed to get document '${t} from cache`);n.reject(r)}})(await wu(e),t,n)),n.promise}function Su(e,t,n={}){const r=new b;return e.asyncQueue.enqueueAndForget(async()=>(function(e,t,n,r,s){const i=new au({next:i=>{t.enqueueAndForget(()=>cc(e,o));const a=i.docs.has(n);!a&&i.fromCache?s.reject(new _(I.UNAVAILABLE,"Failed to get document because the client is offline.")):a&&i.fromCache&&r&&"server"===r.source?s.reject(new _(I.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(i)},error:e=>s.reject(e)}),o=new dc(En(n.path),i,{includeMetadataChanges:!0,Z_:!0});return ac(e,o)})(await bu(e),e.asyncQueue,t,n,r)),r.promise}function Cu(e,t){const n=new b;return e.asyncQueue.enqueueAndForget(async()=>(async function(e,t,n){try{const r=await $o(e,t,!0),s=new vc(t,r.hs),i=s.ha(r.documents),o=s.applyChanges(i,!1);n.resolve(o.snapshot)}catch(e){const r=tc(e,`Failed to execute query '${t} against cache`);n.reject(r)}})(await wu(e),t,n)),n.promise}function Du(e,t,n={}){const r=new b;return e.asyncQueue.enqueueAndForget(async()=>(function(e,t,n,r,s){const i=new au({next:n=>{t.enqueueAndForget(()=>cc(e,o)),n.fromCache&&"server"===r.source?s.reject(new _(I.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):s.resolve(n)},error:e=>s.reject(e)}),o=new dc(n,i,{includeMetadataChanges:!0,Z_:!0});return ac(e,o)})(await bu(e),e.asyncQueue,t,n,r)),r.promise}function Nu(e,t){const n=new au(t);return e.asyncQueue.enqueueAndForget(async()=>(function(e,t){v(e).K_.add(t),t.next()})(await bu(e),n)),()=>{n.La(),e.asyncQueue.enqueueAndForget(async()=>(function(e,t){v(e).K_.delete(t)})(await bu(e),n))}}function Au(e,t,n,r){const s=function(e,t){let n;return function(e,t){return new cu(e,t)}(function(e,t){if(e instanceof Uint8Array)return ou(e,t);if(e instanceof ArrayBuffer)return ou(new Uint8Array(e),t);if(e instanceof ReadableStream)return e.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(n="string"==typeof e?Br().encode(e):e),t)}(n,ya(t));e.asyncQueue.enqueueAndForget(async()=>{eu(await Iu(e),s,r)})}function ku(e,t){return e.asyncQueue.enqueue(async()=>(function(e,t){const n=v(e);return n.persistence.runTransaction("Get named query","readonly",e=>n.$r.getNamedQuery(e,t))})(await wu(e),t))}function Mu(e,t){return e.asyncQueue.enqueue(async()=>(async function(e,t){const n=v(e),r=n.indexManager,s=[];return n.persistence.runTransaction("Configure indexes","readwrite",e=>r.getFieldIndexes(e).next(n=>(function(e,t,n,r,s){e=[...e],t=[...t],e.sort(n),t.sort(n);const i=e.length,o=t.length;let a=0,c=0;for(;a<o&&c<i;){const i=n(e[c],t[a]);i<0?s(e[c++]):i>0?r(t[a++]):(a++,c++)}for(;a<o;)r(t[a++]);for(;c<i;)s(e[c++])})(n,t,j,t=>{s.push(r.addFieldIndex(e,t))},t=>{s.push(r.deleteFieldIndex(e,t))})).next(()=>se.waitFor(s)))})(await wu(e),t))}function Lu(e,t){return e.asyncQueue.enqueue(async()=>(function(e,t){v(e).ts.Ui=t})(await wu(e),t))}function Fu(e){return e.asyncQueue.enqueue(async()=>(function(e){const t=v(e),n=t.indexManager;return t.persistence.runTransaction("Delete All Indexes","readwrite",e=>n.deleteAllFieldIndexes(e))})(await wu(e)))}function Ru(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const Pu=new Map;function Vu(e,t,n){if(!n)throw new _(I.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function Ou(e,t,n,r){if(!0===t&&!0===r)throw new _(I.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)}function qu(e){if(!G.isDocumentKey(e))throw new _(I.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function Uu(e){if(G.isDocumentKey(e))throw new _(I.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function Bu(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return"function"==typeof e?"a function":g()}function zu(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new _(I.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Bu(e);throw new _(I.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}function Gu(e,t){if(t<=0)throw new _(I.INVALID_ARGUMENT,`Function ${e}() requires a positive number, but it was: ${t}.`)}class Ku{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new _(I.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new _(I.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Ou("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Ru(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new _(I.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<5)throw new _(I.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is 5)`);if(e.timeoutSeconds>30)throw new _(I.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class $u{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Ku({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new _(I.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new _(I.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Ku(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new x;switch(e.type){case"firstParty":return new D(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new _(I.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=Pu.get(e);t&&(d("ComponentProvider","Removing Datastore"),Pu.delete(e),t.terminate())}(this),Promise.resolve()}}function Qu(e,t,n,r={}){var i;const o=(e=zu(e,$u))._getSettings(),c=`${t}:${n}`;if("firestore.googleapis.com"!==o.host&&o.host!==c&&m("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},o),{host:c,ssl:!1})),r.mockUserToken){let t,n;if("string"==typeof r.mockUserToken)t=r.mockUserToken,n=a.MOCK_USER;else{t=(0,s.createMockUserToken)(r.mockUserToken,null===(i=e._app)||void 0===i?void 0:i.options.projectId);const o=r.mockUserToken.sub||r.mockUserToken.user_id;if(!o)throw new _(I.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new a(o)}e._authCredentials=new T(new E(t,n))}}class ju{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new ju(this.firestore,e,this._query)}}exports.Query=ju;class Wu{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Hu(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Wu(this.firestore,e,this._key)}}exports.DocumentReference=Wu;class Hu extends ju{constructor(e,t,n){super(e,t,En(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Wu(this.firestore,null,new G(e))}withConverter(e){return new Hu(this.firestore,e,this._path)}}function Yu(e,t,...n){if(e=(0,s.getModularInstance)(e),Vu("collection","path",t),e instanceof $u){const r=U.fromString(t,...n);return Uu(r),new Hu(e,null,r)}{if(!(e instanceof Wu||e instanceof Hu))throw new _(I.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(U.fromString(t,...n));return Uu(r),new Hu(e.firestore,null,r)}}function Ju(e,t){if(e=zu(e,$u),Vu("collectionGroup","collection id",t),t.indexOf("/")>=0)throw new _(I.INVALID_ARGUMENT,`Invalid collection ID '${t}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new ju(e,null,function(e){return new _n(U.emptyPath(),e)}(t))}function Xu(e,t,...n){if(e=(0,s.getModularInstance)(e),1===arguments.length&&(t=L.newId()),Vu("doc","path",t),e instanceof $u){const r=U.fromString(t,...n);return qu(r),new Wu(e,null,new G(r))}{if(!(e instanceof Wu||e instanceof Hu))throw new _(I.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(U.fromString(t,...n));return qu(r),new Wu(e.firestore,e instanceof Hu?e.converter:null,new G(r))}}function Zu(e,t){return e=(0,s.getModularInstance)(e),t=(0,s.getModularInstance)(t),(e instanceof Wu||e instanceof Hu)&&(t instanceof Wu||t instanceof Hu)&&e.firestore===t.firestore&&e.path===t.path&&e.converter===t.converter}function el(e,t){return e=(0,s.getModularInstance)(e),t=(0,s.getModularInstance)(t),e instanceof ju&&t instanceof ju&&e.firestore===t.firestore&&kn(e._query,t._query)&&e.converter===t.converter}exports.CollectionReference=Hu;class tl{constructor(){this.Xa=Promise.resolve(),this.eu=[],this.tu=!1,this.nu=[],this.ru=null,this.iu=!1,this.su=!1,this.ou=[],this.jo=new wa(this,"async_queue_retry"),this._u=(()=>{const e=ga();e&&d("AsyncQueue","Visibility state changed to "+e.visibilityState),this.jo.Ko()});const e=ga();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this._u)}get isShuttingDown(){return this.tu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.au(),this.uu(e)}enterRestrictedMode(e){if(!this.tu){this.tu=!0,this.su=e||!1;const t=ga();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this._u)}}enqueue(e){if(this.au(),this.tu)return new Promise(()=>{});const t=new b;return this.uu(()=>this.tu&&this.su?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.eu.push(e),this.cu()))}async cu(){if(0!==this.eu.length){try{await this.eu[0](),this.eu.shift(),this.jo.reset()}catch(e){if(!ue(e))throw e;d("AsyncQueue","Operation failed with retryable error: "+e)}this.eu.length>0&&this.jo.qo(()=>this.cu())}}uu(e){const t=this.Xa.then(()=>(this.iu=!0,e().catch(e=>{throw this.ru=e,this.iu=!1,f("INTERNAL UNHANDLED ERROR: ",function(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e)),e}).then(e=>(this.iu=!1,e))));return this.Xa=t,t}enqueueAfterDelay(e,t,n){this.au(),this.ou.indexOf(e)>-1&&(t=0);const r=ec.createAndSchedule(this,e,t,n,e=>this.lu(e));return this.nu.push(r),r}au(){this.ru&&g()}verifyOperationInProgress(){}async hu(){let e;do{e=this.Xa,await e}while(e!==this.Xa)}Pu(e){for(const t of this.nu)if(t.timerId===e)return!0;return!1}Iu(e){return this.hu().then(()=>{this.nu.sort((e,t)=>e.targetTimeMs-t.targetTimeMs);for(const t of this.nu)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.hu()})}Tu(e){this.ou.push(e)}lu(e){const t=this.nu.indexOf(e);this.nu.splice(t,1)}}function nl(e){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const r of t)if(r in n&&"function"==typeof n[r])return!0;return!1}(e,["next","error","complete"])}class rl{constructor(){this._progressObserver={},this._taskCompletionResolver=new b,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,n){this._progressObserver={next:e,error:t,complete:n}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}exports.LoadBundleTask=rl;const sl=exports.CACHE_SIZE_UNLIMITED=-1;class il extends $u{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new tl,this._persistenceKey=(null==r?void 0:r.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||ul(this),this._firestoreClient.terminate()}}function ol(e,n,r){r||(r="(default)");const i=(0,t._getProvider)(e,"firestore");if(i.isInitialized(r)){const e=i.getImmediate({identifier:r}),t=i.getOptions(r);if((0,s.deepEqual)(t,n))return e;throw new _(I.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(void 0!==n.cacheSizeBytes&&void 0!==n.localCache)throw new _(I.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(void 0!==n.cacheSizeBytes&&-1!==n.cacheSizeBytes&&n.cacheSizeBytes<1048576)throw new _(I.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return i.initialize({options:n,instanceIdentifier:r})}function al(e,n){const r="object"==typeof e?e:(0,t.getApp)(),i="string"==typeof e?e:n||"(default)",o=(0,t._getProvider)(r,"firestore").getImmediate({identifier:i});if(!o._initialized){const e=(0,s.getDefaultEmulatorHostnameAndPort)("firestore");e&&Qu(o,...e)}return o}function cl(e){return e._firestoreClient||ul(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function ul(e){var t,n,r;const s=e._freezeSettings(),i=function(e,t,n,r){return new pt(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,Ru(r.experimentalLongPollingOptions),r.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,s);e._firestoreClient=new hu(e._authCredentials,e._appCheckCredentials,e._queue,i),(null===(n=s.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(r=s.localCache)||void 0===r?void 0:r._onlineComponentProvider)&&(e._firestoreClient._uninitializedComponentsProvider={_offlineKind:s.localCache.kind,_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider})}function ll(e,t){Il(e=zu(e,il));const n=cl(e);if(n._uninitializedComponentsProvider)throw new _(I.FAILED_PRECONDITION,"SDK cache is already specified.");m("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const r=e._freezeSettings(),s=new iu;return dl(n,s,new ru(s,r.cacheSizeBytes,null==t?void 0:t.forceOwnership))}function hl(e){Il(e=zu(e,il));const t=cl(e);if(t._uninitializedComponentsProvider)throw new _(I.FAILED_PRECONDITION,"SDK cache is already specified.");m("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=e._freezeSettings(),r=new iu;return dl(t,r,new su(r,n.cacheSizeBytes))}function dl(e,t,n){const r=new b;return e.asyncQueue.enqueue(async()=>{try{await du(e,n),await fu(e,t),r.resolve()}catch(e){const n=e;if(!mu(n))throw n;m("Error enabling indexeddb cache. Falling back to memory cache: "+n),r.reject(n)}}).then(()=>r.promise)}function fl(e){if(e._initialized&&!e._terminated)throw new _(I.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const t=new b;return e._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(e){if(!oe.D())return Promise.resolve();const t=e+"main";await oe.delete(t)}(ko(e._databaseId,e._persistenceKey)),t.resolve()}catch(e){t.reject(e)}}),t.promise}function ml(e){return function(e){const t=new b;return e.asyncQueue.enqueueAndForget(async()=>Mc(await Iu(e),t)),t.promise}(cl(e=zu(e,il)))}function pl(e){return Eu(cl(e=zu(e,il)))}function gl(e){return xu(cl(e=zu(e,il)))}function yl(e){return(0,t._removeServiceInstance)(e.app,"firestore",e._databaseId.database),e._delete()}function wl(e,t){const n=cl(e=zu(e,il)),r=new rl;return Au(n,e._databaseId,t,r),r}function vl(e,t){return ku(cl(e=zu(e,il)),t).then(t=>t?new ju(e,null,t.query):null)}function Il(e){if(e._initialized||e._terminated)throw new _(I.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}exports.Firestore=il;class _l{constructor(e="count",t){this._internalFieldPath=t,this.type="AggregateField",this.aggregateType=e}}exports.AggregateField=_l;class bl{constructor(e,t,n){this._userDataWriter=t,this._data=n,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}}exports.AggregateQuerySnapshot=bl;class El{constructor(e){this._byteString=e}static fromBase64String(e){try{return new El(at.fromBase64String(e))}catch(e){throw new _(I.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new El(at.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}exports.Bytes=El;class xl{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new _(I.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new z(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}function Tl(){return new xl("__name__")}exports.FieldPath=xl;class Sl{constructor(e){this._methodName=e}}exports.FieldValue=Sl;class Cl{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new _(I.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new _(I.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return F(this._lat,e._lat)||F(this._long,e._long)}}exports.GeoPoint=Cl;const Dl=/^__.*__$/;class Nl{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new Tr(e,this.data,this.fieldMask,t,this.fieldTransforms):new xr(e,this.data,t,this.fieldTransforms)}}class Al{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new Tr(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function kl(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw g()}}class Ml{constructor(e,t,n,r,s,i){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===s&&this.Eu(),this.fieldTransforms=s||[],this.fieldMask=i||[]}get path(){return this.settings.path}get du(){return this.settings.du}Au(e){return new Ml(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ru(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Au({path:n,Vu:!1});return r.mu(e),r}fu(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Au({path:n,Vu:!1});return r.Eu(),r}gu(e){return this.Au({path:void 0,Vu:!0})}pu(e){return Xl(e,this.settings.methodName,this.settings.yu||!1,this.path,this.settings.wu)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}Eu(){if(this.path)for(let e=0;e<this.path.length;e++)this.mu(this.path.get(e))}mu(e){if(0===e.length)throw this.pu("Document fields must not be empty");if(kl(this.du)&&Dl.test(e))throw this.pu('Document fields cannot begin and end with "__"')}}class Ll{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||ya(e)}Su(e,t,n,r=!1){return new Ml({du:e,methodName:t,wu:n,path:z.emptyPath(),Vu:!1,yu:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Fl(e){const t=e._freezeSettings(),n=ya(e._databaseId);return new Ll(e._databaseId,!!t.ignoreUndefinedProperties,n)}function Rl(e,t,n,r,s,i={}){const o=e.Su(i.merge||i.mergeFields?2:0,t,n,s);Wl("Data must be an object, but it was:",o,r);const a=Ql(r,o);let c,u;if(i.merge)c=new st(o.fieldMask),u=o.fieldTransforms;else if(i.mergeFields){const e=[];for(const r of i.mergeFields){const s=Hl(t,r,n);if(!o.contains(s))throw new _(I.INVALID_ARGUMENT,`Field '${s}' is specified in your field mask but missing from your input data.`);Zl(e,s)||e.push(s)}c=new st(e),u=o.fieldTransforms.filter(e=>c.covers(e.field))}else c=null,u=o.fieldTransforms;return new Nl(new qt(a),c,u)}class Pl extends Sl{_toFieldTransform(e){if(2!==e.du)throw 1===e.du?e.pu(`${this._methodName}() can only appear at the top level of your update data`):e.pu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Pl}}function Vl(e,t,n){return new Ml({du:3,wu:t.settings.wu,methodName:e._methodName,Vu:n},t.databaseId,t.serializer,t.ignoreUndefinedProperties)}class Ol extends Sl{_toFieldTransform(e){return new fr(e.path,new ir)}isEqual(e){return e instanceof Ol}}class ql extends Sl{constructor(e,t){super(e),this.bu=t}_toFieldTransform(e){const t=Vl(this,e,!0),n=this.bu.map(e=>$l(e,t)),r=new or(n);return new fr(e.path,r)}isEqual(e){return e instanceof ql&&(0,s.deepEqual)(this.bu,e.bu)}}class Ul extends Sl{constructor(e,t){super(e),this.bu=t}_toFieldTransform(e){const t=Vl(this,e,!0),n=this.bu.map(e=>$l(e,t)),r=new cr(n);return new fr(e.path,r)}isEqual(e){return e instanceof Ul&&(0,s.deepEqual)(this.bu,e.bu)}}class Bl extends Sl{constructor(e,t){super(e),this.Du=t}_toFieldTransform(e){const t=new lr(e.serializer,er(e.serializer,this.Du));return new fr(e.path,t)}isEqual(e){return e instanceof Bl&&this.Du===e.Du}}function zl(e,t,n,r){const i=e.Su(1,t,n);Wl("Data must be an object, but it was:",i,r);const o=[],a=qt.empty();Ye(r,(e,r)=>{const c=Jl(t,e,n);r=(0,s.getModularInstance)(r);const u=i.fu(c);if(r instanceof Pl)o.push(c);else{const e=$l(r,u);null!=e&&(o.push(c),a.set(c,e))}});const c=new st(o);return new Al(a,c,i.fieldTransforms)}function Gl(e,t,n,r,i,o){const a=e.Su(1,t,n),c=[Hl(t,r,n)],u=[i];if(o.length%2!=0)throw new _(I.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let s=0;s<o.length;s+=2)c.push(Hl(t,o[s])),u.push(o[s+1]);const l=[],h=qt.empty();for(let f=c.length-1;f>=0;--f)if(!Zl(l,c[f])){const e=c[f];let t=u[f];t=(0,s.getModularInstance)(t);const n=a.fu(e);if(t instanceof Pl)l.push(e);else{const r=$l(t,n);null!=r&&(l.push(e),h.set(e,r))}}const d=new st(l);return new Al(h,d,a.fieldTransforms)}function Kl(e,t,n,r=!1){return $l(n,e.Su(r?4:3,t))}function $l(e,t){if(jl(e=(0,s.getModularInstance)(e)))return Wl("Unsupported field value:",t,e),Ql(e,t);if(e instanceof Sl)return function(e,t){if(!kl(t.du))throw t.pu(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t.pu(`${e._methodName}() is not currently supported inside arrays`);const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.Vu&&4!==t.du)throw t.pu("Nested arrays are not supported");return function(e,t){const n=[];let r=0;for(const s of e){let e=$l(s,t.gu(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=(0,s.getModularInstance)(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return er(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=V.fromDate(e);return{timestampValue:as(t.serializer,n)}}if(e instanceof V){const n=new V(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:as(t.serializer,n)}}if(e instanceof Cl)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof El)return{bytesValue:cs(t.serializer,e._byteString)};if(e instanceof Wu){const n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t.pu(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:hs(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t.pu(`Unsupported field value: ${Bu(e)}`)}(e,t)}function Ql(e,t){const n={};return Je(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Ye(e,(e,r)=>{const s=$l(r,t.Ru(e));null!=s&&(n[e]=s)}),{mapValue:{fields:n}}}function jl(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof V||e instanceof Cl||e instanceof El||e instanceof Wu||e instanceof Sl)}function Wl(e,t,n){if(!jl(n)||!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(n)){const r=Bu(n);throw"an object"===r?t.pu(e+" a custom object"):t.pu(e+" "+r)}}function Hl(e,t,n){if((t=(0,s.getModularInstance)(t))instanceof xl)return t._internalPath;if("string"==typeof t)return Jl(e,t);throw Xl("Field path arguments must be of type string or ",e,!1,void 0,n)}const Yl=new RegExp("[~\\*/\\[\\]]");function Jl(e,t,n){if(t.search(Yl)>=0)throw Xl(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new xl(...t.split("."))._internalPath}catch(r){throw Xl(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function Xl(e,t,n,r,s){const i=r&&!r.isEmpty(),o=void 0!==s;let a=`Function ${t}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(i||o)&&(c+=" (found",i&&(c+=` in field ${r}`),o&&(c+=` in document ${s}`),c+=")"),new _(I.INVALID_ARGUMENT,a+e+c)}function Zl(e,t){return e.some(e=>e.isEqual(t))}class eh{constructor(e,t,n,r,s){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Wu(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new th(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(nh("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class th extends eh{data(){return super.data()}}function nh(e,t){return"string"==typeof t?Jl(e,t):t instanceof xl?t._internalPath:t._delegate._internalPath}function rh(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new _(I.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class sh{}class ih extends sh{}function oh(e,t,...n){let r=[];t instanceof sh&&r.push(t),function(e){const t=e.filter(e=>e instanceof uh).length,n=e.filter(e=>e instanceof ah).length;if(t>1||t>0&&n>0)throw new _(I.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r=r.concat(n));for(const s of r)e=s._apply(e);return e}exports.QueryConstraint=ih;class ah extends ih{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new ah(e,t,n)}_apply(e){const t=this._parse(e);return Sh(e._query,t),new ju(e.firestore,e.converter,Nn(e._query,t))}_parse(e){const t=Fl(e.firestore);return function(e,t,n,r,s,i,o){let a;if(s.isKeyField()){if("array-contains"===i||"array-contains-any"===i)throw new _(I.INVALID_ARGUMENT,`Invalid Query. You can't perform '${i}' queries on documentId().`);if("in"===i||"not-in"===i){Th(o,i);const t=[];for(const n of o)t.push(xh(r,e,n));a={arrayValue:{values:t}}}else a=xh(r,e,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||Th(o,i),a=Kl(n,t,o,"in"===i||"not-in"===i);return Wt.create(s,i,a)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function ch(e,t,n){const r=t,s=nh("where",e);return ah._create(s,r,n)}exports.QueryFieldFilterConstraint=ah;class uh extends sh{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new uh(e,t)}_parse(e){const t=this._queryConstraints.map(t=>t._parse(e)).filter(e=>e.getFilters().length>0);return 1===t.length?t[0]:Ht.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let n=e;const r=t.getFlattenedFilters();for(const s of r)Sh(n,s),n=Nn(n,s)}(e._query,t),new ju(e.firestore,e.converter,Nn(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}function lh(...e){return e.forEach(e=>Ch("or",e)),uh._create("or",e)}function hh(...e){return e.forEach(e=>Ch("and",e)),uh._create("and",e)}exports.QueryCompositeFilterConstraint=uh;class dh extends ih{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new dh(e,t)}_apply(e){const t=function(e,t,n){if(null!==e.startAt)throw new _(I.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new _(I.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new $t(t,n)}(e._query,this._field,this._direction);return new ju(e.firestore,e.converter,function(e,t){const n=e.explicitOrderBy.concat([t]);return new _n(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}function fh(e,t="asc"){const n=t,r=nh("orderBy",e);return dh._create(r,n)}exports.QueryOrderByConstraint=dh;class mh extends ih{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new mh(e,t,n)}_apply(e){return new ju(e.firestore,e.converter,An(e._query,this._limit,this._limitType))}}function ph(e){return Gu("limit",e),mh._create("limit",e,"F")}function gh(e){return Gu("limitToLast",e),mh._create("limitToLast",e,"L")}exports.QueryLimitConstraint=mh;class yh extends ih{constructor(e,t,n){super(),this.type=e,this._docOrFields=t,this._inclusive=n}static _create(e,t,n){return new yh(e,t,n)}_apply(e){const t=Eh(e,this.type,this._docOrFields,this._inclusive);return new ju(e.firestore,e.converter,function(e,t){return new _n(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,t,e.endAt)}(e._query,t))}}function wh(...e){return yh._create("startAt",e,!0)}function vh(...e){return yh._create("startAfter",e,!1)}exports.QueryStartAtConstraint=yh;class Ih extends ih{constructor(e,t,n){super(),this.type=e,this._docOrFields=t,this._inclusive=n}static _create(e,t,n){return new Ih(e,t,n)}_apply(e){const t=Eh(e,this.type,this._docOrFields,this._inclusive);return new ju(e.firestore,e.converter,function(e,t){return new _n(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,t)}(e._query,t))}}function _h(...e){return Ih._create("endBefore",e,!1)}function bh(...e){return Ih._create("endAt",e,!0)}function Eh(e,t,n,r){if(n[0]=(0,s.getModularInstance)(n[0]),n[0]instanceof eh)return function(e,t,n,r,s){if(!r)throw new _(I.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${n}().`);const i=[];for(const o of Sn(e))if(o.field.isKeyField())i.push(Ct(t,r.key));else{const e=r.data.field(o.field);if(dt(e))throw new _(I.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+o.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===e){const e=o.field.canonicalString();throw new _(I.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${e}' (used as the orderBy) does not exist.`)}i.push(e)}return new zt(i,s)}(e._query,e.firestore._databaseId,t,n[0]._document,r);{const s=Fl(e.firestore);return function(e,t,n,r,s,i){const o=e.explicitOrderBy;if(s.length>o.length)throw new _(I.INVALID_ARGUMENT,`Too many arguments provided to ${r}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const a=[];for(let c=0;c<s.length;c++){const i=s[c];if(o[c].field.isKeyField()){if("string"!=typeof i)throw new _(I.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${r}(), but got a ${typeof i}`);if(!Tn(e)&&-1!==i.indexOf("/"))throw new _(I.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${r}() must be a plain document ID, but '${i}' contains a slash.`);const n=e.path.child(U.fromString(i));if(!G.isDocumentKey(n))throw new _(I.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${r}() must result in a valid document path, but '${n}' is not because it contains an odd number of segments.`);const s=new G(n);a.push(Ct(t,s))}else{const e=Kl(n,r,i);a.push(e)}}return new zt(a,i)}(e._query,e.firestore._databaseId,s,t,n,r)}}function xh(e,t,n){if("string"==typeof(n=(0,s.getModularInstance)(n))){if(""===n)throw new _(I.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Tn(t)&&-1!==n.indexOf("/"))throw new _(I.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=t.path.child(U.fromString(n));if(!G.isDocumentKey(r))throw new _(I.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Ct(e,new G(r))}if(n instanceof Wu)return Ct(e,n._key);throw new _(I.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Bu(n)}.`)}function Th(e,t){if(!Array.isArray(e)||0===e.length)throw new _(I.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function Sh(e,t){const n=function(e,t){for(const n of e)for(const e of n.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new _(I.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new _(I.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${n.toString()}' filters.`)}function Ch(e,t){if(!(t instanceof ah||t instanceof uh))throw new _(I.INVALID_ARGUMENT,`Function ${e}() requires AppliableConstraints created with a call to 'where(...)', 'or(...)', or 'and(...)'.`)}exports.QueryEndAtConstraint=Ih;class Dh{convertValue(e,t="none"){switch(vt(e)){case 0:return null;case 1:return e.booleanValue;case 2:return lt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(ht(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw g()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return Ye(e,(e,r)=>{n[e]=this.convertValue(r,t)}),n}convertGeoPoint(e){return new Cl(lt(e.latitude),lt(e.longitude))}convertArray(e,t){return(e.values||[]).map(e=>this.convertValue(e,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=ft(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(mt(e));default:return null}}convertTimestamp(e){const t=ut(e);return new V(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=U.fromString(e);y(qs(n));const r=new gt(n.get(1),n.get(3)),s=new G(n.popFirst(5));return r.isEqual(t)||f(`Document ${s} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}function Nh(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t}exports.AbstractUserDataWriter=Dh;class Ah extends Dh{constructor(e){super(),this.firestore=e}convertBytes(e){return new El(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Wu(this.firestore,null,t)}}function kh(e){return new _l("sum",Hl("sum",e))}function Mh(e){return new _l("avg",Hl("average",e))}function Lh(){return new _l("count")}function Fh(e,t){var n,r;return e instanceof _l&&t instanceof _l&&e.aggregateType===t.aggregateType&&(null===(n=e._internalFieldPath)||void 0===n?void 0:n.canonicalString())===(null===(r=t._internalFieldPath)||void 0===r?void 0:r.canonicalString())}function Rh(e,t){return el(e.query,t.query)&&(0,s.deepEqual)(e.data(),t.data())}class Ph{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}exports.SnapshotMetadata=Ph;class Vh extends eh{constructor(e,t,n,r,s,i){super(e,t,n,r,i),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Oh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(nh("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}exports.DocumentSnapshot=Vh;class Oh extends Vh{data(e={}){return super.data(e)}}exports.QueryDocumentSnapshot=Oh;class qh{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Ph(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new Oh(this._firestore,this._userDataWriter,n.key,n,new Ph(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new _(I.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map(n=>{const r=new Oh(e._firestore,e._userDataWriter,n.doc.key,n.doc,new Ph(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:r,oldIndex:-1,newIndex:t++}})}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(e=>t||3!==e.type).map(t=>{const r=new Oh(e._firestore,e._userDataWriter,t.doc.key,t.doc,new Ph(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let s=-1,i=-1;return 0!==t.type&&(s=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(i=(n=n.add(t.doc)).indexOf(t.doc.key)),{type:Uh(t.type),doc:r,oldIndex:s,newIndex:i}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function Uh(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return g()}}function Bh(e,t){return e instanceof Vh&&t instanceof Vh?e._firestore===t._firestore&&e._key.isEqual(t._key)&&(null===e._document?null===t._document:e._document.isEqual(t._document))&&e._converter===t._converter:e instanceof qh&&t instanceof qh&&e._firestore===t._firestore&&el(e.query,t.query)&&e.metadata.isEqual(t.metadata)&&e._snapshot.isEqual(t._snapshot)}function zh(e){e=zu(e,Wu);const t=zu(e.firestore,il);return Su(cl(t),e._key).then(n=>nd(t,e,n))}exports.QuerySnapshot=qh;class Gh extends Dh{constructor(e){super(),this.firestore=e}convertBytes(e){return new El(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Wu(this.firestore,null,t)}}function Kh(e){e=zu(e,Wu);const t=zu(e.firestore,il),n=cl(t),r=new Gh(t);return Tu(n,e._key).then(n=>new Vh(t,r,e._key,n,new Ph(null!==n&&n.hasLocalMutations,!0),e.converter))}function $h(e){e=zu(e,Wu);const t=zu(e.firestore,il);return Su(cl(t),e._key,{source:"server"}).then(n=>nd(t,e,n))}function Qh(e){e=zu(e,ju);const t=zu(e.firestore,il),n=cl(t),r=new Gh(t);return rh(e._query),Du(n,e._query).then(n=>new qh(t,r,e,n))}function jh(e){e=zu(e,ju);const t=zu(e.firestore,il),n=cl(t),r=new Gh(t);return Cu(n,e._query).then(n=>new qh(t,r,e,n))}function Wh(e){e=zu(e,ju);const t=zu(e.firestore,il),n=cl(t),r=new Gh(t);return Du(n,e._query,{source:"server"}).then(n=>new qh(t,r,e,n))}function Hh(e,t,n){e=zu(e,Wu);const r=zu(e.firestore,il),s=Nh(e.converter,t,n);return td(r,[Rl(Fl(r),"setDoc",e._key,s,null!==e.converter,n).toMutation(e._key,gr.none())])}function Yh(e,t,n,...r){e=zu(e,Wu);const i=zu(e.firestore,il),o=Fl(i);let a;return td(i,[(a="string"==typeof(t=(0,s.getModularInstance)(t))||t instanceof xl?Gl(o,"updateDoc",e._key,t,n,r):zl(o,"updateDoc",e._key,t)).toMutation(e._key,gr.exists(!0))])}function Jh(e){return td(zu(e.firestore,il),[new Nr(e._key,gr.none())])}function Xh(e,t){const n=zu(e.firestore,il),r=Xu(e),s=Nh(e.converter,t);return td(n,[Rl(Fl(e.firestore),"addDoc",r._key,s,null!==e.converter,{}).toMutation(r._key,gr.exists(!1))]).then(()=>r)}function Zh(e,...t){var n,r,i;e=(0,s.getModularInstance)(e);let o={includeMetadataChanges:!1},a=0;"object"!=typeof t[a]||nl(t[a])||(o=t[a],a++);const c={includeMetadataChanges:o.includeMetadataChanges};if(nl(t[a])){const e=t[a];t[a]=null===(n=e.next)||void 0===n?void 0:n.bind(e),t[a+1]=null===(r=e.error)||void 0===r?void 0:r.bind(e),t[a+2]=null===(i=e.complete)||void 0===i?void 0:i.bind(e)}let u,l,h;if(e instanceof Wu)l=zu(e.firestore,il),h=En(e._key.path),u={next:n=>{t[a]&&t[a](nd(l,e,n))},error:t[a+1],complete:t[a+2]};else{const n=zu(e,ju);l=zu(n.firestore,il),h=n._query;const r=new Gh(l);u={next:e=>{t[a]&&t[a](new qh(l,r,n,e))},error:t[a+1],complete:t[a+2]},rh(e._query)}return function(e,t,n,r){const s=new au(r),i=new dc(t,s,n);return e.asyncQueue.enqueueAndForget(async()=>ac(await bu(e),i)),()=>{s.La(),e.asyncQueue.enqueueAndForget(async()=>cc(await bu(e),i))}}(cl(l),h,c,u)}function ed(e,t){return Nu(cl(e=zu(e,il)),nl(t)?t:{next:t})}function td(e,t){return function(e,t){const n=new b;return e.asyncQueue.enqueueAndForget(async()=>Sc(await Iu(e),t,n)),n.promise}(cl(e),t)}function nd(e,t,n){const r=n.docs.get(t._key),s=new Gh(e);return new Vh(e,s,t._key,r,new Ph(n.hasPendingWrites,n.fromCache),t.converter)}function rd(e){return sd(e,{count:Lh()})}function sd(e,t){const n=zu(e.firestore,il),r=cl(n),s=function(e,t){const n=[];for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.push(t(e[r],r,e));return n}(t,(e,t)=>new Fr(t,e.aggregateType,e._internalFieldPath));return function(e,t,n){const r=new b;return e.asyncQueue.enqueueAndForget(async()=>{try{const s=await _u(e);r.resolve(Ea(s,t,n))}catch(e){r.reject(e)}}),r.promise}(r,e._query,s).then(t=>(function(e,t,n){const r=new Gh(e);return new bl(t,r,n)})(n,e,t))}class id{constructor(e){this.kind="memory",this._onlineComponentProvider=new iu,(null==e?void 0:e.garbageCollector)?this._offlineComponentProvider=e.garbageCollector._offlineComponentProvider:this._offlineComponentProvider=new tu}toJSON(){return{kind:this.kind}}}class od{constructor(e){let t;this.kind="persistent",(null==e?void 0:e.tabManager)?(e.tabManager._initialize(e),t=e.tabManager):(t=pd(void 0))._initialize(e),this._onlineComponentProvider=t._onlineComponentProvider,this._offlineComponentProvider=t._offlineComponentProvider}toJSON(){return{kind:this.kind}}}class ad{constructor(){this.kind="memoryEager",this._offlineComponentProvider=new tu}toJSON(){return{kind:this.kind}}}class cd{constructor(e){this.kind="memoryLru",this._offlineComponentProvider=new nu(e)}toJSON(){return{kind:this.kind}}}function ud(){return new ad}function ld(e){return new cd(null==e?void 0:e.cacheSizeBytes)}function hd(e){return new id(e)}function dd(e){return new od(e)}class fd{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=new iu,this._offlineComponentProvider=new ru(this._onlineComponentProvider,null==e?void 0:e.cacheSizeBytes,this.forceOwnership)}}class md{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=new iu,this._offlineComponentProvider=new su(this._onlineComponentProvider,null==e?void 0:e.cacheSizeBytes)}}function pd(e){return new fd(null==e?void 0:e.forceOwnership)}function gd(){return new md}const yd={maxAttempts:5};class wd{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Fl(e)}set(e,t,n){this._verifyNotCommitted();const r=vd(e,this._firestore),s=Nh(r.converter,t,n),i=Rl(this._dataReader,"WriteBatch.set",r._key,s,null!==r.converter,n);return this._mutations.push(i.toMutation(r._key,gr.none())),this}update(e,t,n,...r){this._verifyNotCommitted();const i=vd(e,this._firestore);let o;return o="string"==typeof(t=(0,s.getModularInstance)(t))||t instanceof xl?Gl(this._dataReader,"WriteBatch.update",i._key,t,n,r):zl(this._dataReader,"WriteBatch.update",i._key,t),this._mutations.push(o.toMutation(i._key,gr.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=vd(e,this._firestore);return this._mutations=this._mutations.concat(new Nr(t._key,gr.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new _(I.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function vd(e,t){if((e=(0,s.getModularInstance)(e)).firestore!==t)throw new _(I.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}exports.WriteBatch=wd;class Id extends class{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=Fl(e)}get(e){const t=vd(e,this._firestore),n=new Ah(this._firestore);return this._transaction.lookup([t._key]).then(e=>{if(!e||1!==e.length)return g();const r=e[0];if(r.isFoundDocument())return new eh(this._firestore,n,r.key,r,t.converter);if(r.isNoDocument())return new eh(this._firestore,n,t._key,null,t.converter);throw g()})}set(e,t,n){const r=vd(e,this._firestore),s=Nh(r.converter,t,n),i=Rl(this._dataReader,"Transaction.set",r._key,s,null!==r.converter,n);return this._transaction.set(r._key,i),this}update(e,t,n,...r){const i=vd(e,this._firestore);let o;return o="string"==typeof(t=(0,s.getModularInstance)(t))||t instanceof xl?Gl(this._dataReader,"Transaction.update",i._key,t,n,r):zl(this._dataReader,"Transaction.update",i._key,t),this._transaction.update(i._key,o),this}delete(e){const t=vd(e,this._firestore);return this._transaction.delete(t._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=vd(e,this._firestore),n=new Gh(this._firestore);return super.get(e).then(e=>new Vh(this._firestore,n,t._key,e._document,new Ph(!1,!1),t.converter))}}function _d(e,t,n){e=zu(e,il);const r=Object.assign(Object.assign({},yd),n);return function(e){if(e.maxAttempts<1)throw new _(I.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(e,t,n){const r=new b;return e.asyncQueue.enqueueAndForget(async()=>{const s=await _u(e);new lu(e.asyncQueue,s,n,t,r).ja()}),r.promise}(cl(e),n=>t(new Id(e,n)),r)}function bd(){return new Pl("deleteField")}function Ed(){return new Ol("serverTimestamp")}function xd(...e){return new ql("arrayUnion",e)}function Td(...e){return new Ul("arrayRemove",e)}function Sd(e){return new Bl("increment",e)}function Cd(e){return cl(e=zu(e,il)),new wd(e,t=>td(e,t))}function Dd(e,t){var n;const r=cl(e=zu(e,il));if(!r._uninitializedComponentsProvider||"memory"===(null===(n=r._uninitializedComponentsProvider)||void 0===n?void 0:n._offlineKind))return m("Cannot enable indexes when persistence is disabled"),Promise.resolve();const s=function(e){const t="string"==typeof e?function(e){try{return JSON.parse(e)}catch(e){throw new _(I.INVALID_ARGUMENT,"Failed to parse JSON: "+(null==e?void 0:e.message))}}(e):e,n=[];if(Array.isArray(t.indexes))for(const r of t.indexes){const e=Nd(r,"collectionGroup"),t=[];if(Array.isArray(r.fields))for(const n of r.fields){const e=Jl("setIndexConfiguration",Nd(n,"fieldPath"));"CONTAINS"===n.arrayConfig?t.push(new W(e,2)):"ASCENDING"===n.order?t.push(new W(e,0)):"DESCENDING"===n.order&&t.push(new W(e,1))}n.push(new K(K.UNKNOWN_ID,e,t,Y.empty()))}return n}(t);return Mu(r,s)}function Nd(e,t){if("string"!=typeof e[t])throw new _(I.INVALID_ARGUMENT,"Missing string value for: "+t);return e[t]}exports.Transaction=Id;class Ad{constructor(e){this._client=e,this.type="PersistentCacheIndexManager"}}function kd(e){var t;e=zu(e,il);const n=Pd.get(e);if(n)return n;const r=cl(e);if("persistent"!==(null===(t=r._uninitializedComponentsProvider)||void 0===t?void 0:t._offlineKind))return null;const s=new Ad(r);return Pd.set(e,s),s}function Md(e){Rd(e,!0)}function Ld(e){Rd(e,!1)}function Fd(e){e._client.verifyNotTerminated(),Fu(e._client).then(e=>d("deleting all persistent cache indexes succeeded")).catch(e=>m("deleting all persistent cache indexes failed",e))}function Rd(e,t){e._client.verifyNotTerminated(),Lu(e._client,t).then(e=>d(`setting persistent cache index auto creation isEnabled=${t} succeeded`)).catch(e=>m(`setting persistent cache index auto creation isEnabled=${t} failed`,e))}exports.PersistentCacheIndexManager=Ad;const Pd=new WeakMap;class Vd{constructor(){throw new Error("instances of this class should not be created")}static onExistenceFilterMismatch(e){return Od.instance.onExistenceFilterMismatch(e)}}exports._TestingHooks=Vd;class Od{constructor(){this.Cu=new Map}static get instance(){return qd||function(e){if(Ur)throw new Error("a TestingHooksSpi instance is already set");Ur=e}(qd=new Od),qd}tt(e){this.Cu.forEach(t=>t(e))}onExistenceFilterMismatch(e){const t=Symbol(),n=this.Cu;return n.set(t,e),()=>n.delete(t)}}let qd=null;!function(e,r=!0){!function(e){c=e}(t.SDK_VERSION),(0,t._registerComponent)(new n.Component("firestore",(e,{instanceIdentifier:t,options:n})=>{const s=e.getProvider("app").getImmediate(),i=new il(new S(e.getProvider("auth-internal")),new A(e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new _(I.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new gt(e.options.projectId,t)}(s,t),s);return n=Object.assign({useFetchStreams:r},n),i._setSettings(n),i},"PUBLIC").setMultipleInstances(!0)),(0,t.registerVersion)(o,"4.4.2",e),(0,t.registerVersion)(o,"4.4.2","esm2017")}();
},{"@firebase/app":"h2Mb","@firebase/component":"vhY9","@firebase/logger":"JJem","@firebase/util":"chA2","@firebase/webchannel-wrapper":"fIlu","process":"pBGv"}],"rrht":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@firebase/firestore");Object.keys(e).forEach(function(r){"default"!==r&&"__esModule"!==r&&(r in exports&&exports[r]===e[r]||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return e[r]}}))});
},{"@firebase/firestore":"lBbe"}],"vCxL":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.__addDisposableResource=k,exports.__assign=void 0,exports.__asyncDelegator=g,exports.__asyncGenerator=x,exports.__asyncValues=O,exports.__await=m,exports.__awaiter=l,exports.__classPrivateFieldGet=T,exports.__classPrivateFieldIn=I,exports.__classPrivateFieldSet=D,exports.__createBinding=void 0,exports.__decorate=o,exports.__disposeResources=A,exports.__esDecorate=i,exports.__exportStar=_,exports.__extends=t,exports.__generator=p,exports.__importDefault=E,exports.__importStar=S,exports.__makeTemplateObject=j,exports.__metadata=f,exports.__param=a,exports.__propKey=s,exports.__read=h,exports.__rest=n,exports.__runInitializers=c,exports.__setFunctionName=u,exports.__spread=v,exports.__spreadArray=w,exports.__spreadArrays=b,exports.__values=d,exports.default=void 0;var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};function t(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}var r=function(){return exports.__assign=r=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)};function n(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}function o(e,t,r,n){var o,a=arguments.length,i=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,n);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(i=(a<3?o(i):a>3?o(t,r,i):o(t,r))||i);return a>3&&i&&Object.defineProperty(t,r,i),i}function a(e,t){return function(r,n){t(r,n,e)}}function i(e,t,r,n,o,a){function i(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var c,s=n.kind,u="getter"===s?"get":"setter"===s?"set":"value",f=!t&&e?n.static?e:e.prototype:null,l=t||(f?Object.getOwnPropertyDescriptor(f,n.name):{}),p=!1,y=r.length-1;y>=0;y--){var _={};for(var d in n)_[d]="access"===d?{}:n[d];for(var d in n.access)_.access[d]=n.access[d];_.addInitializer=function(e){if(p)throw new TypeError("Cannot add initializers after decoration has completed");a.push(i(e||null))};var h=(0,r[y])("accessor"===s?{get:l.get,set:l.set}:l[u],_);if("accessor"===s){if(void 0===h)continue;if(null===h||"object"!=typeof h)throw new TypeError("Object expected");(c=i(h.get))&&(l.get=c),(c=i(h.set))&&(l.set=c),(c=i(h.init))&&o.unshift(c)}else(c=i(h))&&("field"===s?o.unshift(c):l[u]=c)}f&&Object.defineProperty(f,n.name,l),p=!0}function c(e,t,r){for(var n=arguments.length>2,o=0;o<t.length;o++)r=n?t[o].call(e,r):t[o].call(e);return n?r:void 0}function s(e){return"symbol"==typeof e?e:"".concat(e)}function u(e,t,r){return"symbol"==typeof t&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function f(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function l(e,t,r,n){return new(r||(r=Promise))(function(o,a){function i(e){try{s(n.next(e))}catch(t){a(t)}}function c(e){try{s(n.throw(e))}catch(t){a(t)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(i,c)}s((n=n.apply(e,t||[])).next())})}function p(e,t){var r,n,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(s){return function(c){if(r)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(r=1,n&&(o=2&c[0]?n.return:c[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,c[1])).done)return o;switch(n=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,n=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===c[0]||2===c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(s){c=[6,s],n=0}finally{r=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}}exports.__assign=r;var y=exports.__createBinding=Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function _(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||y(t,e,r)}function d(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function h(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,a=r.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)i.push(n.value)}catch(c){o={error:c}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}return i}function v(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(h(arguments[t]));return e}function b(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var a=arguments[t],i=0,c=a.length;i<c;i++,o++)n[o]=a[i];return n}function w(e,t,r){if(r||2===arguments.length)for(var n,o=0,a=t.length;o<a;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}function m(e){return this instanceof m?(this.v=e,this):new m(e)}function x(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),a=[];return n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n;function i(e){o[e]&&(n[e]=function(t){return new Promise(function(r,n){a.push([e,t,r,n])>1||c(e,t)})})}function c(e,t){try{(r=o[e](t)).value instanceof m?Promise.resolve(r.value.v).then(s,u):f(a[0][2],r)}catch(n){f(a[0][3],n)}var r}function s(e){c("next",e)}function u(e){c("throw",e)}function f(e,t){e(t),a.shift(),a.length&&c(a[0][0],a[0][1])}}function g(e){var t,r;return t={},n("next"),n("throw",function(e){throw e}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){t[n]=e[n]?function(t){return(r=!r)?{value:m(e[n](t)),done:!1}:o?o(t):t}:o}}function O(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e="function"==typeof d?d(e):e[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise(function(n,o){(function(e,t,r,n){Promise.resolve(n).then(function(t){e({value:t,done:r})},t)})(n,o,(t=e[r](t)).done,t.value)})}}}function j(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var P=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function S(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&y(t,e,r);return P(t,e),t}function E(e){return e&&e.__esModule?e:{default:e}}function T(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function D(e,t,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(e,r):o?o.value=r:t.set(e,r),r}function I(e,t){if(null===t||"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?t===e:e.has(t)}function k(e,t,r){if(null!=t){if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object expected.");var n;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=t[Symbol.asyncDispose]}if(void 0===n){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=t[Symbol.dispose]}if("function"!=typeof n)throw new TypeError("Object not disposable.");e.stack.push({value:t,dispose:n,async:r})}else r&&e.stack.push({async:!0});return t}var R="function"==typeof SuppressedError?SuppressedError:function(e,t,r){var n=new Error(r);return n.name="SuppressedError",n.error=e,n.suppressed=t,n};function A(e){function t(t){e.error=e.hasError?new R(t,e.error,"An error was suppressed during disposal."):t,e.hasError=!0}return function r(){for(;e.stack.length;){var n=e.stack.pop();try{var o=n.dispose&&n.dispose.call(n.value);if(n.async)return Promise.resolve(o).then(r,function(e){return t(e),r()})}catch(a){t(a)}}if(e.hasError)throw e.error}()}var F=exports.default={__extends:t,__assign:r,__rest:n,__decorate:o,__param:a,__metadata:f,__awaiter:l,__generator:p,__createBinding:y,__exportStar:_,__values:d,__read:h,__spread:v,__spreadArrays:b,__spreadArray:w,__await:m,__asyncGenerator:x,__asyncDelegator:g,__asyncValues:O,__makeTemplateObject:j,__importStar:S,__importDefault:E,__classPrivateFieldGet:T,__classPrivateFieldSet:D,__classPrivateFieldIn:I,__addDisposableResource:k,__disposeResources:A};
},{}],"O7lw":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.A=exports.$=void 0,exports.B=ei,exports.C=ti,exports.D=ni,exports.E=ii,exports.I=exports.H=exports.G=exports.F=void 0,exports.J=st,exports.K=at,exports.a=exports._=exports.Z=exports.Y=exports.X=exports.W=exports.V=exports.U=exports.T=exports.S=exports.R=exports.Q=exports.P=exports.O=exports.N=exports.M=exports.L=void 0,exports.a0=en,exports.a1=dn,exports.a2=ln,exports.a3=hn,exports.a4=mn,exports.a5=Tn,exports.a6=yn,exports.a7=wn,exports.a8=En,exports.a9=kn,exports.aA=De,exports.aB=T,exports.aC=k,exports.aD=void 0,exports.aE=_e,exports.aF=we,exports.aG=$r,exports.aH=Ur,exports.aI=xr,exports.aJ=Ge,exports.aL=exports.aK=void 0,exports.aM=Ve,exports.aN=Si,exports.aQ=exports.aP=exports.aO=void 0,exports.aa=An,exports.ab=Sn,exports.ac=Rn,exports.ad=Nn,exports.ae=On,exports.af=bn,exports.ag=Cn,exports.ah=Dn,exports.ai=void 0,exports.aj=Vt,exports.ak=Mn,exports.al=xn,exports.am=Un,exports.an=ee,exports.ao=te,exports.ap=sn,exports.aq=Kn,exports.ar=de,exports.as=oi,exports.at=mi,exports.au=S,exports.av=Ce,exports.aw=Oe,exports.ax=_,exports.ay=Ns,exports.az=es,exports.b=void 0,exports.c=Rr,exports.d=Or,exports.e=Nr,exports.f=Hr,exports.g=Gr,exports.h=jr,exports.i=void 0,exports.j=Kr,exports.k=void 0,exports.l=fr,exports.n=exports.m=void 0,exports.o=Js,exports.p=void 0,exports.q=$n,exports.r=gr,exports.s=mr,exports.t=Bn,exports.u=Ir,exports.v=Jn,exports.w=Yn,exports.x=Xn,exports.y=Qn,exports.z=Zn;var e=require("@firebase/util"),t=require("@firebase/app"),n=require("@firebase/logger"),i=require("tslib"),r=require("@firebase/component");const s=exports.F={PHONE:"phone",TOTP:"totp"},o=exports.p={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},a=exports.S={EMAIL_LINK:"emailLink",EMAIL_PASSWORD:"password",FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PHONE:"phone",TWITTER:"twitter.com"},c=exports.O={LINK:"link",REAUTHENTICATE:"reauthenticate",SIGN_IN:"signIn"},u=exports.A={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};function d(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements."}}function l(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const h=exports.G=d,p=exports.H=l,m=new e.ErrorFactory("auth","Firebase",l()),f=exports.I={ADMIN_ONLY_OPERATION:"auth/admin-restricted-operation",ARGUMENT_ERROR:"auth/argument-error",APP_NOT_AUTHORIZED:"auth/app-not-authorized",APP_NOT_INSTALLED:"auth/app-not-installed",CAPTCHA_CHECK_FAILED:"auth/captcha-check-failed",CODE_EXPIRED:"auth/code-expired",CORDOVA_NOT_READY:"auth/cordova-not-ready",CORS_UNSUPPORTED:"auth/cors-unsupported",CREDENTIAL_ALREADY_IN_USE:"auth/credential-already-in-use",CREDENTIAL_MISMATCH:"auth/custom-token-mismatch",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"auth/requires-recent-login",DEPENDENT_SDK_INIT_BEFORE_AUTH:"auth/dependent-sdk-initialized-before-auth",DYNAMIC_LINK_NOT_ACTIVATED:"auth/dynamic-link-not-activated",EMAIL_CHANGE_NEEDS_VERIFICATION:"auth/email-change-needs-verification",EMAIL_EXISTS:"auth/email-already-in-use",EMULATOR_CONFIG_FAILED:"auth/emulator-config-failed",EXPIRED_OOB_CODE:"auth/expired-action-code",EXPIRED_POPUP_REQUEST:"auth/cancelled-popup-request",INTERNAL_ERROR:"auth/internal-error",INVALID_API_KEY:"auth/invalid-api-key",INVALID_APP_CREDENTIAL:"auth/invalid-app-credential",INVALID_APP_ID:"auth/invalid-app-id",INVALID_AUTH:"auth/invalid-user-token",INVALID_AUTH_EVENT:"auth/invalid-auth-event",INVALID_CERT_HASH:"auth/invalid-cert-hash",INVALID_CODE:"auth/invalid-verification-code",INVALID_CONTINUE_URI:"auth/invalid-continue-uri",INVALID_CORDOVA_CONFIGURATION:"auth/invalid-cordova-configuration",INVALID_CUSTOM_TOKEN:"auth/invalid-custom-token",INVALID_DYNAMIC_LINK_DOMAIN:"auth/invalid-dynamic-link-domain",INVALID_EMAIL:"auth/invalid-email",INVALID_EMULATOR_SCHEME:"auth/invalid-emulator-scheme",INVALID_IDP_RESPONSE:"auth/invalid-credential",INVALID_LOGIN_CREDENTIALS:"auth/invalid-credential",INVALID_MESSAGE_PAYLOAD:"auth/invalid-message-payload",INVALID_MFA_SESSION:"auth/invalid-multi-factor-session",INVALID_OAUTH_CLIENT_ID:"auth/invalid-oauth-client-id",INVALID_OAUTH_PROVIDER:"auth/invalid-oauth-provider",INVALID_OOB_CODE:"auth/invalid-action-code",INVALID_ORIGIN:"auth/unauthorized-domain",INVALID_PASSWORD:"auth/wrong-password",INVALID_PERSISTENCE:"auth/invalid-persistence-type",INVALID_PHONE_NUMBER:"auth/invalid-phone-number",INVALID_PROVIDER_ID:"auth/invalid-provider-id",INVALID_RECIPIENT_EMAIL:"auth/invalid-recipient-email",INVALID_SENDER:"auth/invalid-sender",INVALID_SESSION_INFO:"auth/invalid-verification-id",INVALID_TENANT_ID:"auth/invalid-tenant-id",MFA_INFO_NOT_FOUND:"auth/multi-factor-info-not-found",MFA_REQUIRED:"auth/multi-factor-auth-required",MISSING_ANDROID_PACKAGE_NAME:"auth/missing-android-pkg-name",MISSING_APP_CREDENTIAL:"auth/missing-app-credential",MISSING_AUTH_DOMAIN:"auth/auth-domain-config-required",MISSING_CODE:"auth/missing-verification-code",MISSING_CONTINUE_URI:"auth/missing-continue-uri",MISSING_IFRAME_START:"auth/missing-iframe-start",MISSING_IOS_BUNDLE_ID:"auth/missing-ios-bundle-id",MISSING_OR_INVALID_NONCE:"auth/missing-or-invalid-nonce",MISSING_MFA_INFO:"auth/missing-multi-factor-info",MISSING_MFA_SESSION:"auth/missing-multi-factor-session",MISSING_PHONE_NUMBER:"auth/missing-phone-number",MISSING_SESSION_INFO:"auth/missing-verification-id",MODULE_DESTROYED:"auth/app-deleted",NEED_CONFIRMATION:"auth/account-exists-with-different-credential",NETWORK_REQUEST_FAILED:"auth/network-request-failed",NULL_USER:"auth/null-user",NO_AUTH_EVENT:"auth/no-auth-event",NO_SUCH_PROVIDER:"auth/no-such-provider",OPERATION_NOT_ALLOWED:"auth/operation-not-allowed",OPERATION_NOT_SUPPORTED:"auth/operation-not-supported-in-this-environment",POPUP_BLOCKED:"auth/popup-blocked",POPUP_CLOSED_BY_USER:"auth/popup-closed-by-user",PROVIDER_ALREADY_LINKED:"auth/provider-already-linked",QUOTA_EXCEEDED:"auth/quota-exceeded",REDIRECT_CANCELLED_BY_USER:"auth/redirect-cancelled-by-user",REDIRECT_OPERATION_PENDING:"auth/redirect-operation-pending",REJECTED_CREDENTIAL:"auth/rejected-credential",SECOND_FACTOR_ALREADY_ENROLLED:"auth/second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"auth/maximum-second-factor-count-exceeded",TENANT_ID_MISMATCH:"auth/tenant-id-mismatch",TIMEOUT:"auth/timeout",TOKEN_EXPIRED:"auth/user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"auth/too-many-requests",UNAUTHORIZED_DOMAIN:"auth/unauthorized-continue-uri",UNSUPPORTED_FIRST_FACTOR:"auth/unsupported-first-factor",UNSUPPORTED_PERSISTENCE:"auth/unsupported-persistence-type",UNSUPPORTED_TENANT_OPERATION:"auth/unsupported-tenant-operation",UNVERIFIED_EMAIL:"auth/unverified-email",USER_CANCELLED:"auth/user-cancelled",USER_DELETED:"auth/user-not-found",USER_DISABLED:"auth/user-disabled",USER_MISMATCH:"auth/user-mismatch",USER_SIGNED_OUT:"auth/user-signed-out",WEAK_PASSWORD:"auth/weak-password",WEB_STORAGE_UNSUPPORTED:"auth/web-storage-unsupported",ALREADY_INITIALIZED:"auth/already-initialized",RECAPTCHA_NOT_ENABLED:"auth/recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"auth/missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"auth/invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"auth/invalid-recaptcha-action",MISSING_CLIENT_TYPE:"auth/missing-client-type",MISSING_RECAPTCHA_VERSION:"auth/missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"auth/invalid-recaptcha-version",INVALID_REQ_TYPE:"auth/invalid-req-type"},g=new n.Logger("@firebase/auth");function v(e,...i){g.logLevel<=n.LogLevel.WARN&&g.warn(`Auth (${t.SDK_VERSION}): ${e}`,...i)}function I(e,...i){g.logLevel<=n.LogLevel.ERROR&&g.error(`Auth (${t.SDK_VERSION}): ${e}`,...i)}function _(e,...t){throw E(e,...t)}function T(e,...t){return E(e,...t)}function y(t,n,i){const r=Object.assign(Object.assign({},p()),{[n]:i});return new e.ErrorFactory("auth","Firebase",r).create(n,{appName:t.name})}function w(e,t,n){if(!(t instanceof n))throw n.name!==t.constructor.name&&_(e,"argument-error"),y(e,"argument-error",`Type of ${t.constructor.name} does not match expected instance.`+"Did you pass a reference from a different Auth SDK?")}function E(e,...t){if("string"!=typeof e){const n=t[0],i=[...t.slice(1)];return i[0]&&(i[0].appName=e.name),e._errorFactory.create(n,...i)}return m.create(e,...t)}function k(e,t,...n){if(!e)throw E(t,...n)}function A(e){const t="INTERNAL ASSERTION FAILED: "+e;throw I(t),new Error(t)}function S(e,t){e||A(t)}function R(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function N(){return"http:"===O()||"https:"===O()}function O(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}function P(){return!("undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(N()||(0,e.isBrowserExtension)()||"connection"in navigator))||navigator.onLine}function b(){if("undefined"==typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}class C{constructor(t,n){this.shortDelay=t,this.longDelay=n,S(n>t,"Short delay should be less than long delay!"),this.isMobile=(0,e.isMobileCordova)()||(0,e.isReactNative)()}get(){return P()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function D(e,t){S(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}class L{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:"undefined"!=typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!=typeof fetch?fetch:void A("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:"undefined"!=typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!=typeof Headers?Headers:void A("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:"undefined"!=typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!=typeof Response?Response:void A("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}exports.aP=L;const M={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},x=new C(3e4,6e4);function U(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function V(t,n,i,r,s={}){return F(t,s,async()=>{let s={},o={};r&&("GET"===n?o=r:s={body:JSON.stringify(r)});const a=(0,e.querystring)(Object.assign({key:t.config.apiKey},o)).slice(1),c=await t._getAdditionalHeaders();return c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode),L.fetch()(q(t,t.config.apiHost,i,a),Object.assign({method:n,headers:c,referrerPolicy:"no-referrer"},s))})}async function F(t,n,i){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},M),n);try{const n=new z(t),o=await Promise.race([i(),n.promise]);n.clearNetworkTimeout();const a=await o.json();if("needConfirmation"in a)throw G(t,"account-exists-with-different-credential",a);if(o.ok&&!("errorMessage"in a))return a;{const e=o.ok?a.errorMessage:a.error.message,[n,i]=e.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw G(t,"credential-already-in-use",a);if("EMAIL_EXISTS"===n)throw G(t,"email-already-in-use",a);if("USER_DISABLED"===n)throw G(t,"user-disabled",a);const s=r[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(i)throw y(t,s,i);_(t,s)}}catch(s){if(s instanceof e.FirebaseError)throw s;_(t,"network-request-failed",{message:String(s)})}}async function H(e,t,n,i,r={}){const s=await V(e,t,n,i,r);return"mfaPendingCredential"in s&&_(e,"multi-factor-auth-required",{_serverResponse:s}),s}function q(e,t,n,i){const r=`${t}${n}?${i}`;return e.config.emulator?D(e.config,r):`${e.config.apiScheme}://${r}`}function j(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class z{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((e,t)=>{this.timer=setTimeout(()=>t(T(this.auth,"network-request-failed")),x.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function G(e,t,n){const i={appName:e.name};n.email&&(i.email=n.email),n.phoneNumber&&(i.phoneNumber=n.phoneNumber);const r=T(e,t,i);return r.customData._tokenResponse=n,r}function W(e){return void 0!==e&&void 0!==e.getResponse}function K(e){return void 0!==e&&void 0!==e.enterprise}class ${constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return j(t.enforcementState);return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}}async function B(e){return(await V(e,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}async function J(e,t){return V(e,"GET","/v2/recaptchaConfig",U(e,t))}async function Y(e,t){return V(e,"POST","/v1/accounts:delete",t)}async function X(e,t){return V(e,"POST","/v1/accounts:update",t)}async function Q(e,t){return V(e,"POST","/v1/accounts:lookup",t)}function Z(e){if(e)try{const n=new Date(Number(e));if(!isNaN(n.getTime()))return n.toUTCString()}catch(t){}}function ee(t,n=!1){return(0,e.getModularInstance)(t).getIdToken(n)}async function te(t,n=!1){const i=(0,e.getModularInstance)(t),r=await i.getIdToken(n),s=ie(r);k(s&&s.exp&&s.auth_time&&s.iat,i.auth,"internal-error");const o="object"==typeof s.firebase?s.firebase:void 0,a=null==o?void 0:o.sign_in_provider;return{claims:s,token:r,authTime:Z(ne(s.auth_time)),issuedAtTime:Z(ne(s.iat)),expirationTime:Z(ne(s.exp)),signInProvider:a||null,signInSecondFactor:(null==o?void 0:o.sign_in_second_factor)||null}}function ne(e){return 1e3*Number(e)}function ie(t){const[n,i,r]=t.split(".");if(void 0===n||void 0===i||void 0===r)return I("JWT malformed, contained fewer than 3 sections"),null;try{const t=(0,e.base64Decode)(i);return t?JSON.parse(t):(I("Failed to decode base64 JWT payload"),null)}catch(s){return I("Caught error parsing JWT payload as JSON",null==s?void 0:s.toString()),null}}function re(e){const t=ie(e);return k(t,"internal-error"),k(void 0!==t.exp,"internal-error"),k(void 0!==t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}async function se(t,n,i=!1){if(i)return n;try{return await n}catch(r){throw r instanceof e.FirebaseError&&oe(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function oe({code:e}){return"auth/user-disabled"===e||"auth/user-token-expired"===e}class ae{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void("auth/network-request-failed"===(null==e?void 0:e.code)&&this.schedule(!0))}this.schedule()}}class ce{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Z(this.lastLoginAt),this.creationTime=Z(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function ue(e){var t;const n=e.auth,i=await e.getIdToken(),r=await se(e,Q(n,{idToken:i}));k(null==r?void 0:r.users.length,n,"internal-error");const s=r.users[0];e._notifyReloadListener(s);const o=(null===(t=s.providerUserInfo)||void 0===t?void 0:t.length)?he(s.providerUserInfo):[],a=le(e.providerData,o),c=e.isAnonymous,u=!(e.email&&s.passwordHash||(null==a?void 0:a.length)),d=!!c&&u,l={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new ce(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(e,l)}async function de(t){const n=(0,e.getModularInstance)(t);await ue(n),await n.auth._persistUserIfCurrent(n),n.auth._notifyListenersIfCurrent(n)}function le(e,t){return[...e.filter(e=>!t.some(t=>t.providerId===e.providerId)),...t]}function he(e){return e.map(e=>{var{providerId:t}=e,n=(0,i.__rest)(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}async function pe(t,n){const i=await F(t,{},async()=>{const i=(0,e.querystring)({grant_type:"refresh_token",refresh_token:n}).slice(1),{tokenApiHost:r,apiKey:s}=t.config,o=q(t,r,"/v1/token",`key=${s}`),a=await t._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",L.fetch()(o,{method:"POST",headers:a,body:i})});return{accessToken:i.access_token,expiresIn:i.expires_in,refreshToken:i.refresh_token}}async function me(e,t){return V(e,"POST","/v2/accounts:revokeToken",U(e,t))}class fe{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){k(e.idToken,"internal-error"),k(void 0!==e.idToken,"internal-error"),k(void 0!==e.refreshToken,"internal-error");const t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):re(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}async getToken(e,t=!1){return k(!this.accessToken||this.refreshToken,e,"user-token-expired"),t||!this.accessToken||this.isExpired?this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:i,expiresIn:r}=await pe(e,t);this.updateTokensAndExpiration(n,i,Number(r))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:i,expirationTime:r}=t,s=new fe;return n&&(k("string"==typeof n,"internal-error",{appName:e}),s.refreshToken=n),i&&(k("string"==typeof i,"internal-error",{appName:e}),s.accessToken=i),r&&(k("number"==typeof r,"internal-error",{appName:e}),s.expirationTime=r),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new fe,this.toJSON())}_performRefresh(){return A("not implemented")}}function ge(e,t){k("string"==typeof e||void 0===e,"internal-error",{appName:t})}class ve{constructor(e){var{uid:t,auth:n,stsTokenManager:r}=e,s=(0,i.__rest)(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new ae(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new ce(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await se(this,this.stsTokenManager.getToken(this.auth,e));return k(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return te(this,e)}reload(){return de(this)}_assign(e){this!==e&&(k(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(e=>Object.assign({},e)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new ve(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){k(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await ue(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await se(this,Y(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,i,r,s,o,a,c,u;const d=null!==(n=t.displayName)&&void 0!==n?n:void 0,l=null!==(i=t.email)&&void 0!==i?i:void 0,h=null!==(r=t.phoneNumber)&&void 0!==r?r:void 0,p=null!==(s=t.photoURL)&&void 0!==s?s:void 0,m=null!==(o=t.tenantId)&&void 0!==o?o:void 0,f=null!==(a=t._redirectEventId)&&void 0!==a?a:void 0,g=null!==(c=t.createdAt)&&void 0!==c?c:void 0,v=null!==(u=t.lastLoginAt)&&void 0!==u?u:void 0,{uid:I,emailVerified:_,isAnonymous:T,providerData:y,stsTokenManager:w}=t;k(I&&w,e,"internal-error");const E=fe.fromJSON(this.name,w);k("string"==typeof I,e,"internal-error"),ge(d,e.name),ge(l,e.name),k("boolean"==typeof _,e,"internal-error"),k("boolean"==typeof T,e,"internal-error"),ge(h,e.name),ge(p,e.name),ge(m,e.name),ge(f,e.name),ge(g,e.name),ge(v,e.name);const A=new ve({uid:I,auth:e,email:l,emailVerified:_,displayName:d,isAnonymous:T,photoURL:p,phoneNumber:h,tenantId:m,stsTokenManager:E,createdAt:g,lastLoginAt:v});return y&&Array.isArray(y)&&(A.providerData=y.map(e=>Object.assign({},e))),f&&(A._redirectEventId=f),A}static async _fromIdTokenResponse(e,t,n=!1){const i=new fe;i.updateFromServerResponse(t);const r=new ve({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await ue(r),r}}exports.aK=ve;const Ie=new Map;function _e(e){S(e instanceof Function,"Expected a class definition");let t=Ie.get(e);return t?(S(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,Ie.set(e,t),t)}class Te{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Te.type="NONE";const ye=exports.U=Te;function we(e,t,n){return`firebase:${e}:${t}:${n}`}class Ee{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:i,name:r}=this.auth;this.fullUserKey=we(this.userKey,i.apiKey,r),this.fullPersistenceKey=we("persistence",i.apiKey,r),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?ve._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new Ee(_e(ye),e,n);const i=(await Promise.all(t.map(async e=>{if(await e._isAvailable())return e}))).filter(e=>e);let r=i[0]||_e(ye);const s=we(n,e.config.apiKey,e.name);let o=null;for(const u of t)try{const t=await u._get(s);if(t){const n=ve._fromJSON(e,t);u!==r&&(o=n),r=u;break}}catch(c){}const a=i.filter(e=>e._shouldAllowMigration);return r._shouldAllowMigration&&a.length?(r=a[0],o&&await r._set(s,o.toJSON()),await Promise.all(t.map(async e=>{if(e!==r)try{await e._remove(s)}catch(c){}})),new Ee(r,e,n)):new Ee(r,e,n)}}function ke(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(Ne(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(Ae(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(Pe(t))return"Blackberry";if(be(t))return"Webos";if(Se(t))return"Safari";if((t.includes("chrome/")||Re(t))&&!t.includes("edge/"))return"Chrome";if(Oe(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null==n?void 0:n.length))return n[1]}return"Other"}function Ae(t=(0,e.getUA)()){return/firefox\//i.test(t)}function Se(t=(0,e.getUA)()){const n=t.toLowerCase();return n.includes("safari/")&&!n.includes("chrome/")&&!n.includes("crios/")&&!n.includes("android")}function Re(t=(0,e.getUA)()){return/crios\//i.test(t)}function Ne(t=(0,e.getUA)()){return/iemobile/i.test(t)}function Oe(t=(0,e.getUA)()){return/android/i.test(t)}function Pe(t=(0,e.getUA)()){return/blackberry/i.test(t)}function be(t=(0,e.getUA)()){return/webos/i.test(t)}function Ce(t=(0,e.getUA)()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function De(t=(0,e.getUA)()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(t)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(t)}function Le(t=(0,e.getUA)()){var n;return Ce(t)&&!!(null===(n=window.navigator)||void 0===n?void 0:n.standalone)}function Me(){return(0,e.isIE)()&&10===document.documentMode}function xe(t=(0,e.getUA)()){return Ce(t)||Oe(t)||be(t)||Pe(t)||/windows phone/i.test(t)||Ne(t)}function Ue(){try{return!(!window||window===window.top)}catch(e){return!1}}function Ve(n,i=[]){let r;switch(n){case"Browser":r=ke((0,e.getUA)());break;case"Worker":r=`${ke((0,e.getUA)())}-${n}`;break;default:r=n}const s=i.length?i.join(","):"FirebaseCore-web";return`${r}/JsCore/${t.SDK_VERSION}/${s}`}class Fe{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise((n,i)=>{try{n(e(t))}catch(r){i(r)}});n.onAbort=t,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=(()=>Promise.resolve())}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(n){t.reverse();for(const e of t)try{e()}catch(i){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null==n?void 0:n.message})}}}async function He(e,t={}){return V(e,"GET","/v2/passwordPolicy",U(e,t))}const qe=6;class je{constructor(e){var t,n,i,r;const s=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(t=s.minPasswordLength)&&void 0!==t?t:qe,s.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=s.maxPasswordLength),void 0!==s.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=s.containsLowercaseCharacter),void 0!==s.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=s.containsUppercaseCharacter),void 0!==s.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=s.containsNumericCharacter),void 0!==s.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=s.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(i=null===(n=e.allowedNonAlphanumericCharacters)||void 0===n?void 0:n.join(""))&&void 0!==i?i:"",this.forceUpgradeOnSignin=null!==(r=e.forceUpgradeOnSignin)&&void 0!==r&&r,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,n,i,r,s,o;const a={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,a),this.validatePasswordCharacterOptions(e,a),a.isValid&&(a.isValid=null===(t=a.meetsMinPasswordLength)||void 0===t||t),a.isValid&&(a.isValid=null===(n=a.meetsMaxPasswordLength)||void 0===n||n),a.isValid&&(a.isValid=null===(i=a.containsLowercaseLetter)||void 0===i||i),a.isValid&&(a.isValid=null===(r=a.containsUppercaseLetter)||void 0===r||r),a.isValid&&(a.isValid=null===(s=a.containsNumericCharacter)||void 0===s||s),a.isValid&&(a.isValid=null===(o=a.containsNonAlphanumericCharacter)||void 0===o||o),a}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){let n;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,i,r){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=r))}}class ze{constructor(e,t,n,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new We(this),this.idTokenSubscription=new We(this),this.beforeStateQueue=new Fe(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=m,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=_e(t)),this._initializationPromise=this.queue(async()=>{var n,i;if(!this._deleted&&(this.persistenceManager=await Ee.create(this,e),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(r){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(i=this.currentUser)||void 0===i?void 0:i.uid)||null,this._deleted||(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void(await this.currentUser.getIdToken())):void(await this._updateCurrentUser(e,!0)):void 0}async initializeCurrentUser(e){var t;const n=await this.assertedPersistence.getCurrentUser();let i=n,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,s=null==i?void 0:i._redirectEventId,o=await this.tryRedirectSignIn(e);n&&n!==s||null==o||!o.user||(i=o.user,r=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(i)}catch(s){i=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return k(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(n){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await ue(e)}catch(t){if("auth/network-request-failed"!==(null==t?void 0:t.code))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=b()}async _delete(){this._deleted=!0}async updateCurrentUser(t){const n=t?(0,e.getModularInstance)(t):null;return n&&k(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&k(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(e){return this.queue(async()=>{await this.assertedPersistence.setPersistence(_e(e))})}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await He(this),t=new je(e);null===this.tenantId?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(t){this._errorFactory=new e.ErrorFactory("auth","Firebase",t())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(t.tenantId=this.tenantId),await me(this,t)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&_e(e)||this._popupRedirectResolver;k(t,this,"argument-error"),this.redirectPersistenceManager=await Ee.create(this,[_e(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue(async()=>{}),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,i){if(this._deleted)return()=>{};const r="function"==typeof t?t:t.next.bind(t);let s=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(k(o,this,"internal-error"),o.then(()=>{s||r(this.currentUser)}),"function"==typeof t){const r=e.addObserver(t,n,i);return()=>{s=!0,r()}}{const n=e.addObserver(t);return()=>{s=!0,n()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return k(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Ve(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t}async _getAppCheckToken(){var e;const t=await(null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return(null==t?void 0:t.error)&&v(`Error while retrieving App Check token: ${t.error}`),null==t?void 0:t.token}}function Ge(t){return(0,e.getModularInstance)(t)}exports.aL=ze;class We{constructor(t){this.auth=t,this.observer=null,this.addObserver=(0,e.createSubscribe)(e=>this.observer=e)}get next(){return k(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Ke={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function $e(e){Ke=e}function Be(e){return Ke.loadJS(e)}function Je(){return Ke.recaptchaV2Script}function Ye(){return Ke.recaptchaEnterpriseScript}function Xe(){return Ke.gapiScript}function Qe(e){return`__${e}${Math.floor(1e6*Math.random())}`}const Ze="recaptcha-enterprise",et="NO_RECAPTCHA";class tt{constructor(e){this.type=Ze,this.auth=Ge(e)}async verify(e="verify",t=!1){function n(t,n,i){const r=window.grecaptcha;K(r)?r.enterprise.ready(()=>{r.enterprise.execute(t,{action:e}).then(e=>{n(e)}).catch(()=>{n(et)})}):i(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((e,i)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise(async(t,n)=>{J(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(i=>{if(void 0!==i.recaptchaKey){const n=new $(i);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))}).catch(e=>{n(e)})})})(this.auth).then(r=>{if(!t&&K(window.grecaptcha))n(r,e,i);else{if("undefined"==typeof window)return void i(new Error("RecaptchaVerifier is only supported in browser"));let t=Ye();0!==t.length&&(t+=r),Be(t).then(()=>{n(r,e,i)}).catch(e=>{i(e)})}}).catch(e=>{i(e)})})}}async function nt(e,t,n,i=!1){const r=new tt(e);let s;try{s=await r.verify(n)}catch(a){s=await r.verify(n,!0)}const o=Object.assign({},t);return i?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function it(e,t,n,i){var r;if(null===(r=e._getRecaptchaConfig())||void 0===r?void 0:r.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const r=await nt(e,t,n,"getOobCode"===n);return i(e,r)}return i(e,t).catch(async r=>{if("auth/missing-recaptcha-token"===r.code){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const r=await nt(e,t,n,"getOobCode"===n);return i(e,r)}return Promise.reject(r)})}async function rt(e){const t=Ge(e),n=await J(t,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),i=new $(n);if(null==t.tenantId?t._agentRecaptchaConfig=i:t._tenantRecaptchaConfigs[t.tenantId]=i,i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){new tt(t).verify()}}function st(n,i){const r=(0,t._getProvider)(n,"auth");if(r.isInitialized()){const t=r.getImmediate(),n=r.getOptions();if((0,e.deepEqual)(n,null!=i?i:{}))return t;_(t,"already-initialized")}return r.initialize({options:i})}function ot(e,t){const n=(null==t?void 0:t.persistence)||[],i=(Array.isArray(n)?n:[n]).map(_e);(null==t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(i,null==t?void 0:t.popupRedirectResolver)}function at(e,t,n){const i=Ge(e);k(i._canInitEmulator,i,"emulator-config-failed"),k(/^https?:\/\//.test(t),i,"invalid-emulator-scheme");const r=!!(null==n?void 0:n.disableWarnings),s=ct(t),{host:o,port:a}=ut(t),c=null===a?"":`:${a}`;i.config.emulator={url:`${s}//${o}${c}/`},i.settings.appVerificationDisabledForTesting=!0,i.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:r})}),r||lt()}function ct(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function ut(e){const t=ct(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const i=n[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(i);if(r){const e=r[1];return{host:e,port:dt(i.substr(e.length+1))}}{const[e,t]=i.split(":");return{host:e,port:dt(t)}}}function dt(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}function lt(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}class ht{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return A("not implemented")}_getIdTokenResponse(e){return A("not implemented")}_linkToIdToken(e,t){return A("not implemented")}_getReauthenticationResolver(e){return A("not implemented")}}async function pt(e,t){return V(e,"POST","/v1/accounts:resetPassword",U(e,t))}async function mt(e,t){return V(e,"POST","/v1/accounts:update",t)}async function ft(e,t){return V(e,"POST","/v1/accounts:signUp",t)}async function gt(e,t){return V(e,"POST","/v1/accounts:update",U(e,t))}async function vt(e,t){return H(e,"POST","/v1/accounts:signInWithPassword",U(e,t))}async function It(e,t){return V(e,"POST","/v1/accounts:sendOobCode",U(e,t))}async function _t(e,t){return It(e,t)}async function Tt(e,t){return It(e,t)}async function yt(e,t){return It(e,t)}async function wt(e,t){return It(e,t)}async function Et(e,t){return H(e,"POST","/v1/accounts:signInWithEmailLink",U(e,t))}async function kt(e,t){return H(e,"POST","/v1/accounts:signInWithEmailLink",U(e,t))}exports.L=ht;class At extends ht{constructor(e,t,n,i=null){super("password",n),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new At(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new At(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e;if((null==t?void 0:t.email)&&(null==t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return it(e,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",vt);case"emailLink":return Et(e,{email:this._email,oobCode:this._password});default:_(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return it(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",ft);case"emailLink":return kt(e,{idToken:t,email:this._email,oobCode:this._password});default:_(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function St(e,t){return H(e,"POST","/v1/accounts:signInWithIdp",U(e,t))}exports.M=At;const Rt="http://localhost";class Nt extends ht{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Nt(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):_("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r}=t,s=(0,i.__rest)(t,["providerId","signInMethod"]);if(!n||!r)return null;const o=new Nt(n,r);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){return St(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,St(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,St(e,t)}buildRequest(){const t={requestUri:Rt,returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),t.postBody=(0,e.querystring)(n)}return t}}async function Ot(e,t){return V(e,"POST","/v1/accounts:sendVerificationCode",U(e,t))}async function Pt(e,t){return H(e,"POST","/v1/accounts:signInWithPhoneNumber",U(e,t))}async function bt(e,t){const n=await H(e,"POST","/v1/accounts:signInWithPhoneNumber",U(e,t));if(n.temporaryProof)throw G(e,"account-exists-with-different-credential",n);return n}exports.N=Nt;const Ct={USER_NOT_FOUND:"user-not-found"};async function Dt(e,t){return H(e,"POST","/v1/accounts:signInWithPhoneNumber",U(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),Ct)}class Lt extends ht{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new Lt({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new Lt({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return Pt(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return bt(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return Dt(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:i}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:i}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"==typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:i,temporaryProof:r}=e;return n||t||i||r?new Lt({verificationId:t,verificationCode:n,phoneNumber:i,temporaryProof:r}):null}}function Mt(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function xt(t){const n=(0,e.querystringDecode)((0,e.extractQuerystring)(t)).link,i=n?(0,e.querystringDecode)((0,e.extractQuerystring)(n)).deep_link_id:null,r=(0,e.querystringDecode)((0,e.extractQuerystring)(t)).deep_link_id;return(r?(0,e.querystringDecode)((0,e.extractQuerystring)(r)).link:null)||r||i||n||t}exports.Q=Lt;class Ut{constructor(t){var n,i,r,s,o,a;const c=(0,e.querystringDecode)((0,e.extractQuerystring)(t)),u=null!==(n=c.apiKey)&&void 0!==n?n:null,d=null!==(i=c.oobCode)&&void 0!==i?i:null,l=Mt(null!==(r=c.mode)&&void 0!==r?r:null);k(u&&d&&l,"argument-error"),this.apiKey=u,this.operation=l,this.code=d,this.continueUrl=null!==(s=c.continueUrl)&&void 0!==s?s:null,this.languageCode=null!==(o=c.languageCode)&&void 0!==o?o:null,this.tenantId=null!==(a=c.tenantId)&&void 0!==a?a:null}static parseLink(e){const t=xt(e);try{return new Ut(t)}catch(n){return null}}}function Vt(e){return Ut.parseLink(e)}exports.ai=Ut;class Ft{constructor(){this.providerId=Ft.PROVIDER_ID}static credential(e,t){return At._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=Ut.parseLink(t);return k(n,"argument-error"),At._fromEmailAndCode(e,n.code,n.tenantId)}}exports.V=Ft,Ft.PROVIDER_ID="password",Ft.EMAIL_PASSWORD_SIGN_IN_METHOD="password",Ft.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Ht{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class qt extends Ht{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class jt extends qt{static credentialFromJSON(e){const t="string"==typeof e?JSON.parse(e):e;return k("providerId"in t&&"signInMethod"in t,"argument-error"),Nt._fromParams(t)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return k(e.idToken||e.accessToken,"argument-error"),Nt._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return jt.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return jt.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n,oauthTokenSecret:i,pendingToken:r,nonce:s,providerId:o}=e;if(!(n||i||t||r))return null;if(!o)return null;try{return new jt(o)._credential({idToken:t,accessToken:n,nonce:s,pendingToken:r})}catch(a){return null}}}exports.Z=jt;class zt extends qt{constructor(){super("facebook.com")}static credential(e){return Nt._fromParams({providerId:zt.PROVIDER_ID,signInMethod:zt.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return zt.credentialFromTaggedObject(e)}static credentialFromError(e){return zt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!(e&&"oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return zt.credential(e.oauthAccessToken)}catch(t){return null}}}exports.W=zt,zt.FACEBOOK_SIGN_IN_METHOD="facebook.com",zt.PROVIDER_ID="facebook.com";class Gt extends qt{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Nt._fromParams({providerId:Gt.PROVIDER_ID,signInMethod:Gt.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Gt.credentialFromTaggedObject(e)}static credentialFromError(e){return Gt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return Gt.credential(t,n)}catch(i){return null}}}exports.X=Gt,Gt.GOOGLE_SIGN_IN_METHOD="google.com",Gt.PROVIDER_ID="google.com";class Wt extends qt{constructor(){super("github.com")}static credential(e){return Nt._fromParams({providerId:Wt.PROVIDER_ID,signInMethod:Wt.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Wt.credentialFromTaggedObject(e)}static credentialFromError(e){return Wt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!(e&&"oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return Wt.credential(e.oauthAccessToken)}catch(t){return null}}}exports.Y=Wt,Wt.GITHUB_SIGN_IN_METHOD="github.com",Wt.PROVIDER_ID="github.com";const Kt="http://localhost";class $t extends ht{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){return St(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,St(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,St(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:i,pendingToken:r}=t;return n&&i&&r&&n===i?new $t(n,r):null}static _create(e,t){return new $t(e,t)}buildRequest(){return{requestUri:Kt,returnSecureToken:!0,pendingToken:this.pendingToken}}}exports.aQ=$t;const Bt="saml.";class Jt extends Ht{constructor(e){k(e.startsWith(Bt),"argument-error"),super(e)}static credentialFromResult(e){return Jt.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return Jt.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const t=$t.fromJSON(e);return k(t,"argument-error"),t}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:t,providerId:n}=e;if(!t||!n)return null;try{return $t._create(n,t)}catch(i){return null}}}exports._=Jt;class Yt extends qt{constructor(){super("twitter.com")}static credential(e,t){return Nt._fromParams({providerId:Yt.PROVIDER_ID,signInMethod:Yt.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Yt.credentialFromTaggedObject(e)}static credentialFromError(e){return Yt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return Yt.credential(t,n)}catch(i){return null}}}async function Xt(e,t){return H(e,"POST","/v1/accounts:signUp",U(e,t))}exports.$=Yt,Yt.TWITTER_SIGN_IN_METHOD="twitter.com",Yt.PROVIDER_ID="twitter.com";class Qt{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,i=!1){const r=await ve._fromIdTokenResponse(e,n,i),s=Zt(n);return new Qt({user:r,providerId:s,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const i=Zt(n);return new Qt({user:e,providerId:i,_tokenResponse:n,operationType:t})}}function Zt(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}async function en(e){var t;const n=Ge(e);if(await n._initializationPromise,null===(t=n.currentUser)||void 0===t?void 0:t.isAnonymous)return new Qt({user:n.currentUser,providerId:null,operationType:"signIn"});const i=await Xt(n,{returnSecureToken:!0}),r=await Qt._fromIdTokenResponse(n,"signIn",i,!0);return await n._updateCurrentUser(r.user),r}class tn extends e.FirebaseError{constructor(e,t,n,i){var r;super(t.code,t.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,tn.prototype),this.customData={appName:e.name,tenantId:null!==(r=e.tenantId)&&void 0!==r?r:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,i){return new tn(e,t,n,i)}}function nn(e,t,n,i){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch(n=>{if("auth/multi-factor-auth-required"===n.code)throw tn._fromErrorAndOperation(e,n,t,i);throw n})}function rn(e){return new Set(e.map(({providerId:e})=>e).filter(e=>!!e))}async function sn(t,n){const i=(0,e.getModularInstance)(t);await an(!0,i,n);const{providerUserInfo:r}=await X(i.auth,{idToken:await i.getIdToken(),deleteProvider:[n]}),s=rn(r||[]);return i.providerData=i.providerData.filter(e=>s.has(e.providerId)),s.has("phone")||(i.phoneNumber=null),await i.auth._persistUserIfCurrent(i),i}async function on(e,t,n=!1){const i=await se(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return Qt._forOperation(e,"link",i)}async function an(e,t,n){await ue(t);const i=!1===e?"provider-already-linked":"no-such-provider";k(rn(t.providerData).has(n)===e,t.auth,i)}async function cn(e,t,n=!1){const{auth:i}=e;try{const s=await se(e,nn(i,"reauthenticate",t,e),n);k(s.idToken,i,"internal-error");const o=ie(s.idToken);k(o,i,"internal-error");const{sub:a}=o;return k(e.uid===a,i,"user-mismatch"),Qt._forOperation(e,"reauthenticate",s)}catch(r){throw"auth/user-not-found"===(null==r?void 0:r.code)&&_(i,"user-mismatch"),r}}async function un(e,t,n=!1){const i=await nn(e,"signIn",t),r=await Qt._fromIdTokenResponse(e,"signIn",i);return n||await e._updateCurrentUser(r.user),r}async function dn(e,t){return un(Ge(e),t)}async function ln(t,n){const i=(0,e.getModularInstance)(t);return await an(!1,i,n.providerId),on(i,n)}async function hn(t,n){return cn((0,e.getModularInstance)(t),n)}async function pn(e,t){return H(e,"POST","/v1/accounts:signInWithCustomToken",U(e,t))}async function mn(e,t){const n=Ge(e),i=await pn(n,{token:t,returnSecureToken:!0}),r=await Qt._fromIdTokenResponse(n,"signIn",i);return await n._updateCurrentUser(r.user),r}class fn{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?gn._fromServerResponse(e,t):"totpInfo"in t?vn._fromServerResponse(e,t):_(e,"internal-error")}}class gn extends fn{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new gn(t)}}class vn extends fn{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new vn(t)}}function In(e,t,n){var i;k((null===(i=n.url)||void 0===i?void 0:i.length)>0,e,"invalid-continue-uri"),k(void 0===n.dynamicLinkDomain||n.dynamicLinkDomain.length>0,e,"invalid-dynamic-link-domain"),t.continueUrl=n.url,t.dynamicLinkDomain=n.dynamicLinkDomain,t.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(k(n.iOS.bundleId.length>0,e,"missing-ios-bundle-id"),t.iOSBundleId=n.iOS.bundleId),n.android&&(k(n.android.packageName.length>0,e,"missing-android-pkg-name"),t.androidInstallApp=n.android.installApp,t.androidMinimumVersionCode=n.android.minimumVersion,t.androidPackageName=n.android.packageName)}async function _n(e){const t=Ge(e);t._getPasswordPolicyInternal()&&await t._updatePasswordPolicy()}async function Tn(e,t,n){const i=Ge(e),r={requestType:"PASSWORD_RESET",email:t,clientType:"CLIENT_TYPE_WEB"};n&&In(i,r,n),await it(i,r,"getOobCode",Tt)}async function yn(t,n,i){await pt((0,e.getModularInstance)(t),{oobCode:n,newPassword:i}).catch(async e=>{throw"auth/password-does-not-meet-requirements"===e.code&&_n(t),e})}async function wn(t,n){await gt((0,e.getModularInstance)(t),{oobCode:n})}async function En(t,n){const i=(0,e.getModularInstance)(t),r=await pt(i,{oobCode:n}),s=r.requestType;switch(k(s,i,"internal-error"),s){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":k(r.newEmail,i,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":k(r.mfaInfo,i,"internal-error");default:k(r.email,i,"internal-error")}let o=null;return r.mfaInfo&&(o=fn._fromServerResponse(Ge(i),r.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===r.requestType?r.newEmail:r.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===r.requestType?r.email:r.newEmail)||null,multiFactorInfo:o},operation:s}}async function kn(t,n){const{data:i}=await En((0,e.getModularInstance)(t),n);return i.email}async function An(e,t,n){const i=Ge(e),r=it(i,{returnSecureToken:!0,email:t,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Xt),s=await r.catch(t=>{throw"auth/password-does-not-meet-requirements"===t.code&&_n(e),t}),o=await Qt._fromIdTokenResponse(i,"signIn",s);return await i._updateCurrentUser(o.user),o}function Sn(t,n,i){return dn((0,e.getModularInstance)(t),Ft.credential(n,i)).catch(async e=>{throw"auth/password-does-not-meet-requirements"===e.code&&_n(t),e})}async function Rn(e,t,n){const i=Ge(e),r={requestType:"EMAIL_SIGNIN",email:t,clientType:"CLIENT_TYPE_WEB"};!function(e,t){k(t.handleCodeInApp,i,"argument-error"),t&&In(i,e,t)}(r,n),await it(i,r,"getOobCode",yt)}function Nn(e,t){const n=Ut.parseLink(t);return"EMAIL_SIGNIN"===(null==n?void 0:n.operation)}async function On(t,n,i){const r=(0,e.getModularInstance)(t),s=Ft.credentialWithLink(n,i||R());return k(s._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),dn(r,s)}async function Pn(e,t){return V(e,"POST","/v1/accounts:createAuthUri",U(e,t))}async function bn(t,n){const i={identifier:n,continueUri:N()?R():"http://localhost"},{signinMethods:r}=await Pn((0,e.getModularInstance)(t),i);return r||[]}async function Cn(t,n){const i=(0,e.getModularInstance)(t),r={requestType:"VERIFY_EMAIL",idToken:await t.getIdToken()};n&&In(i.auth,r,n);const{email:s}=await _t(i.auth,r);s!==t.email&&await t.reload()}async function Dn(t,n,i){const r=(0,e.getModularInstance)(t),s={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await t.getIdToken(),newEmail:n};i&&In(r.auth,s,i);const{email:o}=await wt(r.auth,s);o!==t.email&&await t.reload()}async function Ln(e,t){return V(e,"POST","/v1/accounts:update",t)}async function Mn(t,{displayName:n,photoURL:i}){if(void 0===n&&void 0===i)return;const r=(0,e.getModularInstance)(t),s={idToken:await r.getIdToken(),displayName:n,photoUrl:i,returnSecureToken:!0},o=await se(r,Ln(r.auth,s));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;const a=r.providerData.find(({providerId:e})=>"password"===e);a&&(a.displayName=r.displayName,a.photoURL=r.photoURL),await r._updateTokensIfNecessary(o)}function xn(t,n){return Vn((0,e.getModularInstance)(t),n,null)}function Un(t,n){return Vn((0,e.getModularInstance)(t),null,n)}async function Vn(e,t,n){const{auth:i}=e,r={idToken:await e.getIdToken(),returnSecureToken:!0};t&&(r.email=t),n&&(r.password=n);const s=await se(e,mt(i,r));await e._updateTokensIfNecessary(s,!0)}function Fn(e){var t,n;if(!e)return null;const{providerId:i}=e,r=e.rawUserInfo?JSON.parse(e.rawUserInfo):{},s=e.isNewUser||"identitytoolkit#SignupNewUserResponse"===e.kind;if(!i&&(null==e?void 0:e.idToken)){const i=null===(n=null===(t=ie(e.idToken))||void 0===t?void 0:t.firebase)||void 0===n?void 0:n.sign_in_provider;if(i){return new Hn(s,"anonymous"!==i&&"custom"!==i?i:null)}}if(!i)return null;switch(i){case"facebook.com":return new jn(s,r);case"github.com":return new zn(s,r);case"google.com":return new Gn(s,r);case"twitter.com":return new Wn(s,r,e.screenName||null);case"custom":case"anonymous":return new Hn(s,null);default:return new Hn(s,i,r)}}class Hn{constructor(e,t,n={}){this.isNewUser=e,this.providerId=t,this.profile=n}}class qn extends Hn{constructor(e,t,n,i){super(e,t,n),this.username=i}}class jn extends Hn{constructor(e,t){super(e,"facebook.com",t)}}class zn extends qn{constructor(e,t){super(e,"github.com",t,"string"==typeof(null==t?void 0:t.login)?null==t?void 0:t.login:null)}}class Gn extends Hn{constructor(e,t){super(e,"google.com",t)}}class Wn extends qn{constructor(e,t,n){super(e,"twitter.com",t,n)}}function Kn(e){const{user:t,_tokenResponse:n}=e;return t.isAnonymous&&!n?{providerId:null,isNewUser:!1,profile:null}:Fn(n)}function $n(t,n){return(0,e.getModularInstance)(t).setPersistence(n)}function Bn(e){return rt(e)}async function Jn(e,t){return Ge(e).validatePassword(t)}function Yn(t,n,i,r){return(0,e.getModularInstance)(t).onIdTokenChanged(n,i,r)}function Xn(t,n,i){return(0,e.getModularInstance)(t).beforeAuthStateChanged(n,i)}function Qn(t,n,i,r){return(0,e.getModularInstance)(t).onAuthStateChanged(n,i,r)}function Zn(t){(0,e.getModularInstance)(t).useDeviceLanguage()}function ei(t,n){return(0,e.getModularInstance)(t).updateCurrentUser(n)}function ti(t){return(0,e.getModularInstance)(t).signOut()}function ni(e,t){return Ge(e).revokeAccessToken(t)}async function ii(t){return(0,e.getModularInstance)(t).delete()}class ri{constructor(e,t,n){this.type=e,this.credential=t,this.user=n}static _fromIdtoken(e,t){return new ri("enroll",e,t)}static _fromMfaPendingCredential(e){return new ri("signin",e)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var t,n;if(null==e?void 0:e.multiFactorSession){if(null===(t=e.multiFactorSession)||void 0===t?void 0:t.pendingCredential)return ri._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(null===(n=e.multiFactorSession)||void 0===n?void 0:n.idToken)return ri._fromIdtoken(e.multiFactorSession.idToken)}return null}}class si{constructor(e,t,n){this.session=e,this.hints=t,this.signInResolver=n}static _fromError(e,t){const n=Ge(e),i=t.customData._serverResponse,r=(i.mfaInfo||[]).map(e=>fn._fromServerResponse(n,e));k(i.mfaPendingCredential,n,"internal-error");const s=ri._fromMfaPendingCredential(i.mfaPendingCredential);return new si(s,r,async e=>{const r=await e._process(n,s);delete i.mfaInfo,delete i.mfaPendingCredential;const o=Object.assign(Object.assign({},i),{idToken:r.idToken,refreshToken:r.refreshToken});switch(t.operationType){case"signIn":const e=await Qt._fromIdTokenResponse(n,t.operationType,o);return await n._updateCurrentUser(e.user),e;case"reauthenticate":return k(t.user,n,"internal-error"),Qt._forOperation(t.user,t.operationType,o);default:_(n,"internal-error")}})}async resolveSignIn(e){const t=e;return this.signInResolver(t)}}function oi(t,n){var i;const r=(0,e.getModularInstance)(t),s=n;return k(n.customData.operationType,r,"argument-error"),k(null===(i=s.customData._serverResponse)||void 0===i?void 0:i.mfaPendingCredential,r,"argument-error"),si._fromError(r,s)}function ai(e,t){return V(e,"POST","/v2/accounts/mfaEnrollment:start",U(e,t))}function ci(e,t){return V(e,"POST","/v2/accounts/mfaEnrollment:finalize",U(e,t))}function ui(e,t){return V(e,"POST","/v2/accounts/mfaEnrollment:start",U(e,t))}function di(e,t){return V(e,"POST","/v2/accounts/mfaEnrollment:finalize",U(e,t))}function li(e,t){return V(e,"POST","/v2/accounts/mfaEnrollment:withdraw",U(e,t))}class hi{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map(t=>fn._fromServerResponse(e.auth,t)))})}static _fromUser(e){return new hi(e)}async getSession(){return ri._fromIdtoken(await this.user.getIdToken(),this.user)}async enroll(e,t){const n=e,i=await this.getSession(),r=await se(this.user,n._process(this.user.auth,i,t));return await this.user._updateTokensIfNecessary(r),this.user.reload()}async unenroll(e){const t="string"==typeof e?e:e.uid,n=await this.user.getIdToken();try{const e=await se(this.user,li(this.user.auth,{idToken:n,mfaEnrollmentId:t}));this.enrolledFactors=this.enrolledFactors.filter(({uid:e})=>e!==t),await this.user._updateTokensIfNecessary(e),await this.user.reload()}catch(i){throw i}}}const pi=new WeakMap;function mi(t){const n=(0,e.getModularInstance)(t);return pi.has(n)||pi.set(n,hi._fromUser(n)),pi.get(n)}const fi="__sak";class gi{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(fi,"1"),this.storage.removeItem(fi),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}function vi(){const t=(0,e.getUA)();return Se(t)||Ce(t)}const Ii=1e3,_i=10;class Ti extends gi{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=((e,t)=>this.onStorageEvent(e,t)),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=vi()&&Ue(),this.fallbackToPolling=xe(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),i=this.localCache[t];n!==i&&e(t,i,n)}}onStorageEvent(e,t=!1){if(!e.key)return void this.forAllChangedKeys((e,t,n)=>{this.notifyListeners(e,n)});const n=e.key;if(t?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const i=this.storage.getItem(n);if(e.newValue!==i)null!==e.newValue?this.storage.setItem(n,e.newValue):this.storage.removeItem(n);else if(this.localCache[n]===e.newValue&&!t)return}const i=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},r=this.storage.getItem(n);Me()&&r!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,_i):i()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},Ii)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Ti.type="LOCAL";const yi=exports.b=Ti;class wi extends gi{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}wi.type="SESSION";const Ei=exports.a=wi;function ki(e){return Promise.all(e.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class Ai{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(t=>t.isListeningto(e));if(t)return t;const n=new Ai(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:i,data:r}=t.data,s=this.handlersMap[i];if(!(null==s?void 0:s.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const o=Array.from(s).map(async e=>e(t.origin,r)),a=await ki(o);t.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:a})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function Si(e="",t=10){let n="";for(let i=0;i<t;i++)n+=Math.floor(10*Math.random());return e+n}Ai.receivers=[];class Ri{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const i="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let r,s;return new Promise((o,a)=>{const c=Si("",20);i.port1.start();const u=setTimeout(()=>{a(new Error("unsupported_event"))},n);s={messageChannel:i,onMessage(e){const t=e;if(t.data.eventId===c)switch(t.data.status){case"ack":clearTimeout(u),r=setTimeout(()=>{a(new Error("timeout"))},3e3);break;case"done":clearTimeout(r),o(t.data.response);break;default:clearTimeout(u),clearTimeout(r),a(new Error("invalid_response"))}}},this.handlers.add(s),i.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[i.port2])}).finally(()=>{s&&this.removeMessageHandler(s)})}}function Ni(){return window}function Oi(e){Ni().location.href=e}function Pi(){return void 0!==Ni().WorkerGlobalScope&&"function"==typeof Ni().importScripts}async function bi(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}function Ci(){var e;return(null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}function Di(){return Pi()?self:null}const Li="firebaseLocalStorageDb",Mi=1,xi="firebaseLocalStorage",Ui="fbase_key";class Vi{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Fi(e,t){return e.transaction([xi],t?"readwrite":"readonly").objectStore(xi)}function Hi(){const e=indexedDB.deleteDatabase(Li);return new Vi(e).toPromise()}function qi(){const e=indexedDB.open(Li,Mi);return new Promise((t,n)=>{e.addEventListener("error",()=>{n(e.error)}),e.addEventListener("upgradeneeded",()=>{const t=e.result;try{t.createObjectStore(xi,{keyPath:Ui})}catch(i){n(i)}}),e.addEventListener("success",async()=>{const n=e.result;n.objectStoreNames.contains(xi)?t(n):(n.close(),await Hi(),t(await qi()))})})}async function ji(e,t,n){const i=Fi(e,!0).put({[Ui]:t,value:n});return new Vi(i).toPromise()}async function zi(e,t){const n=Fi(e,!1).get(t),i=await new Vi(n).toPromise();return void 0===i?null:i.value}function Gi(e,t){const n=Fi(e,!0).delete(t);return new Vi(n).toPromise()}const Wi=800,Ki=3;class $i{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await qi(),this.db)}async _withRetries(e){let t=0;for(;;)try{const i=await this._openDb();return await e(i)}catch(n){if(t++>Ki)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Pi()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Ai._getInstance(Di()),this.receiver._subscribe("keyChanged",async(e,t)=>{return{keyProcessed:(await this._poll()).includes(t.key)}}),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await bi(),!this.activeServiceWorker)return;this.sender=new Ri(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&Ci()===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const t=await qi();return await ji(t,fi,"1"),await Gi(t,fi),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>ji(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(t=>zi(t,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Gi(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(e=>{const t=Fi(e,!1).getAll();return new Vi(t).toPromise()});if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;if(0!==e.length)for(const{fbase_key:i,value:r}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(r)&&(this.notifyListeners(i,r),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Wi)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}$i.type="LOCAL";const Bi=exports.i=$i;function Ji(e,t){return V(e,"POST","/v2/accounts/mfaSignIn:start",U(e,t))}function Yi(e,t){return V(e,"POST","/v2/accounts/mfaSignIn:finalize",U(e,t))}function Xi(e,t){return V(e,"POST","/v2/accounts/mfaSignIn:finalize",U(e,t))}const Qi=500,Zi=6e4,er=1e12;class tr{constructor(e){this.auth=e,this.counter=er,this._widgets=new Map}render(e,t){const n=this.counter;return this._widgets.set(n,new nr(e,this.auth.name,t||{})),this.counter++,n}reset(e){var t;const n=e||er;null===(t=this._widgets.get(n))||void 0===t||t.delete(),this._widgets.delete(n)}getResponse(e){var t;const n=e||er;return(null===(t=this._widgets.get(n))||void 0===t?void 0:t.getResponse())||""}async execute(e){var t;const n=e||er;return null===(t=this._widgets.get(n))||void 0===t||t.execute(),""}}class nr{constructor(e,t,n){this.params=n,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=(()=>{this.execute()});const i="string"==typeof e?document.getElementById(e):e;k(i,"argument-error",{appName:t}),this.container=i,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),this.timerId||(this.timerId=window.setTimeout(()=>{this.responseToken=ir(50);const{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch(n){}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch(n){}this.isVisible&&this.execute()},Zi)},Qi))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}function ir(e){const t=[],n="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let i=0;i<e;i++)t.push(n.charAt(Math.floor(Math.random()*n.length)));return t.join("")}const rr=Qe("rcb"),sr=new C(3e4,6e4);class or{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(null===(e=Ni().grecaptcha)||void 0===e?void 0:e.render)}load(t,n=""){return k(ar(n),t,"argument-error"),this.shouldResolveImmediately(n)&&W(Ni().grecaptcha)?Promise.resolve(Ni().grecaptcha):new Promise((i,r)=>{const s=Ni().setTimeout(()=>{r(T(t,"network-request-failed"))},sr.get());Ni()[rr]=(()=>{Ni().clearTimeout(s),delete Ni()[rr];const e=Ni().grecaptcha;if(!e||!W(e))return void r(T(t,"internal-error"));const o=e.render;e.render=((e,t)=>{const n=o(e,t);return this.counter++,n}),this.hostLanguage=n,i(e)}),Be(`${Je()}?${(0,e.querystring)({onload:rr,render:"explicit",hl:n})}`).catch(()=>{clearTimeout(s),r(T(t,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var t;return!!(null===(t=Ni().grecaptcha)||void 0===t?void 0:t.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}function ar(e){return e.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(e)}class cr{async load(e){return new tr(e)}clearedOneInstance(){}}const ur="recaptcha",dr={theme:"light",type:"image"};class lr{constructor(e,t,n=Object.assign({},dr)){this.parameters=n,this.type=ur,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Ge(e),this.isInvisible="invisible"===this.parameters.size,k("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment");const i="string"==typeof t?document.getElementById(t):t;k(i,this.auth,"argument-error"),this.container=i,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new cr:new or,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),t=this.getAssertedRecaptcha(),n=t.getResponse(e);return n||new Promise(n=>{const i=e=>{e&&(this.tokenChangeListeners.delete(i),n(e))};this.tokenChangeListeners.add(i),this.isInvisible&&t.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise?this.renderPromise:(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e}),this.renderPromise)}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){k(!this.parameters.sitekey,this.auth,"argument-error"),k(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),k("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach(e=>e(t)),"function"==typeof e)e(t);else if("string"==typeof e){const n=Ni()[e];"function"==typeof n&&n(t)}}}assertNotDestroyed(){k(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){k(N()&&!Pi(),this.auth,"internal-error"),await hr(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await B(this.auth);k(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return k(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}function hr(){let e=null;return new Promise(t=>{"complete"!==document.readyState?(e=(()=>t()),window.addEventListener("load",e)):t()}).catch(t=>{throw e&&window.removeEventListener("load",e),t})}exports.R=lr;class pr{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){const t=Lt._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}async function mr(t,n,i){const r=Ge(t),s=await vr(r,n,(0,e.getModularInstance)(i));return new pr(s,e=>dn(r,e))}async function fr(t,n,i){const r=(0,e.getModularInstance)(t);await an(!1,r,"phone");const s=await vr(r.auth,n,(0,e.getModularInstance)(i));return new pr(s,e=>ln(r,e))}async function gr(t,n,i){const r=(0,e.getModularInstance)(t),s=await vr(r.auth,n,(0,e.getModularInstance)(i));return new pr(s,e=>hn(r,e))}async function vr(e,t,n){var i;const r=await n.verify();try{let s;if(k("string"==typeof r,e,"argument-error"),k(n.type===ur,e,"argument-error"),"session"in(s="string"==typeof t?{phoneNumber:t}:t)){const t=s.session;if("phoneNumber"in s){return k("enroll"===t.type,e,"internal-error"),(await ai(e,{idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:r}})).phoneSessionInfo.sessionInfo}{k("signin"===t.type,e,"internal-error");const n=(null===(i=s.multiFactorHint)||void 0===i?void 0:i.uid)||s.multiFactorUid;return k(n,e,"missing-multi-factor-info"),(await Ji(e,{mfaPendingCredential:t.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:r}})).phoneResponseInfo.sessionInfo}}{const{sessionInfo:t}=await Ot(e,{phoneNumber:s.phoneNumber,recaptchaToken:r});return t}}finally{n._reset()}}async function Ir(t,n){await on((0,e.getModularInstance)(t),n)}class _r{constructor(e){this.providerId=_r.PROVIDER_ID,this.auth=Ge(e)}verifyPhoneNumber(t,n){return vr(this.auth,t,(0,e.getModularInstance)(n))}static credential(e,t){return Lt._fromVerification(e,t)}static credentialFromResult(e){const t=e;return _r.credentialFromTaggedObject(t)}static credentialFromError(e){return _r.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:n}=e;return t&&n?Lt._fromTokenResponse(t,n):null}}function Tr(e,t){return t?_e(t):(k(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}exports.P=_r,_r.PROVIDER_ID="phone",_r.PHONE_SIGN_IN_METHOD="phone";class yr extends ht{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return St(e,this._buildIdpRequest())}_linkToIdToken(e,t){return St(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return St(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function wr(e){return un(e.auth,new yr(e),e.bypassAuthState)}function Er(e){const{auth:t,user:n}=e;return k(n,t,"internal-error"),cn(n,new yr(e),e.bypassAuthState)}async function kr(e){const{auth:t,user:n}=e;return k(n,t,"internal-error"),on(n,new yr(e),e.bypassAuthState)}class Ar{constructor(e,t,n,i,r=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=r,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:i,tenantId:r,error:s,type:o}=e;if(s)return void this.reject(s);const a={auth:this.auth,requestUri:t,sessionId:n,tenantId:r||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return wr;case"linkViaPopup":case"linkViaRedirect":return kr;case"reauthViaPopup":case"reauthViaRedirect":return Er;default:_(this.auth,"internal-error")}}resolve(e){S(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){S(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Sr=new C(2e3,1e4);async function Rr(e,t,n){const i=Ge(e);w(e,t,Ht);const r=Tr(i,n);return new Pr(i,"signInViaPopup",t,r).executeNotNull()}async function Nr(t,n,i){const r=(0,e.getModularInstance)(t);w(r.auth,n,Ht);const s=Tr(r.auth,i);return new Pr(r.auth,"reauthViaPopup",n,s,r).executeNotNull()}async function Or(t,n,i){const r=(0,e.getModularInstance)(t);w(r.auth,n,Ht);const s=Tr(r.auth,i);return new Pr(r.auth,"linkViaPopup",n,s,r).executeNotNull()}class Pr extends Ar{constructor(e,t,n,i,r){super(e,t,i,r),this.provider=n,this.authWindow=null,this.pollId=null,Pr.currentPopupAction&&Pr.currentPopupAction.cancel(),Pr.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return k(e,this.auth,"internal-error"),e}async onExecution(){S(1===this.filter.length,"Popup operations only handle one event");const e=Si();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject(T(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(T(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Pr.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;null!==(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)&&void 0!==n&&n.closed?this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(T(this.auth,"popup-closed-by-user"))},8e3):this.pollId=window.setTimeout(e,Sr.get())};e()}}Pr.currentPopupAction=null;const br="pendingRedirect",Cr=new Map;class Dr extends Ar{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=Cr.get(this.auth._key());if(!e){try{const n=await Lr(this.resolver,this.auth)?await super.execute():null;e=(()=>Promise.resolve(n))}catch(t){e=(()=>Promise.reject(t))}Cr.set(this.auth._key(),e)}return this.bypassAuthState||Cr.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}async function Lr(e,t){const n=Fr(t),i=Vr(e);if(!(await i._isAvailable()))return!1;const r="true"===await i._get(n);return await i._remove(n),r}async function Mr(e,t){return Vr(e)._set(Fr(t),"true")}function xr(){Cr.clear()}function Ur(e,t){Cr.set(e._key(),t)}function Vr(e){return _e(e._redirectPersistence)}function Fr(e){return we(br,e.config.apiKey,e.name)}function Hr(e,t,n){return qr(e,t,n)}async function qr(e,t,n){const i=Ge(e);w(e,t,Ht),await i._initializationPromise;const r=Tr(i,n);return await Mr(r,i),r._openRedirect(i,t,"signInViaRedirect")}function jr(e,t,n){return zr(e,t,n)}async function zr(t,n,i){const r=(0,e.getModularInstance)(t);w(r.auth,n,Ht),await r.auth._initializationPromise;const s=Tr(r.auth,i);await Mr(s,r.auth);const o=await Br(r);return s._openRedirect(r.auth,n,"reauthViaRedirect",o)}function Gr(e,t,n){return Wr(e,t,n)}async function Wr(t,n,i){const r=(0,e.getModularInstance)(t);w(r.auth,n,Ht),await r.auth._initializationPromise;const s=Tr(r.auth,i);await an(!1,r,n.providerId),await Mr(s,r.auth);const o=await Br(r);return s._openRedirect(r.auth,n,"linkViaRedirect",o)}async function Kr(e,t){return await Ge(e)._initializationPromise,$r(e,t,!1)}async function $r(e,t,n=!1){const i=Ge(e),r=Tr(i,t),s=new Dr(i,r,n),o=await s.execute();return o&&!n&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,t)),o}async function Br(e){const t=Si(`${e.uid}:::`);return e._redirectEventId=t,await e.auth._setRedirectUser(e),await e.auth._persistUserIfCurrent(e),t}const Jr=6e5;class Yr{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Zr(e)?t:(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0),t)}sendToConsumer(e,t){var n;if(e.error&&!Qr(e)){const i=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(T(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=Jr&&this.cachedEventUids.clear(),this.cachedEventUids.has(Xr(e))}saveEventToCache(e){this.cachedEventUids.add(Xr(e)),this.lastProcessedEventTime=Date.now()}}function Xr(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(e=>e).join("-")}function Qr({type:e,error:t}){return"unknown"===e&&"auth/no-auth-event"===(null==t?void 0:t.code)}function Zr(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Qr(e);default:return!1}}async function es(e,t={}){return V(e,"GET","/v1/projects",t)}exports.aD=Yr;const ts=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,ns=/^https?/;async function is(e){if(e.config.emulator)return;const{authorizedDomains:t}=await es(e);for(const i of t)try{if(rs(i))return}catch(n){}_(e,"unauthorized-domain")}function rs(e){const t=R(),{protocol:n,hostname:i}=new URL(t);if(e.startsWith("chrome-extension://")){const r=new URL(e);return""===r.hostname&&""===i?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&r.hostname===i}if(!ns.test(n))return!1;if(ts.test(e))return i===e;const r=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(i)}const ss=new C(3e4,6e4);function os(){const e=Ni().___jsl;if(null==e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let n=0;n<e.CP.length;n++)e.CP[n]=null}function as(e){return new Promise((t,n)=>{var i,r,s;function o(){os(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{os(),n(T(e,"network-request-failed"))},timeout:ss.get()})}if(null===(r=null===(i=Ni().gapi)||void 0===i?void 0:i.iframes)||void 0===r?void 0:r.Iframe)t(gapi.iframes.getContext());else{if(null===(s=Ni().gapi)||void 0===s||!s.load){const t=Qe("iframefcb");return Ni()[t]=(()=>{gapi.load?o():n(T(e,"network-request-failed"))}),Be(`${Xe()}?onload=${t}`).catch(e=>n(e))}o()}}).catch(e=>{throw cs=null,e})}let cs=null;function us(e){return cs=cs||as(e)}const ds=new C(5e3,15e3),ls="__/auth/iframe",hs="emulator/auth/iframe",ps={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},ms=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function fs(n){const i=n.config;k(i.authDomain,n,"auth-domain-config-required");const r=i.emulator?D(i,hs):`https://${n.config.authDomain}/${ls}`,s={apiKey:i.apiKey,appName:n.name,v:t.SDK_VERSION},o=ms.get(n.config.apiHost);o&&(s.eid=o);const a=n._getFrameworks();return a.length&&(s.fw=a.join(",")),`${r}?${(0,e.querystring)(s).slice(1)}`}async function gs(e){const t=await us(e),n=Ni().gapi;return k(n,e,"internal-error"),t.open({where:document.body,url:fs(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:ps,dontclear:!0},t=>new Promise(async(n,i)=>{await t.restyle({setHideOnLeave:!1});const r=T(e,"network-request-failed"),s=Ni().setTimeout(()=>{i(r)},ds.get());function o(){Ni().clearTimeout(s),n(t)}t.ping(o).then(o,()=>{i(r)})}))}const vs={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Is=500,_s=600,Ts="_blank",ys="http://localhost";class ws{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}function Es(t,n,i,r=Is,s=_s){const o=Math.max((window.screen.availHeight-s)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const u=Object.assign(Object.assign({},vs),{width:r.toString(),height:s.toString(),top:o,left:a}),d=(0,e.getUA)().toLowerCase();i&&(c=Re(d)?Ts:i),Ae(d)&&(n=n||ys,u.scrollbars="yes");const l=Object.entries(u).reduce((e,[t,n])=>`${e}${t}=${n},`,"");if(Le(d)&&"_self"!==c)return ks(n||"",c),new ws(null);const h=window.open(n||"",c,l);k(h,t,"popup-blocked");try{h.focus()}catch(p){}return new ws(h)}function ks(e,t){const n=document.createElement("a");n.href=e,n.target=t;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(i)}exports.aO=ws;const As="__/auth/handler",Ss="emulator/auth/handler",Rs=encodeURIComponent("fac");async function Ns(n,i,r,s,o,a){k(n.config.authDomain,n,"auth-domain-config-required"),k(n.config.apiKey,n,"invalid-api-key");const c={apiKey:n.config.apiKey,appName:n.name,authType:r,redirectUrl:s,v:t.SDK_VERSION,eventId:o};if(i instanceof Ht){i.setDefaultLanguage(n.languageCode),c.providerId=i.providerId||"",(0,e.isEmpty)(i.getCustomParameters())||(c.customParameters=JSON.stringify(i.getCustomParameters()));for(const[e,t]of Object.entries(a||{}))c[e]=t}if(i instanceof qt){const e=i.getScopes().filter(e=>""!==e);e.length>0&&(c.scopes=e.join(","))}n.tenantId&&(c.tid=n.tenantId);const u=c;for(const e of Object.keys(u))void 0===u[e]&&delete u[e];const d=await n._getAppCheckToken(),l=d?`#${Rs}=${encodeURIComponent(d)}`:"";return`${Os(n)}?${(0,e.querystring)(u).slice(1)}${l}`}function Os({config:e}){return e.emulator?D(e,Ss):`https://${e.authDomain}/${As}`}const Ps="webStorageSupport";class bs{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Ei,this._completeRedirectFn=$r,this._overrideRedirectResult=Ur}async _openPopup(e,t,n,i){var r;return S(null===(r=this.eventManagers[e._key()])||void 0===r?void 0:r.manager,"_initialize() not called before _openPopup()"),Es(e,await Ns(e,t,n,R(),i),Si())}async _openRedirect(e,t,n,i){return await this._originValidation(e),Oi(await Ns(e,t,n,R(),i)),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(S(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}async initAndGetManager(e){const t=await gs(e),n=new Yr(e);return t.register("authEvent",t=>{return k(null==t?void 0:t.authEvent,e,"invalid-auth-event"),{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Ps,{type:Ps},n=>{var i;const r=null===(i=null==n?void 0:n[0])||void 0===i?void 0:i[Ps];void 0!==r&&t(!!r),_(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=is(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return xe()||Se()||Ce()}}const Cs=exports.k=bs;class Ds{constructor(e){this.factorId=e}_process(e,t,n){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,n);case"signin":return this._finalizeSignIn(e,t.credential);default:return A("unexpected MultiFactorSessionType")}}}class Ls extends Ds{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new Ls(e)}_finalizeEnroll(e,t,n){return ci(e,{idToken:t,displayName:n,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return Yi(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class Ms{constructor(){}static assertion(e){return Ls._fromCredential(e)}}exports.m=Ms,Ms.FACTOR_ID="phone";class xs{static assertionForEnrollment(e,t){return Us._fromSecret(e,t)}static assertionForSignIn(e,t){return Us._fromEnrollmentId(e,t)}static async generateSecret(e){var t;const n=e;k(void 0!==(null===(t=n.user)||void 0===t?void 0:t.auth),"internal-error");const i=await ui(n.user.auth,{idToken:n.credential,totpEnrollmentInfo:{}});return Vs._fromStartTotpMfaEnrollmentResponse(i,n.user.auth)}}exports.T=xs,xs.FACTOR_ID="totp";class Us extends Ds{constructor(e,t,n){super("totp"),this.otp=e,this.enrollmentId=t,this.secret=n}static _fromSecret(e,t){return new Us(t,void 0,e)}static _fromEnrollmentId(e,t){return new Us(t,e)}async _finalizeEnroll(e,t,n){return k(void 0!==this.secret,e,"argument-error"),di(e,{idToken:t,displayName:n,totpVerificationInfo:this.secret._makeTotpVerificationInfo(this.otp)})}async _finalizeSignIn(e,t){k(void 0!==this.enrollmentId&&void 0!==this.otp,e,"argument-error");const n={verificationCode:this.otp};return Xi(e,{mfaPendingCredential:t,mfaEnrollmentId:this.enrollmentId,totpVerificationInfo:n})}}class Vs{constructor(e,t,n,i,r,s,o){this.sessionInfo=s,this.auth=o,this.secretKey=e,this.hashingAlgorithm=t,this.codeLength=n,this.codeIntervalSeconds=i,this.enrollmentCompletionDeadline=r}static _fromStartTotpMfaEnrollmentResponse(e,t){return new Vs(e.totpSessionInfo.sharedSecretKey,e.totpSessionInfo.hashingAlgorithm,e.totpSessionInfo.verificationCodeLength,e.totpSessionInfo.periodSec,new Date(e.totpSessionInfo.finalizeEnrollmentTime).toUTCString(),e.totpSessionInfo.sessionInfo,t)}_makeTotpVerificationInfo(e){return{sessionInfo:this.sessionInfo,verificationCode:e}}generateQrCodeUrl(e,t){var n;let i=!1;return(Fs(e)||Fs(t))&&(i=!0),i&&(Fs(e)&&(e=(null===(n=this.auth.currentUser)||void 0===n?void 0:n.email)||"unknownuser"),Fs(t)&&(t=this.auth.name)),`otpauth://totp/${t}:${e}?secret=${this.secretKey}&issuer=${t}&algorithm=${this.hashingAlgorithm}&digits=${this.codeLength}`}}function Fs(e){return void 0===e||0===(null==e?void 0:e.length)}exports.n=Vs;var Hs="@firebase/auth",qs="1.6.0";class js{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(e)}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(t=>{e((null==t?void 0:t.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){k(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function zs(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Gs(e){(0,t._registerComponent)(new r.Component("auth",(t,{options:n})=>{const i=t.getProvider("app").getImmediate(),r=t.getProvider("heartbeat"),s=t.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=i.options;k(o&&!o.includes(":"),"invalid-api-key",{appName:i.name});const c={apiKey:o,authDomain:a,clientPlatform:e,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Ve(e)},u=new ze(i,r,s,c);return ot(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),(0,t._registerComponent)(new r.Component("auth-internal",e=>{return(e=>new js(e))(Ge(e.getProvider("auth").getImmediate()))},"PRIVATE").setInstantiationMode("EXPLICIT")),(0,t.registerVersion)(Hs,qs,zs(e)),(0,t.registerVersion)(Hs,qs,"esm2017")}const Ws=300,Ks=(0,e.getExperimentalSetting)("authIdTokenMaxAge")||300;let $s=null;const Bs=e=>async t=>{const n=t&&await t.getIdTokenResult(),i=n&&((new Date).getTime()-Date.parse(n.issuedAtTime))/1e3;if(i&&i>Ks)return;const r=null==n?void 0:n.token;$s!==r&&($s=r,await fetch(e,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function Js(n=(0,t.getApp)()){const i=(0,t._getProvider)(n,"auth");if(i.isInitialized())return i.getImmediate();const r=st(n,{popupRedirectResolver:Cs,persistence:[Bi,yi,Ei]}),s=(0,e.getExperimentalSetting)("authTokenSyncURL");if(s){const e=Bs(s);Xn(r,e,()=>e(r.currentUser)),Yn(r,t=>e(t))}const o=(0,e.getDefaultEmulatorHost)("auth");return o&&at(r,`http://${o}`),r}function Ys(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}$e({loadJS:e=>new Promise((t,n)=>{const i=document.createElement("script");i.setAttribute("src",e),i.onload=t,i.onerror=(e=>{const t=T("internal-error");t.customData=e,n(t)}),i.type="text/javascript",i.charset="UTF-8",Ys().appendChild(i)}),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="}),Gs("Browser");
},{"@firebase/util":"chA2","@firebase/app":"h2Mb","@firebase/logger":"JJem","tslib":"vCxL","@firebase/component":"vhY9"}],"QWyA":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"ActionCodeOperation",{enumerable:!0,get:function(){return e.A}}),Object.defineProperty(exports,"ActionCodeURL",{enumerable:!0,get:function(){return e.ai}}),Object.defineProperty(exports,"AuthCredential",{enumerable:!0,get:function(){return e.L}}),Object.defineProperty(exports,"AuthErrorCodes",{enumerable:!0,get:function(){return e.I}}),Object.defineProperty(exports,"EmailAuthCredential",{enumerable:!0,get:function(){return e.M}}),Object.defineProperty(exports,"EmailAuthProvider",{enumerable:!0,get:function(){return e.V}}),Object.defineProperty(exports,"FacebookAuthProvider",{enumerable:!0,get:function(){return e.W}}),Object.defineProperty(exports,"FactorId",{enumerable:!0,get:function(){return e.F}}),Object.defineProperty(exports,"GithubAuthProvider",{enumerable:!0,get:function(){return e.Y}}),Object.defineProperty(exports,"GoogleAuthProvider",{enumerable:!0,get:function(){return e.X}}),Object.defineProperty(exports,"OAuthCredential",{enumerable:!0,get:function(){return e.N}}),Object.defineProperty(exports,"OAuthProvider",{enumerable:!0,get:function(){return e.Z}}),Object.defineProperty(exports,"OperationType",{enumerable:!0,get:function(){return e.O}}),Object.defineProperty(exports,"PhoneAuthCredential",{enumerable:!0,get:function(){return e.Q}}),Object.defineProperty(exports,"PhoneAuthProvider",{enumerable:!0,get:function(){return e.P}}),Object.defineProperty(exports,"PhoneMultiFactorGenerator",{enumerable:!0,get:function(){return e.m}}),Object.defineProperty(exports,"ProviderId",{enumerable:!0,get:function(){return e.p}}),Object.defineProperty(exports,"RecaptchaVerifier",{enumerable:!0,get:function(){return e.R}}),Object.defineProperty(exports,"SAMLAuthProvider",{enumerable:!0,get:function(){return e._}}),Object.defineProperty(exports,"SignInMethod",{enumerable:!0,get:function(){return e.S}}),Object.defineProperty(exports,"TotpMultiFactorGenerator",{enumerable:!0,get:function(){return e.T}}),Object.defineProperty(exports,"TotpSecret",{enumerable:!0,get:function(){return e.n}}),Object.defineProperty(exports,"TwitterAuthProvider",{enumerable:!0,get:function(){return e.$}}),Object.defineProperty(exports,"applyActionCode",{enumerable:!0,get:function(){return e.a7}}),Object.defineProperty(exports,"beforeAuthStateChanged",{enumerable:!0,get:function(){return e.x}}),Object.defineProperty(exports,"browserLocalPersistence",{enumerable:!0,get:function(){return e.b}}),Object.defineProperty(exports,"browserPopupRedirectResolver",{enumerable:!0,get:function(){return e.k}}),Object.defineProperty(exports,"browserSessionPersistence",{enumerable:!0,get:function(){return e.a}}),Object.defineProperty(exports,"checkActionCode",{enumerable:!0,get:function(){return e.a8}}),Object.defineProperty(exports,"confirmPasswordReset",{enumerable:!0,get:function(){return e.a6}}),Object.defineProperty(exports,"connectAuthEmulator",{enumerable:!0,get:function(){return e.K}}),Object.defineProperty(exports,"createUserWithEmailAndPassword",{enumerable:!0,get:function(){return e.aa}}),Object.defineProperty(exports,"debugErrorMap",{enumerable:!0,get:function(){return e.G}}),Object.defineProperty(exports,"deleteUser",{enumerable:!0,get:function(){return e.E}}),Object.defineProperty(exports,"fetchSignInMethodsForEmail",{enumerable:!0,get:function(){return e.af}}),Object.defineProperty(exports,"getAdditionalUserInfo",{enumerable:!0,get:function(){return e.aq}}),Object.defineProperty(exports,"getAuth",{enumerable:!0,get:function(){return e.o}}),Object.defineProperty(exports,"getIdToken",{enumerable:!0,get:function(){return e.an}}),Object.defineProperty(exports,"getIdTokenResult",{enumerable:!0,get:function(){return e.ao}}),Object.defineProperty(exports,"getMultiFactorResolver",{enumerable:!0,get:function(){return e.as}}),Object.defineProperty(exports,"getRedirectResult",{enumerable:!0,get:function(){return e.j}}),Object.defineProperty(exports,"inMemoryPersistence",{enumerable:!0,get:function(){return e.U}}),Object.defineProperty(exports,"indexedDBLocalPersistence",{enumerable:!0,get:function(){return e.i}}),Object.defineProperty(exports,"initializeAuth",{enumerable:!0,get:function(){return e.J}}),Object.defineProperty(exports,"initializeRecaptchaConfig",{enumerable:!0,get:function(){return e.t}}),Object.defineProperty(exports,"isSignInWithEmailLink",{enumerable:!0,get:function(){return e.ad}}),Object.defineProperty(exports,"linkWithCredential",{enumerable:!0,get:function(){return e.a2}}),Object.defineProperty(exports,"linkWithPhoneNumber",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(exports,"linkWithPopup",{enumerable:!0,get:function(){return e.d}}),Object.defineProperty(exports,"linkWithRedirect",{enumerable:!0,get:function(){return e.g}}),Object.defineProperty(exports,"multiFactor",{enumerable:!0,get:function(){return e.at}}),Object.defineProperty(exports,"onAuthStateChanged",{enumerable:!0,get:function(){return e.y}}),Object.defineProperty(exports,"onIdTokenChanged",{enumerable:!0,get:function(){return e.w}}),Object.defineProperty(exports,"parseActionCodeURL",{enumerable:!0,get:function(){return e.aj}}),Object.defineProperty(exports,"prodErrorMap",{enumerable:!0,get:function(){return e.H}}),Object.defineProperty(exports,"reauthenticateWithCredential",{enumerable:!0,get:function(){return e.a3}}),Object.defineProperty(exports,"reauthenticateWithPhoneNumber",{enumerable:!0,get:function(){return e.r}}),Object.defineProperty(exports,"reauthenticateWithPopup",{enumerable:!0,get:function(){return e.e}}),Object.defineProperty(exports,"reauthenticateWithRedirect",{enumerable:!0,get:function(){return e.h}}),Object.defineProperty(exports,"reload",{enumerable:!0,get:function(){return e.ar}}),Object.defineProperty(exports,"revokeAccessToken",{enumerable:!0,get:function(){return e.D}}),Object.defineProperty(exports,"sendEmailVerification",{enumerable:!0,get:function(){return e.ag}}),Object.defineProperty(exports,"sendPasswordResetEmail",{enumerable:!0,get:function(){return e.a5}}),Object.defineProperty(exports,"sendSignInLinkToEmail",{enumerable:!0,get:function(){return e.ac}}),Object.defineProperty(exports,"setPersistence",{enumerable:!0,get:function(){return e.q}}),Object.defineProperty(exports,"signInAnonymously",{enumerable:!0,get:function(){return e.a0}}),Object.defineProperty(exports,"signInWithCredential",{enumerable:!0,get:function(){return e.a1}}),Object.defineProperty(exports,"signInWithCustomToken",{enumerable:!0,get:function(){return e.a4}}),Object.defineProperty(exports,"signInWithEmailAndPassword",{enumerable:!0,get:function(){return e.ab}}),Object.defineProperty(exports,"signInWithEmailLink",{enumerable:!0,get:function(){return e.ae}}),Object.defineProperty(exports,"signInWithPhoneNumber",{enumerable:!0,get:function(){return e.s}}),Object.defineProperty(exports,"signInWithPopup",{enumerable:!0,get:function(){return e.c}}),Object.defineProperty(exports,"signInWithRedirect",{enumerable:!0,get:function(){return e.f}}),Object.defineProperty(exports,"signOut",{enumerable:!0,get:function(){return e.C}}),Object.defineProperty(exports,"unlink",{enumerable:!0,get:function(){return e.ap}}),Object.defineProperty(exports,"updateCurrentUser",{enumerable:!0,get:function(){return e.B}}),Object.defineProperty(exports,"updateEmail",{enumerable:!0,get:function(){return e.al}}),Object.defineProperty(exports,"updatePassword",{enumerable:!0,get:function(){return e.am}}),Object.defineProperty(exports,"updatePhoneNumber",{enumerable:!0,get:function(){return e.u}}),Object.defineProperty(exports,"updateProfile",{enumerable:!0,get:function(){return e.ak}}),Object.defineProperty(exports,"useDeviceLanguage",{enumerable:!0,get:function(){return e.z}}),Object.defineProperty(exports,"validatePassword",{enumerable:!0,get:function(){return e.v}}),Object.defineProperty(exports,"verifyBeforeUpdateEmail",{enumerable:!0,get:function(){return e.ah}}),Object.defineProperty(exports,"verifyPasswordResetCode",{enumerable:!0,get:function(){return e.a9}});var e=require("./index-bea2a320.js");require("@firebase/util"),require("@firebase/app"),require("@firebase/logger"),require("tslib"),require("@firebase/component");
},{"./index-bea2a320.js":"O7lw","@firebase/util":"chA2","@firebase/app":"h2Mb","@firebase/logger":"JJem","tslib":"vCxL","@firebase/component":"vhY9"}],"lHTY":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@firebase/auth");Object.keys(e).forEach(function(r){"default"!==r&&"__esModule"!==r&&(r in exports&&exports[r]===e[r]||Object.defineProperty(exports,r,{enumerable:!0,get:function(){return e[r]}}))});
},{"@firebase/auth":"QWyA"}],"AUp6":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.authModalClose=d,exports.authModalOpen=i,exports.registrationModalClose=o,exports.registrationModalOpen=a;var e=require("./header"),t=require("./refs"),s=require("./database"),n=require("./filmGallery");function i(){t.modalAuth.classList.remove("is-hidden"),t.modalCloseBtn.addEventListener("click",d),t.registrationBtn.addEventListener("click",a),document.addEventListener("keydown",r),document.addEventListener("click",c),t.signInForm.addEventListener("submit",s.handlerSignIn)}function d(){t.modalAuth.classList.add("is-hidden"),t.modalCloseBtn.removeEventListener("click",d),document.removeEventListener("keydown",r),document.addEventListener("click",c),(0,n.renderFilmsGalleryDefault)()}function a(){t.modalReg.classList.remove("is-hidden"),t.regCloseBtn.addEventListener("click",o),t.regForm.addEventListener("submit",s.hadlerRegistration)}function o(){t.modalReg.classList.add("is-hidden"),t.regCloseBtn.removeEventListener("click",o)}function r(s){"Escape"!==s.code||t.modalReg.classList.contains("is-hidden")?"Escape"===s.code&&t.modalReg.classList.contains("is-hidden")&&(d(),(0,e.openHomePage)()):o()}function c(s){!s.target.classList.contains("backdrop")||t.modalReg.classList.contains("is-hidden")?s.target.classList.contains("backdrop")&&!t.modalAuth.classList.contains("is-hidden")&&(d(),(0,e.openHomePage)()):o()}
},{"./header":"cGsR","./refs":"VyiV","./database":"npXB","./filmGallery":"VBuQ"}],"npXB":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.addToQueuedList=p,exports.addToWatchedList=h,exports.getQueuedList=y,exports.getWatchedList=f,exports.hadlerRegistration=w,exports.handlerSignIn=v,exports.handlerSignOut=b,Object.defineProperty(exports,"onAuthStateChanged",{enumerable:!0,get:function(){return t.onAuthStateChanged}}),exports.removeFromQueuedList=m,exports.removeFromWatchedList=g;var e=require("firebase/app"),a=require("firebase/firestore"),t=require("firebase/auth"),s=require("./authModal"),o=require("./header"),r=require("./refs");const n={apiKey:"AIzaSyCsfd-3fBAf5f-FVpWSftabVrr0pR9i2Nw",authDomain:"cinemateka-91cd3.firebaseapp.com",databaseURL:"https://cinemateka-91cd3-default-rtdb.europe-west1.firebasedatabase.app/",projectId:"cinemateka-91cd3",storageBucket:"cinemateka-91cd3.appspot.com",messagingSenderId:"547856263466",appId:"1:547856263466:web:6a175dec43543ff2171653"},c=(0,e.initializeApp)(n),d=(0,a.getFirestore)(c),i=(0,t.getAuth)(c);console.dir(i);const u=(0,a.collection)(d,"users");async function l(e,t){await(0,a.setDoc)((0,a.doc)(u,e),{user_id:e,user_mail:t,watched:[{film_id:"123",film_title:"title1"}],queued:[{film_id:"456",film_title:"title3"}]})}async function h(e){try{await(0,a.updateDoc)((0,a.doc)(d,"users",`${r.header.dataset.userId}`),{watched:(0,a.arrayUnion)(e)})}catch(t){console.log(t)}}async function g(e){try{await(0,a.updateDoc)((0,a.doc)(d,"users",`${r.header.dataset.userId}`),{watched:(0,a.arrayRemove)(e)})}catch(t){console.log(t)}}async function p(e){try{await(0,a.updateDoc)((0,a.doc)(d,"users",`${r.header.dataset.userId}`),{queued:(0,a.arrayUnion)(e)})}catch(t){console.log(t)}}async function m(e){try{await(0,a.updateDoc)((0,a.doc)(d,"users",`${r.header.dataset.userId}`),{queued:(0,a.arrayRemove)(e)})}catch(t){console.log(t)}}async function f(){try{return(await(0,a.getDoc)((0,a.doc)(d,"users",`${r.header.dataset.userId}`))).data().watched}catch(e){console.log(e)}}async function y(){try{return(await(0,a.getDoc)((0,a.doc)(d,"users",`${r.header.dataset.userId}`))).data().queued}catch(e){console.log(e)}}async function w(e){e.preventDefault();const a=e.currentTarget.elements.email.value,o=e.currentTarget.elements.password.value;try{const e=await(0,t.createUserWithEmailAndPassword)(i,a,o);l(e.user.uid,a),console.log("Registration success"),console.log(e),(0,s.registrationModalClose)();const n=e.user.uid;console.log(n)}catch(r){"auth/email-already-in-use"===r.code&&console.log("That email adress is already in use"),"auth/invalid-email"===r.code&&console.log("That email adress is invalid")}}async function v(e){e.preventDefault();const a=e.currentTarget.elements.email.value,r=e.currentTarget.elements.password.value;try{await(0,t.signInWithEmailAndPassword)(i,a,r),(0,s.authModalClose)(),(0,o.openLibraryPage)(),(0,t.onAuthStateChanged)(),console.log("Welcome user")}catch(n){"auth/invalid-credential"===n.code&&(console.log("Wrong email or password!"),console.log(n.code))}}async function b(){await(0,t.signOut)(i),console.log("Good Bye!")}(0,t.onAuthStateChanged)(i,e=>{if(e){const a=e.uid;console.log("Welcome user",a),r.header.dataset.userId=a,r.signOutBtn.classList.remove("visually-hidden")}else r.signOutBtn.classList.add("visually-hidden"),r.header.dataset.userId=""});
},{"firebase/app":"QtzL","firebase/firestore":"rrht","firebase/auth":"lHTY","./authModal":"AUp6","./header":"cGsR","./refs":"VyiV"}],"EZhS":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.handlerQueued=d,exports.handlerWatched=u;var e=l(require("./filmsAPI")),t=l(require("../templates/movie-card.hbs")),a=require("./filmGallery"),r=require("./refs"),s=require("./database"),i=require("./functions");function l(e){return e&&e.__esModule?e:{default:e}}const n=new e.default;async function u(){const e=(await(0,s.getWatchedList)()).map(e=>JSON.parse(e)),a=(0,i.filterFilmByQuery)(e),l=(await Promise.allSettled(a)).filter(({status:e})=>"fulfilled"===e).map(({value:e})=>e[0]),u=await n.fetchGenres(),d=(0,i.parseGenresToFilm)(l,u);r.filmList.insertAdjacentHTML("beforeend",(0,t.default)(d))}async function d(){const e=(await(0,s.getQueuedList)()).map(e=>JSON.parse(e)),a=(0,i.filterFilmByQuery)(e),l=(await Promise.allSettled(a)).filter(({status:e})=>"fulfilled"===e).map(({value:e})=>e[0]),u=await n.fetchGenres(),d=(0,i.parseGenresToFilm)(l,u);r.filmList.insertAdjacentHTML("beforeend",(0,t.default)(d))}function c(e){"BUTTON"===e.target.nodeName&&("watched"===e.target.dataset.type&&(r.queueBtn.classList.remove("active"),r.watchedBtn.classList.add("active"),(0,a.clearGallery)(),u()),"queued"===e.target.dataset.type&&(r.watchedBtn.classList.remove("active"),r.queueBtn.classList.add("active"),(0,a.clearGallery)(),d()))}r.headerLibBtns.addEventListener("click",c);
},{"./filmsAPI":"rqiq","../templates/movie-card.hbs":"WSZA","./filmGallery":"VBuQ","./refs":"VyiV","./database":"npXB","./functions":"OeGu"}],"RtnO":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.showFilmModal=v;var e=u(require("./filmsAPI")),t=u(require("../templates/movie-modal.hbs")),o=u(require("../templates/movie-trailer-modal.hbs")),a=l(require("basiclightbox"));require("../../node_modules/basiclightbox/src/styles/main.scss");var r=require("./functions"),n=require("./refs"),s=require("./filmGallery"),i=require("./myLibrary"),d=require("./database");function c(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,o=new WeakMap;return(c=function(e){return e?o:t})(e)}function l(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var o=c(t);if(o&&o.has(e))return o.get(e);var a={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in e)if("default"!==n&&Object.prototype.hasOwnProperty.call(e,n)){var s=r?Object.getOwnPropertyDescriptor(e,n):null;s&&(s.get||s.set)?Object.defineProperty(a,n,s):a[n]=e[n]}return a.default=e,o&&o.set(e,a),a}function u(e){return e&&e.__esModule?e:{default:e}}const m=new e.default;let f=!1;async function v(e){const o="IMG"===e.target.nodeName,c=""!==n.header.dataset.userId;if(!o)return;const l=e.target.attributes.alt.value;m.query=l;const{results:u}=await m.fetchFilmsByName(),v=await m.fetchGenres(),g=(0,r.parseGenresToFilm)(u,v),p=a.create((0,t.default)(g[0]),{onShow(){document.addEventListener("keydown",b)},onClose(){document.removeEventListener("keydown",b)}});p.show();const h=document.querySelector("#add-remove-watched-btn"),w=document.querySelector("#add-remove-queue-btn");function b(e){f||"Escape"!==e.code||p.close()}c&&n.watchedBtn.classList.contains("active")&&n.libraryBtn.classList.contains("current")&&(h.dataset.action="remove",h.textContent="remove from watched"),c&&n.queueBtn.classList.contains("active")&&n.libraryBtn.classList.contains("current")&&(w.dataset.action="remove",w.textContent="remove from queue"),document.querySelector(".movie-modal__buttons").addEventListener("click",async function(e){const t=e.target.parentElement.dataset.filmId,o=e.target.parentElement.dataset.filmTitle,a=JSON.stringify({film_id:t,film_title:o}),r=n.header.dataset.userId;if("BUTTON"!==e.target.nodeName)return;if("watchedMovies"===e.target.dataset.type&&"add"===e.target.dataset.action){if(!r)return void console.log("Not true. You must to sign in to add ");(0,d.addToWatchedList)(a),console.log("Added to watched")}if("queuedMovies"===e.target.dataset.type&&"add"===e.target.dataset.action){if(!r)return void console.log("Not true. You must to sign in to add ");(0,d.addToQueuedList)(a),console.log("Added to queued")}"watchedMovies"===e.target.dataset.type&&"remove"===e.target.dataset.action&&(await(0,d.removeFromWatchedList)(a),(0,s.clearGallery)(),(0,i.handlerWatched)(),p.close(),console.log("Removed from watched"));"queuedMovies"===e.target.dataset.type&&"remove"===e.target.dataset.action&&(await(0,d.removeFromQueuedList)(a),(0,s.clearGallery)(),(0,i.handlerQueued)(),p.close(),console.log("Removed from queued"));"show-trailer"===e.target.dataset.action&&y(e)}),document.querySelector("button.movie-modal__btn-close").addEventListener("click",p.close)}async function y(e){const t=e.target.dataset.id,{results:r}=await m.fetchFilmsById(t),n=r.find(e=>e.name.includes("Trailer")),s=a.create((0,o.default)(n),{onShow(){f=!0,document.addEventListener("keydown",i)},onClose(){document.removeEventListener("keydown",i)}});function i(e){"Escape"===e.code&&(f=!1,s.close())}s.show(),document.querySelector(".js-trailer-modal-close").addEventListener("click",s.close)}
},{"./filmsAPI":"rqiq","../templates/movie-modal.hbs":"lXUY","../templates/movie-trailer-modal.hbs":"kkvB","basiclightbox":"BNjD","../../node_modules/basiclightbox/src/styles/main.scss":"AjW3","./functions":"OeGu","./refs":"VyiV","./filmGallery":"VBuQ","./myLibrary":"EZhS","./database":"npXB"}],"VBuQ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.clearGallery=f,exports.renderFilmsGalleryByQuery=d,exports.renderFilmsGalleryDefault=c;var e=l(require("./filmsAPI")),t=l(require("../templates/movie-card.hbs")),r=l(require("./load-more-btn")),n=require("./pnotify"),i=require("./filmCardModal"),s=require("./functions"),a=require("./refs");function l(e){return e&&e.__esModule?e:{default:e}}const o=new e.default,u=new r.default({selector:"#load-more-btn",hidden:!0});async function c(){try{const{results:e,total_results:r}=await o.fetchFilms(),i=await o.fetchGenres(),l=(0,s.parseGenresToFilm)(e,i);if(a.filmList.insertAdjacentHTML("beforeend",(0,t.default)(l)),e.length*o.page>=r||o.page>=500)return void u.hide();u.enable(),u.show()}catch{u.hide(),(0,n.errorMsg)()}}async function d(){try{const{results:e,total_results:r}=await o.fetchFilmsByName();o.query&&0!==e.length||(0,n.emptyMovie)();const i=await o.fetchGenres(),l=(0,s.parseGenresToFilm)(e,i);if(a.filmList.insertAdjacentHTML("beforeend",(0,t.default)(l)),e.length*o.page>=r||o.page>=500)return void u.hide()}catch{u.hide(),(0,n.errorMsg)()}}function f(){a.filmList.innerHTML="",a.searchFormInput.reset(),u.hide()}function m(){u.disable(),o.incrementPage(),c()}async function h(e){e.preventDefault(),u.disable();const t=e.target.elements.query.value;o.query=t,f(),d(),u.enable(),u.show()}c(),a.searchFormInput.addEventListener("submit",h),a.moreFilmsBtn.addEventListener("click",m),a.filmList.addEventListener("click",i.showFilmModal);
},{"./filmsAPI":"rqiq","../templates/movie-card.hbs":"WSZA","./load-more-btn":"vMqs","./pnotify":"fRfm","./filmCardModal":"RtnO","./functions":"OeGu","./refs":"VyiV"}],"cGsR":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.handlerMyLibraryBtn=d,exports.openHomePage=i,exports.openLibraryPage=n;var e=require("./filmGallery"),r=require("./authModal"),a=require("./refs"),t=require("./database");const s=document.querySelector(".icon-film"),l=document.querySelector(".logo-link");function i(){(0,e.clearGallery)(),a.homeBtn.classList.add("current"),a.libraryBtn.classList.remove("current"),a.header.classList.remove("header-library"),a.searchInput.classList.remove("visually-hidden"),a.headerLibBtns.classList.add("visually-hidden"),(0,e.renderFilmsGalleryDefault)()}function n(){(0,e.clearGallery)(),a.homeBtn.classList.remove("current"),a.libraryBtn.classList.add("current"),a.header.classList.add("header-library"),a.searchInput.classList.add("visually-hidden"),a.headerLibBtns.classList.remove("visually-hidden")}function d(){a.header.dataset.userId||((0,r.authModalOpen)(),(0,e.clearGallery)()),a.header.dataset.userId&&n()}function c(){(0,t.handlerSignOut)(),i()}a.signOutBtn.addEventListener("click",c),a.homeBtn.addEventListener("click",i),a.libraryBtn.addEventListener("click",d);
},{"./filmGallery":"VBuQ","./authModal":"AUp6","./refs":"VyiV","./database":"npXB"}],"keXy":[function(require,module,exports) {
"use strict";var s=require("./refs");const{LIGHT:e,DARK:t}={LIGHT:"light-theme",DARK:"dark-theme"};let i=localStorage.getItem("page-theme")||e;function d(){s.body.classList.toggle(e),s.body.classList.toggle(t),s.moon.classList.toggle("is-hidden"),s.sun.classList.toggle("is-hidden"),i=i===e?t:e,localStorage.setItem("page-theme",i)}s.body.classList.add(i),i===e&&(s.sun.classList.remove("is-hidden"),s.moon.classList.add("is-hidden")),i===t&&s.sun.classList.add("is-hidden"),s.switcher.addEventListener("click",d);
},{"./refs":"VyiV"}],"Focm":[function(require,module,exports) {
"use strict";require("./sass/main.scss"),require("./js/header.js"),require("./js/database.js"),require("./js/theme-switcher.js"),require("./js/filmGallery.js"),require("./js/myLibrary.js");
},{"./sass/main.scss":"clu1","./js/header.js":"cGsR","./js/database.js":"npXB","./js/theme-switcher.js":"keXy","./js/filmGallery.js":"VBuQ","./js/myLibrary.js":"EZhS"}]},{},["Focm"], null)
//# sourceMappingURL=/cinema/src.a225afd5.js.map